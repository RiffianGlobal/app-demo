import{T as b,w,a as _,c as d,s as S,f as k,C as M}from"./index-mratHf6W.js";import{x as i,q as m,j as p,l as x,m as u,U as y,e as O,a2 as C,n as c,O as j,J as g}from"./vendor-ugI88S2F.js";import"./index-d9S9XV1r.js";const z=(e={})=>({pageNum:1,pageSize:10,hasMore:!0,...e});var D=Object.defineProperty,N=Object.getOwnPropertyDescriptor,P=(e,t,a,r)=>{for(var s=r>1?void 0:r?N(t,a):t,n=e.length-1,l;n>=0;n--)(l=e[n])&&(s=(r?l(t,a,s):l(s))||s);return r&&s&&D(t,a,s),s};let v=class extends b(""){render(){return this.chg.val==0?this.chg.per:i`<span class="${m({"text-green-500":this.chg.stat=="up","text-red-500":this.chg.stat=="down"})}">${this.chg.per}</span>`}};P([p({type:Object})],v.prototype,"chg",2);v=P([x("chg-stat")],v);const E=".subject-name{cursor:pointer;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@media (min-width: 1024px){.subject-name{font-size:1rem;line-height:1.5rem}.subject-name.limit{max-width:10rem}}.subject-img{height:3.5rem;width:3.5rem;cursor:pointer;border-radius:.5rem}.subject-lines{display:flex;flex-direction:column;gap:.25rem;line-height:1}.subject-lines .subject-line1{display:flex;height:1.5rem;align-items:center;line-height:1}.subject-play{font-size:1.25rem;line-height:1.75rem;line-height:1;opacity:.85}.subject-play:hover{opacity:1}";var I=Object.defineProperty,q=Object.getOwnPropertyDescriptor,h=(e,t,a,r)=>{for(var s=r>1?void 0:r?q(t,a):t,n=e.length-1,l;n>=0;n--)(l=e[n])&&(s=(r?l(t,a,s):l(s))||s);return r&&s&&I(t,a,s),s};let o=class extends b(E){constructor(){super(...arguments),this.bindScreen=new u(this,y),this.bindWallet=new u(this,w),this.bindWeekly=new u(this,_),this.bindCharts=new u(this,d),this.paging=!1,this.brief=!0,this.pageSize=10,this.moreSubjects=[],this.morePending=!1,this.ts=0,this.err="",this.pagination=z({pageNum:2,pageSize:this.pageSize}),this.hasMore=!0,this.fetch=async(e=!1)=>{if(!(this.morePending&&!e)&&!(this.paging&&!this.hasMore)){this.err="",this.morePending=!0;try{const t={cate:d.cate};if(this.pagination){const{pageSize:r,pageNum:s}=this.pagination;Object.assign(t,{first:r,skip:(s-1)*r})}const{subjects:a}=await S(t);this.paging?(this.moreSubjects=[...this.moreSubjects,...a],this.hasMore=a.length>=this.pagination.pageSize,this.pagination.pageNum++):this.moreSubjects=[...a]}catch(t){this.err=t.message||t.msg||t}finally{this.morePending=!1,this.ts++}}},this.loadmore=()=>{this.fetch()},this.fullItemMobi=e=>i`<div class="w-full overflow-hidden flex gap-x-2" @click="${t=>this.go2(t,e)}"><div class="w-[3.25rem] h-[3.25rem] mr-2 rounded-lg"><img-loader src="${e.image}" class="w-[3.25rem] rounded-lg"></img-loader></div><div class="subject-lines flex-auto overflow-hidden"><div class="subject-line1"><p class="subject-name ${m({limit:this.brief})}">${e.name}</p><a href="${e.uri}" class="flex-none ml-1.5" target="_blank"><i class="subject-play mdi mdi-play-circle-outline"></i></a></div><div class="text-xs text-gray-400/80"><span class="mr-1 text-gray-400/60">Price:</span>${e.cooked.price}</div></div><div class="subject-lines num flex-initial !w-12 text-sm items-end"><span class="subject-line1">${e.cooked.total}</span> <span class="text-xs"><chg-stat .chg="${e.cooked.chg}"></chg-stat></span></div></div>`,this.go2=(e,t)=>{var a;e.preventDefault(),e.stopPropagation(),this.disabled?O.emit("connect-wallet"):((a=e.target)==null?void 0:a.tagName)=="I"?window.open(t.uri,"_blank"):C(`/track/${t.id}`)},this.headerEle=()=>this.brief?i`${c(!this.isMobi,()=>i`<div class="w-8">Rank</div>`)}<div class="flex-shrink">Collection</div><div class="flex-auto"></div><div class="num flex-auto w-32">Volume</div>`:i`${c(!this.isMobi,()=>i`<div class="w-16">Index</div>`)}<div class="flex-auto">Name</div>${c(!this.isMobi,()=>i`<div class="flex-none w-40">Uploaded</div>`)}<div class="num flex-none w-24">Volume</div>${c(!this.isMobi,()=>i`<div class="num flex-none w-24">Price</div><div class="num flex-none w-24">24H</div>`)}`,this.itemEle=(e,t)=>this.brief?i`<div class="item flex items-center" @click="${a=>this.go2(a,e)}">${c(!this.isMobi,()=>i`<div class="flex-none w-8 text-center text-sm font-light opacity-70">${t+1}</div>`)}<div class="subject-img flex-shrink flex justify-center"><img-loader .src="${e.cooked.src}" class="w-14 rounded-lg"></img-loader></div><div class="subject-lines flex-auto overflow-hidden"><div class="subject-line1"><p class="subject-name ${m({limit:this.brief})}">${e.name}</p><a href="${e.uri}" class="flex-none ml-1.5" target="_blank"><i class="subject-play mdi mdi-play-circle-outline"></i></a></div>${c(this.brief,()=>i`<div class="text-xs text-gray-400/80"><span class="mr-1 text-gray-400/60">Price:</span>${e.cooked.price}</div>`)}</div><div class="subject-lines num flex-initial !w-12 text-sm items-end"><span class="subject-line1">${e.cooked.total}</span> <span class="text-xs"><chg-stat .chg="${e.cooked.chg}"></chg-stat></span></div></div>`:i`${c(!this.isMobi,()=>i`<div class="item flex items-center hover_cursor-pointer" @click="${a=>this.go2(a,e)}"><div class="flex-none w-16 pl-4 text-sm font-light opacity-75">${t+1} ${c(this.subjects.length>3&&t<3,()=>i`<i class="mdi mdi-fire text-red-400"></i>`)}</div><div class="flex-auto flex overflow-hidden"><div class="w-[3.25rem] h-[3.25rem] mr-4 rounded-lg"><img-loader src="${e.cooked.src}" class="w-[3.25rem] h-[3.25rem] rounded-lg"></img-loader></div><div class="truncate"><p class="subject-name subject-line1 lg_text-base truncate w-full">${e.name}</p><i class="subject-play mdi mdi-play-circle"></i></div></div><div class="flex-none w-40 text-xs text-gray-300/60">${k(e.createdAt)}</div><div class="flex-none w-24 text-right text-sm"><span>${e.cooked.total}</span></div><div class="flex-none w-24 text-right text-sm"><span>${e.cooked.price}</span></div><div class="flex-none w-24 text-right text-sm leading-none"><span><chg-stat .chg="${e.cooked.chg}"></chg-stat></span></div></div>`,()=>i`${this.fullItemMobi(e)}`)}`}get disabled(){return!w.account}get isMobi(){return y.isMobi}get scrollMode(){return"scroll"}get empty(){return d.inited&&!d.subjects.length}get loading(){return d.pending&&!d.subjects.length}get subjects(){return this.empty?[]:d.subjects.concat(this.moreSubjects)}render(){return i`<div role="list" class="ui-list gap-2 ${m(this.$c([this.morePending?"loading":"hover"]))}"><div class="flex header border-bottom">${this.headerEle()}</div>${c(this.loading,()=>i`<div name="loading" class="doc-intro"></div><loading-skeleton num="4"></loading-skeleton>`,()=>i`${j(this.subjects,(e,t)=>i`${this.itemEle(e,t)}`)} ${c(this.paging,()=>i`<ui-pagination .nomore="${this.err}" mode="${this.scrollMode}" .firstLoad="${!1}" .pending="${this.morePending}" @loadmore="${this.loadmore}"></ui-pagination>`,()=>i`<ui-link dense class="w-full justify-center" href="/charts">More</ui-link>`)}`)}</div>`}};h([p({type:Boolean})],o.prototype,"paging",2);h([p({type:Boolean})],o.prototype,"brief",2);h([p({type:Number})],o.prototype,"pageSize",2);h([g()],o.prototype,"moreSubjects",2);h([g()],o.prototype,"morePending",2);h([g()],o.prototype,"ts",2);h([g()],o.prototype,"err",2);h([g()],o.prototype,"pagination",2);h([g()],o.prototype,"hasMore",2);o=h([x("top-charts")],o);const B=":host{display:inline-flex;gap:2rem}";var T=Object.defineProperty,R=Object.getOwnPropertyDescriptor,$=(e,t,a,r)=>{for(var s=r>1?void 0:r?R(t,a):t,n=e.length-1,l;n>=0;n--)(l=e[n])&&(s=(r?l(t,a,s):l(s))||s);return r&&s&&T(t,a,s),s};let f=class extends b(B){constructor(){super(...arguments),this.bindChart=new u(this,d),this.cate="top",this.route=!1,this.goto=(e,t)=>{this.route||(e.stopImmediatePropagation(),e.preventDefault(),d.cate=t)}}render(){return i`${j(M,e=>i`<ui-link href="/charts/${e.key}" @click="${t=>this.goto(t,e.key)}" nav dense exact class="${m({"exact-active":d.cate===e.key})}">${e.title}</ui-link>`)}`}};$([p({type:String})],f.prototype,"cate",2);$([p({type:Boolean})],f.prototype,"route",2);f=$([x("charts-cate")],f);export{z as p,E as s};
