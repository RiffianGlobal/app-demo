import{T as $,s as P,c as n,p as S,d as w,C as _}from"./index-vT14mI4y.js";import{m,U as v,x as r,q as d,n as l,O as y,J as g,j as u,l as j}from"./vendor-P2KLLNE-.js";var C=Object.defineProperty,M=Object.getOwnPropertyDescriptor,h=(t,e,i,a)=>{for(var s=a>1?void 0:a?M(e,i):e,p=t.length-1,c;p>=0;p--)(c=t[p])&&(s=(a?c(e,i,s):c(s))||s);return a&&s&&C(e,i,s),s};let o=class extends $(P){constructor(){super(...arguments),this.bindScreen=new m(this,v),this.bindCharts=new m(this,n),this.paging=!1,this.brief=!0,this.pageSize=10,this.moreSubjects=[],this.morePending=!1,this.ts=0,this.err="",this.pagination=S({pageNum:2,pageSize:this.pageSize}),this.hasMore=!0,this.fetch=async(t=!1)=>{if(!(this.morePending&&!t)&&!(this.paging&&!this.hasMore)){this.err="",this.morePending=!0;try{const e={cate:n.cate};if(this.pagination){const{pageSize:a,pageNum:s}=this.pagination;Object.assign(e,{first:a,skip:(s-1)*a})}const{subjects:i}=await w(e);this.paging?(this.moreSubjects=[...this.moreSubjects,...i],this.hasMore=i.length>=this.pagination.pageSize,this.pagination.pageNum++):this.moreSubjects=[...i]}catch(e){this.err=e.message||e.msg||e}finally{this.morePending=!1,this.ts++}}},this.loadmore=()=>{this.fetch()}}get isMobi(){return v.isMobi}get scrollMode(){return"scroll"}get page1Len(){return n.subjects.length}get empty(){return n.inited&&!this.page1Len}get loading(){return n.chartPending&&!this.page1Len}get subjects(){return this.empty?[]:n.subjects.concat(this.moreSubjects)}get showRank(){return!this.isMobi&&n.cate!=="new"}render(){const t=!this.isMobi&&!this.brief;return r`<div role="list" class="ui-list gap-2 ${d(this.$c([this.morePending?"loading":"hover"]))}"><div class="flex header border-bottom">${l(this.showRank,()=>r`<div class="${d(this.$c([this.brief?"w-8":"w-12"]))}">Rank</div>`)}<div class="subject-intro">Collection</div>${l(t,()=>r`<div class="num date">Uploaded</div>`)} ${l(t,()=>r`<div class="num">Price</div>`)}<div class="num">Volume</div>${l(t,()=>r`<div class="num per">24H</div>`)}</div>${l(this.loading,()=>r`<div name="loading" class="doc-intro"></div><loading-skeleton num="4"></loading-skeleton>`,()=>r`${y(this.subjects,(e,i)=>r`<subject-brief .subject="${e}" ?lite="${this.brief}">${l(this.showRank,()=>r`<div slot="left" class="subject-rank ${d({hot:!this.brief})}">${i+1} ${l(!this.brief&&this.page1Len>3&&i<3,()=>r`<i class="mdi mdi-fire text-red-400"></i>`)}</div>`)}</subject-brief>`)} ${l(this.paging,()=>r`<ui-pagination .nomore="${this.err}" mode="${this.scrollMode}" .firstLoad="${!1}" .pending="${this.morePending}" @loadmore="${this.loadmore}"></ui-pagination>`,()=>r`<ui-link dense class="w-full justify-center" href="/charts">More</ui-link>`)}`)}</div>`}};h([u({type:Boolean})],o.prototype,"paging",2);h([u({type:Boolean})],o.prototype,"brief",2);h([u({type:Number})],o.prototype,"pageSize",2);h([g()],o.prototype,"moreSubjects",2);h([g()],o.prototype,"morePending",2);h([g()],o.prototype,"ts",2);h([g()],o.prototype,"err",2);h([g()],o.prototype,"pagination",2);h([g()],o.prototype,"hasMore",2);o=h([j("top-charts")],o);const O=":host{display:inline-flex;gap:2rem}";var x=Object.defineProperty,k=Object.getOwnPropertyDescriptor,b=(t,e,i,a)=>{for(var s=a>1?void 0:a?k(e,i):e,p=t.length-1,c;p>=0;p--)(c=t[p])&&(s=(a?c(e,i,s):c(s))||s);return a&&s&&x(e,i,s),s};let f=class extends $(O){constructor(){super(...arguments),this.bindChart=new m(this,n),this.cate="top",this.route=!1,this.goto=(t,e)=>{this.route||(t.stopImmediatePropagation(),t.preventDefault(),n.cate=e)}}render(){return r`${y(_,t=>r`<ui-link href="/charts/${t.key}" @click="${e=>this.goto(e,t.key)}" nav dense exact class="${d({"exact-active":n.cate===t.key})}">${t.title}</ui-link>`)}`}};b([u({type:String})],f.prototype,"cate",2);b([u({type:Boolean})],f.prototype,"route",2);f=b([j("charts-cate")],f);
