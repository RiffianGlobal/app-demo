import{T as x,b as u,j as _,f as P,l as b}from"./index-Be9je0zv.js";import{t as C,u as O}from"./action-G3Y4GGKx.js";import{i as f,e as j,$ as L,f as $,x as o,j as T,n as m,B as w,u as l,c as v,g as y}from"./vendor-dtnumNs5.js";import"./dialog-xSW8f_IR.js";const D="li.header{margin-bottom:.75rem;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:#a3a3a3;color:rgba(163,163,163,var(--tw-text-opacity))}li.item:hover{background-color:#ffffff0d}@media (min-width: 500px){.name{font-size:1rem;line-height:1.5rem}}.icon{font-size:1.5rem;line-height:2rem}@media (max-width: 500px){.icon{font-size:1.5rem;line-height:2rem}}";var V=Object.defineProperty,M=Object.getOwnPropertyDescriptor,h=(t,s,a,i)=>{for(var e=i>1?void 0:i?M(s,a):s,n=t.length-1,c;n>=0;n--)(c=t[n])&&(e=(i?c(s,a,e):c(e))||e);return i&&e&&V(s,a,e),e};let p=class extends x(D){constructor(){super(...arguments),this.bindBridge=new f(this,u),this.weekly=!1,this.address="",this.trackList=[],this.pending=!1,this.err="",this.ts=0,this.go2=t=>{this.disabled?j.emit("connect-wallet"):L(`/track/${t.address}`)},this.init=async()=>{this.pending=!0;try{let{user:{subjectsCreated:t}}=await C(this.address);this.trackList=t.map(s=>{const{totalVoteValue:a}=s;return{...s,totalVal:$(a)}})}catch(t){this.err=t.message||t.msg||t,_.add({summary:"Fetch failed",detail:this.err})}finally{this.pending=!1,this.ts++}}}get disabled(){return!u.bridge.account}connectedCallback(){super.connectedCallback(),this.init()}render(){return o`<div role="list" class="ui-list py-6 ${T(this.$c([this.pending?"loading":"hover"]))}"><div class="flex header"><div class="w-16">Index</div><div class="flex-auto">Name</div><div class="flex-none w-40">Created</div><div class="flex-none w-20 text-right">Voters</div><div class="flex-none w-24 text-right">Tickets</div><div class="flex-none w-24 text-right">Vote Value</div></div>${m(!this.ts&&!this.trackList.length,()=>o`<div name="Loading" class="doc-intro"><div class="flex flex-col gap-8 m-6">${w([...Array(3).keys()],()=>o`<div name="Loading" class="doc-intro"><loading-skeleton num="4"></loading-skeleton></div>`)}</div></div>`,()=>o`${w(this.trackList,(t,s)=>o`<div class="item flex py-2 pr-2 items-center cursor-pointer" @click="${()=>this.go2(t)}"><div class="flex-none w-16 pl-4 text-sm font-light opacity-75">${s+1} ${m(this.trackList.length>3&&s<3,()=>o`<i class="mdi mdi-fire text-red-400"></i>`)}</div><div class="flex-auto flex"><div class="w-[3.25rem] h-[3.25rem] mr-4 rounded-lg"><img-loader src="${t.image}" class="rounded-lg"></img-loader></div><div><p class="name truncate">${t.name}</p><span class="icon mt-1"><i class="mdi mdi-play-circle-outline"></i></span></div></div><div class="flex-none w-40 text-xs text-gray-300/60">${P(t.createdAt)}</div><div class="flex-none w-20 text-right text-sm"><p class="num truncate mt-2">${t.fansNumber}</p></div><div class="flex-none w-24 text-right text-sm"><p class="num truncate mt-2">${t.supply}</p></div><div class="flex-none w-24 text-right text-sm"><p class="num truncate mt-2">${t.totalVal}</p></div></div>`)}`)}</div>`}};h([v({type:Boolean})],p.prototype,"weekly",2);h([v({type:String})],p.prototype,"address",2);h([l()],p.prototype,"trackList",2);h([l()],p.prototype,"pending",2);h([l()],p.prototype,"err",2);h([l()],p.prototype,"ts",2);p=h([y("track-list")],p);const S='.middle-dot-divider:after{content:"Â·";padding:0 .375rem;font-weight:600}';var B=Object.defineProperty,F=Object.getOwnPropertyDescriptor,d=(t,s,a,i)=>{for(var e=i>1?void 0:i?F(s,a):s,n=t.length-1,c;n>=0;n--)(c=t[n])&&(e=(i?c(s,a,e):c(e))||e);return i&&e&&B(s,a,e),e};const z=()=>({loading:"",tx:""});let r=class extends x(S){constructor(){super(...arguments),this.bindBridge=new f(this,u),this.bindTweets=new f(this,b),this.weekly=!1,this.address="",this.retreatDisabled=!0,this.voteList=[],this.pending=!1,this.prompt=!1,this.dialog=!1,this.promptMessage="",this.err=z(),this.ts=0,this.updateErr=(t={})=>this.err=Object.assign({},this.err,t),this.init=async()=>{this.pending=!0;try{let t=await O(this.address);this.user=t.user,this.readFromTwitter()}catch(t){this.updateErr({load:t.message||t}),this.promptMessage=t,this.prompt=!0;return}finally{this.ts++,this.pending=!1}},this.close=()=>{this.dialog=!1,this.init()}}get disabled(){return!u.bridge.account}connectedCallback(){super.connectedCallback(),this.init()}getRandomInt(t){return Math.floor(Math.random()*t)}async readFromTwitter(){let{uri:t}=this.user.socials[0]??{};this.social=await b.fromUri(t,this.user.address)}render(){return o`<div class="m-4 text-center">${m(!this.ts&&!this.err.loading,()=>o`<div name="Loading" class="doc-intro"><div class="flex flex-col gap-8 m-8"><loading-skeleton num="3"></loading-skeleton></div></div>`,()=>o`${m(this.prompt,()=>o`<p class="text-center text-orange-600">${this.promptMessage}</p>`,()=>{var t;return o`<div class="py-4"><ui-address class="text-lg" .address="${this.user.address}" short avatar></ui-address><div class="my-4">${m((t=this.social)==null?void 0:t.id,()=>{var s,a,i,e;return o`<span class="text-base font-light middle-dot-divider">${(s=this.social)==null?void 0:s.name}<span class="ml-0.5">${m((a=this.social)==null?void 0:a.verified,()=>o`<i class="text-green-600 text-sm mdi mdi-check-decagram"></i>`)}</span></span><span class="text-base font-light"> <a href="${(i=this.social)==null?void 0:i.url}" class="text-blue-300" target="_blank">@${(e=this.social)==null?void 0:e.id}</a></span>`})}</div><div class="mt-0.5"><span class="text-base text-white/70 middle-dot-divider">Holding <span class="ml-1 text-blue-300">${this.user.holding??"-"}</span></span> <span class="text-base text-white/70">Reward Claimed <span class="ml-1 text-blue-300">${this.user.rewardClaimed?parseFloat((+$(this.user.rewardClaimed)).toFixed(4)):"-"}</span></span></div></div>`})}`)}</div>`}};d([v({type:Boolean})],r.prototype,"weekly",2);d([v({type:String})],r.prototype,"address",2);d([v({type:Promise})],r.prototype,"votes",2);d([l()],r.prototype,"myVotes",2);d([l()],r.prototype,"retreatDisabled",2);d([l()],r.prototype,"social",2);d([l()],r.prototype,"user",2);d([l()],r.prototype,"voteList",2);d([l()],r.prototype,"pending",2);d([l()],r.prototype,"prompt",2);d([l()],r.prototype,"dialog",2);d([l()],r.prototype,"promptMessage",2);d([l()],r.prototype,"err",2);d([l()],r.prototype,"ts",2);r=d([y("user-detail")],r);const E="";var I=Object.defineProperty,A=Object.getOwnPropertyDescriptor,k=(t,s,a,i)=>{for(var e=i>1?void 0:i?A(s,a):s,n=t.length-1,c;n>=0;n--)(c=t[n])&&(e=(i?c(s,a,e):c(e))||e);return i&&e&&I(s,a,e),e};let g=class extends x(E){constructor(){super(...arguments),this.addr=""}render(){return o`<div class="ui-container mx-auto flex flex-col place-content-center pt-10">
      <!-- user profile -->
      <user-detail .address=${this.addr} class="mx-auto"></user-detail>

      <div class="w-full inline-flex pb-2 border-b border-slate-50/10">
        <div class="py-1.5 px-3 text-base font-normal text-white/70 rounded-md">Tracks</div>
      </div>

      <track-list .address=${this.addr}></track-list>

      <!-- <div class="h-20 pt-1 mb-8">
        <div class="font-bold text-xl">
          <user-detail .address=${this.addr}> </user-detail>
        </div>
      </div>
      <div class="h-10 pt-1 mt-20">
        <div class="font-bold text-xl">Tracks</div>
      </div>
      <div class="mt-0">
        <track-list .address=${this.addr}></track-list>
      </div> -->
    </div>`}};k([v({type:String})],g.prototype,"addr",2);g=k([y("user-page")],g);export{g as TrackPage};
