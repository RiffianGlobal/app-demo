import{T as p,s as h}from"./index--oPCPxWY.js";import"./socialbtn-14EqOirW.js";import{a as f,h as x,g as w}from"./claim-K2riohNW.js";import{x as o,n as c,c as b,f as y,r as g,a as S,t as u,S as $,m as _}from"./vendor-es3agW_J.js";import"./prompt-yqEgyQJk.js";const D=async t=>{let i=`{
      voteLogs(first: ${t}, orderBy: time, orderDirection:desc) {
        id
        voter{
          address
        }
        time
        value
      }
    }`;return await f("MediaBoard",i)},V=".text-highlight{color:var(--colorHighlight)}svg{display:inline-flex;align-items:center;overflow:hidden;border-radius:9999px;background:#c81444}svg svg{height:100%;width:100%}li.header{margin-bottom:.5rem;font-weight:300;--tw-text-opacity: 1;color:#fafaf9;color:rgba(250,250,249,var(--tw-text-opacity));border-bottom:1px solid #898989}";var O=Object.defineProperty,P=Object.getOwnPropertyDescriptor,d=(t,i,r,s)=>{for(var e=s>1?void 0:s?P(i,r):i,a=t.length-1,l;a>=0;a--)(l=t[a])&&(e=(s?l(i,r,e):l(e))||e);return s&&e&&O(i,r,e),e};let n=class extends p(V){constructor(){super(...arguments),this.weekly=!1,this.latestVotes=[],this.albumToVote={id:"",voter:0,time:0,value:0},this.pending=!1,this.init=async()=>{this.pending=!0;try{let t=await D(20);this.latestVotes=t.voteLogs}catch(t){console.error(t)}this.pending=!1},this.timeAgo=async function*(t){for(;;){let i=BigInt(new Date().getTime())/1000n,r=i-t,s=r/86400n,e=(r-s*86400n)/3600n,a=(r-s*86400n-e*3600n)/60n,l="";s>0&&(l+=s.toString()+"d "),e>0&&(l+=+e.toString()+"h "),a>0&&(l+=a.toString()+"m "),l?l+="ago":l="<1m",yield l,await new Promise(m=>setTimeout(m,1e3))}}}connectedCallback(){super.connectedCallback(),this.init()}render(){return o`${c(this.pending&&this.latestVotes.length==0,()=>o`<loading-skeleton num="4"></loading-skeleton>`)} ${c(!this.pending,()=>o`<ul role="list"><li class="flex header p-1"><div class="w-16">Bidders</div></li>${b(this.latestVotes,(t,i)=>o`<li class="py-2 justify-start"><div class="flex items-center justify-start space-x-2"><ui-address class="text-2xl" .address="${t.voter.address}" avatar hideAddr></ui-address><p class="text-highlight text-2xl">${y(t.value,18)}</p></div><div><p class="font-light text-gray-400 text-left text-sm">${x(this.timeAgo(BigInt(t.time)))}</p></div></li>`)}</ul>`)}`}};d([S({type:Boolean})],n.prototype,"weekly",2);d([g()],n.prototype,"latestVotes",2);d([g()],n.prototype,"albumToVote",2);d([g()],n.prototype,"pending",2);n=d([u("latest-votes")],n);const j=".text-highlight{color:var(--colorHighlight)}";var C=Object.defineProperty,T=Object.getOwnPropertyDescriptor,A=(t,i,r,s)=>{for(var e=s>1?void 0:s?T(i,r):i,a=t.length-1,l;a>=0;a--)(l=t[a])&&(e=(s?l(i,r,e):l(e))||e);return s&&e&&C(i,r,e),e};let v=class extends p(j){constructor(){super(...arguments),this.bindScreen=new $(this,h)}get isSmall(){return h.screen.lg}connectedCallback(){super.connectedCallback()}async weekRange(){return w().then(t=>{const i=7n*24n*60n*60n;let r=t+i,s=new Date(Number(t*1000n)),e=new Date(Number(r*1000n));return console.log(t,s),s.toLocaleString("en-US",{month:"short"})+s.getDate()+(s.getFullYear()==e.getFullYear()?"":", "+e.getFullYear())+"-"+(s.getMonth()==e.getMonth()?"":e.toLocaleString("en-us",{month:"short"}))+e.getDate()+", "+e.getFullYear()})}render(){return o`<div class="flex px-8 space-x-8 place-content-center"><div class="flex-initial w-[32rem]"><div class="flex justify-between h-20"><div><div class="font-bold text-2xl text-highlight">Weekly</div><div class="font-light mt-2">${_(this.weekRange())}</div></div><div class="flex flex-row-reverse"><claim-rewards></claim-rewards><bind-social-btn></bind-social-btn></div></div><div class="mt-3"><top-album weekly></top-album></div></div>${c(!this.isSmall,()=>o`<div class="flex-initial w-[32rem]"><div class="h-20 pt-1"><div class="font-bold text-xl">All</div></div><div class="mt-3"><top-album></top-album></div></div><div class="flex-initial w-32 pt-16 mt-7"><latest-votes></div>`)}</div>`}};v=A([u("view-home")],v);export{v as ViewHome};
