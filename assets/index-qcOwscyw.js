import{T as x,b as u,j as _,f as P,l as b}from"./index-WM_qie3O.js";import{t as C,u as O}from"./action-UWqA7DrS.js";import{i as f,e as j,$ as L,f as $,x as o,j as T,n as v,B as w,u as l,c as m,g as y}from"./vendor-fjbkuLWx.js";import"./dialog-XTmBtgOp.js";const D="li.header{margin-bottom:.75rem;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:#a3a3a3;color:rgba(163,163,163,var(--tw-text-opacity))}li.item:hover{background-color:#ffffff0d}@media (min-width: 500px){.name{font-size:1rem;line-height:1.5rem}}.icon{font-size:1.5rem;line-height:2rem}@media (max-width: 500px){.icon{font-size:1.5rem;line-height:2rem}}";var V=Object.defineProperty,M=Object.getOwnPropertyDescriptor,h=(t,e,r,i)=>{for(var s=i>1?void 0:i?M(e,r):e,n=t.length-1,c;n>=0;n--)(c=t[n])&&(s=(i?c(e,r,s):c(s))||s);return i&&s&&V(e,r,s),s};let p=class extends x(D){constructor(){super(...arguments),this.bindBridge=new f(this,u),this.weekly=!1,this.address="",this.trackList=[],this.pending=!1,this.err="",this.ts=0,this.go2=t=>{this.disabled?j.emit("connect-wallet"):L(`/track/${t.address}`)},this.init=async()=>{this.pending=!0;try{let{user:{subjectsCreated:t}}=await C(this.address);this.trackList=t.map(e=>{const{totalVoteValue:r}=e;return{...e,totalVal:$(r)}})}catch(t){this.err=t.message||t.msg||t,_.add({summary:"Fetch failed",detail:this.err})}finally{this.pending=!1,this.ts++}}}get disabled(){return!u.bridge.account}connectedCallback(){super.connectedCallback(),this.init()}render(){return o`<div role="list" class="ui-list py-6 ${T(this.$c([this.pending?"loading":"hover"]))}"><div class="flex header"><div class="w-16">Index</div><div class="flex-auto">Name</div><div class="flex-none w-40">Created</div><div class="flex-none w-20 text-right">Voters</div><div class="flex-none w-24 text-right">Tickets</div><div class="flex-none w-24 text-right">Vote Value</div></div>${v(!this.ts&&!this.trackList.length,()=>o`<div name="Loading" class="doc-intro"><div class="flex flex-col gap-8 m-6">${w([...Array(3).keys()],()=>o`<div name="Loading" class="doc-intro"><loading-skeleton num="4"></loading-skeleton></div>`)}</div></div>`,()=>o`${w(this.trackList,(t,e)=>o`<div class="item flex py-2 pr-2 items-center cursor-pointer" @click="${()=>this.go2(t)}"><div class="flex-none w-16 pl-4 text-sm font-light opacity-75">${e+1} ${v(this.trackList.length>3&&e<3,()=>o`<i class="mdi mdi-fire text-red-400"></i>`)}</div><div class="flex-auto flex"><div class="w-[3.25rem] h-[3.25rem] mr-4 rounded-lg"><img-loader src="${t.image}" class="rounded-lg"></img-loader></div><div><p class="name truncate">${t.name}</p><span class="icon mt-1"><i class="mdi mdi-play-circle-outline"></i></span></div></div><div class="flex-none w-40 text-xs text-gray-300/60">${P(t.createdAt)}</div><div class="flex-none w-20 text-right text-sm"><p class="num truncate mt-2">${t.fansNumber}</p></div><div class="flex-none w-24 text-right text-sm"><p class="num truncate mt-2">${t.supply}</p></div><div class="flex-none w-24 text-right text-sm"><p class="num truncate mt-2">${t.totalVal}</p></div></div>`)}`)}</div>`}};h([m({type:Boolean})],p.prototype,"weekly",2);h([m({type:String})],p.prototype,"address",2);h([l()],p.prototype,"trackList",2);h([l()],p.prototype,"pending",2);h([l()],p.prototype,"err",2);h([l()],p.prototype,"ts",2);p=h([y("track-list")],p);const S='.middle-dot-divider:after{content:"Â·";padding:0 .375rem;font-weight:600}';var B=Object.defineProperty,F=Object.getOwnPropertyDescriptor,d=(t,e,r,i)=>{for(var s=i>1?void 0:i?F(e,r):e,n=t.length-1,c;n>=0;n--)(c=t[n])&&(s=(i?c(e,r,s):c(s))||s);return i&&s&&B(e,r,s),s};const z=()=>({loading:"",tx:""});let a=class extends x(S){constructor(){super(...arguments),this.bindBridge=new f(this,u),this.bindTweets=new f(this,b),this.weekly=!1,this.address="",this.retreatDisabled=!0,this.voteList=[],this.pending=!1,this.prompt=!1,this.dialog=!1,this.promptMessage="",this.err=z(),this.ts=0,this.updateErr=(t={})=>this.err=Object.assign({},this.err,t),this.init=async()=>{this.pending=!0;try{let t=await O(this.address);this.user=t.user,this.readFromTwitter()}catch(t){this.updateErr({load:t.message||t}),this.promptMessage=t,this.prompt=!0;return}finally{this.ts++,this.pending=!1}},this.close=()=>{this.dialog=!1,this.init()}}get disabled(){return!u.bridge.account}connectedCallback(){super.connectedCallback(),this.init()}getRandomInt(t){return Math.floor(Math.random()*t)}async readFromTwitter(){let{uri:t}=this.user.socials[0]??{};this.social=await b.fromUri(t,this.user.address)}render(){return o`<div class="m-4 text-center">${v(!this.ts&&!this.err.loading,()=>o`<div name="Loading" class="doc-intro"><div class="flex flex-col gap-8 m-8"><loading-skeleton num="3"></loading-skeleton></div></div>`,()=>o`${v(this.prompt,()=>o`<p class="text-center text-orange-600">${this.promptMessage}</p>`,()=>{var t;return o`<div class="py-4"><ui-address class="text-lg" .address="${this.user.address}" short avatar></ui-address><div class="my-4">${v((t=this.social)==null?void 0:t.id,()=>{var e,r,i;return o`<span class="text-base font-light middle-dot-divider">${(e=this.social)==null?void 0:e.name}</span><span class="text-base font-light"> <a href="${(r=this.social)==null?void 0:r.url}" class="text-blue-300" target="_blank">@${(i=this.social)==null?void 0:i.id}</a></span>`})}</div><div class="mt-0.5"><span class="text-base text-white/70 middle-dot-divider">Holding <span class="ml-1 text-blue-300">${this.user.holding??"-"}</span></span> <span class="text-base text-white/70">Reward Claimed <span class="ml-1 text-blue-300">${this.user.rewardClaimed?parseFloat((+$(this.user.rewardClaimed)).toFixed(4)):"-"}</span></span></div></div>`})}`)}</div>`}};d([m({type:Boolean})],a.prototype,"weekly",2);d([m({type:String})],a.prototype,"address",2);d([m({type:Promise})],a.prototype,"votes",2);d([l()],a.prototype,"myVotes",2);d([l()],a.prototype,"retreatDisabled",2);d([l()],a.prototype,"social",2);d([l()],a.prototype,"user",2);d([l()],a.prototype,"voteList",2);d([l()],a.prototype,"pending",2);d([l()],a.prototype,"prompt",2);d([l()],a.prototype,"dialog",2);d([l()],a.prototype,"promptMessage",2);d([l()],a.prototype,"err",2);d([l()],a.prototype,"ts",2);a=d([y("user-detail")],a);const E="";var I=Object.defineProperty,A=Object.getOwnPropertyDescriptor,k=(t,e,r,i)=>{for(var s=i>1?void 0:i?A(e,r):e,n=t.length-1,c;n>=0;n--)(c=t[n])&&(s=(i?c(e,r,s):c(s))||s);return i&&s&&I(e,r,s),s};let g=class extends x(E){constructor(){super(...arguments),this.addr=""}render(){return o`<div class="ui-container mx-auto flex flex-col place-content-center pt-10">
      <!-- user profile -->
      <user-detail .address=${this.addr} class="mx-auto"></user-detail>

      <div class="w-full inline-flex pb-2 border-b border-slate-50/10">
        <div class="py-1.5 px-3 text-base font-normal text-white/70 rounded-md">Tracks</div>
      </div>

      <track-list .address=${this.addr}></track-list>

      <!-- <div class="h-20 pt-1 mb-8">
        <div class="font-bold text-xl">
          <user-detail .address=${this.addr}> </user-detail>
        </div>
      </div>
      <div class="h-10 pt-1 mt-20">
        <div class="font-bold text-xl">Tracks</div>
      </div>
      <div class="mt-0">
        <track-list .address=${this.addr}></track-list>
      </div> -->
    </div>`}};k([m({type:String})],g.prototype,"addr",2);g=k([y("user-page")],g);export{g as TrackPage};
