import{T as h,s as g}from"./index-ScVDk39a.js";import"./socialbtn-t2SrcQf2.js";import{g as f,h as w,a as x}from"./claim-aOYdu2d_.js";import{q as b,x as o,c as u,h as y,u as S,f as d,d as $,b as p,a as _,v as V}from"./vendor-od9KRoES.js";const D=async t=>{let i=`{
      voteLogs(first: ${t}, orderBy: time, orderDirection:desc) {
        id
        voter{
          address
        }
        time
        value
      }
    }`;return await f("MediaBoard",i)},O=".text-highlight{color:var(--colorHighlight)}svg{display:inline-flex;align-items:center;overflow:hidden;border-radius:9999px;background:rgb(200,20,68)}svg svg{height:100%;width:100%}";var P=Object.defineProperty,j=Object.getOwnPropertyDescriptor,c=(t,i,r,s)=>{for(var e=s>1?void 0:s?j(i,r):i,a=t.length-1,l;a>=0;a--)(l=t[a])&&(e=(s?l(i,r,e):l(e))||e);return s&&e&&P(i,r,e),e};let n=class extends h(O){constructor(){super(...arguments),this.weekly=!1,this.latestVotes=[],this.albumToVote={id:"",voter:0,time:0,value:0},this.pending=!1,this.init=async()=>{this.pending=!0;try{let t=await D(20);console.log(t),this.latestVotes=t.voteLogs}catch(t){console.error(t)}console.log(this.latestVotes),this.pending=!1},this.timeAgo=async function*(t){for(;;){let i=BigInt(new Date().getTime())/1000n,r=i-t,s=r/86400n,e=(r-s*86400n)/3600n,a=(r-s*86400n-e*3600n)/60n,l="";s>0&&(l+=s.toString()+"d "),e>0&&(l+=+e.toString()+"h "),a>0&&(l+=a.toString()+"m "),l?l+="ago":l="<1m",yield l,await new Promise(m=>setTimeout(m,1e3))}}}connectedCallback(){super.connectedCallback(),this.init()}static avatar(t){return b(32,parseInt(t.slice(2,10),16)).querySelector("svg")}render(){return o`${u(this.pending&&this.latestVotes.length==0,()=>o`<loading-skeleton num="4"></loading-skeleton>`)}<ul role="list">${y(this.latestVotes,(t,i)=>o`<li class="py-2 justify-end"><div class="flex items-end justify-end space-x-2">${n.avatar(t.voter.address)}<p class="text-highlight text-2xl">${S(t.value,18)}</p></div><div><p class="font-light text-gray-400 text-right text-sm">${w(this.timeAgo(BigInt(t.time)))}</p></div></li>`)}</ul>`}};c([$({type:Boolean})],n.prototype,"weekly",2);c([d()],n.prototype,"latestVotes",2);c([d()],n.prototype,"albumToVote",2);c([d()],n.prototype,"pending",2);n=c([p("latest-votes")],n);const C=".text-highlight{color:var(--colorHighlight)}";var T=Object.defineProperty,L=Object.getOwnPropertyDescriptor,k=(t,i,r,s)=>{for(var e=s>1?void 0:s?L(i,r):i,a=t.length-1,l;a>=0;a--)(l=t[a])&&(e=(s?l(i,r,e):l(e))||e);return s&&e&&T(i,r,e),e};let v=class extends h(C){constructor(){super(...arguments),this.bindScreen=new _(this,g)}get isSmall(){return g.screen.lg}connectedCallback(){super.connectedCallback()}async weekRange(){return x().then(t=>{const i=7n*24n*60n*60n;let r=t+i,s=new Date(Number(t*1000n)),e=new Date(Number(r*1000n));return console.log(t,s),s.toLocaleString("en-US",{month:"short"})+s.getDate()+(s.getFullYear()==e.getFullYear()?"":", "+e.getFullYear())+"-"+(s.getMonth()==e.getMonth()?"":e.toLocaleString("en-us",{month:"short"}))+e.getDate()+", "+e.getFullYear()})}render(){return o`<div class="flex px-8 space-x-8 place-content-center"><div class="flex-initial w-[32rem]"><div class="flex justify-between h-20"><div><div class="font-bold text-2xl text-highlight">Weekly</div><div class="font-light mt-2">${V(this.weekRange())}</div></div><div class="flex flex-row-reverse"><claim-rewards></claim-rewards><bind-social-btn></bind-social-btn></div></div><div class="mt-3"><top-album weekly></top-album></div></div>${u(!this.isSmall,()=>o`<div class="flex-initial w-[32rem]"><div class="h-20 pt-1"><div class="font-bold text-xl">All</div></div><div class="mt-3"><top-album></top-album></div></div><div class="flex-initial w-32 pt-16"><latest-votes></div>`)}</div>`}};v=k([p("view-home")],v);export{v as ViewHome};
