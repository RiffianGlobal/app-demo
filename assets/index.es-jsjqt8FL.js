import{ad as Fw,ae as Uc,af as gr,ag as nr,ah as vf,ai as re,aj as mf,ak as Do,al as Gw,am as wf,an as Sc,ao as Ww,ap as Ro,aq as Jw,ar as Qw,as as Yw,at as Xw,au as Ps,av as $r,aw as Zw,ax as bf,a6 as _f,ay as zc,a5 as e0,_ as t0}from"./vendor-L6D-Rps7.js";const r0=":";function i0(n){const[t,r]=n.split(r0);return{namespace:t,reference:r}}function s0(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}function Ef(n,t){return n.includes(":")?[n]:t.chains||[]}const If="base10",sr="base16",Oc="base64pad",Hc="utf8",xf=0,Qi=1,n0=0,tl=1,Rc=12,kc=32;function o0(){const n=mf.generateKeyPair();return{privateKey:nr(n.secretKey,sr),publicKey:nr(n.publicKey,sr)}}function Tc(){const n=Do.randomBytes(kc);return nr(n,sr)}function a0(n,t){const r=mf.sharedKey(gr(n,sr),gr(t,sr),!0),s=new Gw(Uc.SHA256,r).expand(kc);return nr(s,sr)}function c0(n){const t=Uc.hash(gr(n,sr));return nr(t,sr)}function Es(n){const t=Uc.hash(gr(n,Hc));return nr(t,sr)}function u0(n){return gr(`${n}`,If)}function cn(n){return Number(nr(n,If))}function h0(n){const t=u0(typeof n.type<"u"?n.type:xf);if(cn(t)===Qi&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?gr(n.senderPublicKey,sr):void 0,s=typeof n.iv<"u"?gr(n.iv,sr):Do.randomBytes(Rc),a=new wf.ChaCha20Poly1305(gr(n.symKey,sr)).seal(s,gr(n.message,Hc));return f0({type:t,sealed:a,iv:s,senderPublicKey:r})}function l0(n){const t=new wf.ChaCha20Poly1305(gr(n.symKey,sr)),{sealed:r,iv:s}=To(n.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return nr(a,Hc)}function f0(n){if(cn(n.type)===Qi){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return nr(Sc([n.type,n.senderPublicKey,n.iv,n.sealed]),Oc)}return nr(Sc([n.type,n.iv,n.sealed]),Oc)}function To(n){const t=gr(n,Oc),r=t.slice(n0,tl),s=tl;if(cn(r)===Qi){const g=s+kc,b=g+Rc,y=t.slice(s,g),E=t.slice(g,b),O=t.slice(b);return{type:r,sealed:O,iv:E,senderPublicKey:y}}const a=s+Rc,h=t.slice(s,a),f=t.slice(a);return{type:r,sealed:f,iv:h}}function p0(n,t){const r=To(n);return Pf({type:cn(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?nr(r.senderPublicKey,sr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Pf(n){const t=(n==null?void 0:n.type)||xf;if(t===Qi){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function rl(n){return n.type===Qi&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var d0=Object.defineProperty,il=Object.getOwnPropertySymbols,g0=Object.prototype.hasOwnProperty,y0=Object.prototype.propertyIsEnumerable,sl=(n,t,r)=>t in n?d0(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,nl=(n,t)=>{for(var r in t||(t={}))g0.call(t,r)&&sl(n,r,t[r]);if(il)for(var r of il(t))y0.call(t,r)&&sl(n,r,t[r]);return n};const v0="ReactNative",Er={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},m0="js";function Kc(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ss(){return!Ww()&&!!vf()&&navigator.product===v0}function Os(){return!Kc()&&!!vf()}function un(){return Ss()?Er.reactNative:Kc()?Er.node:Os()?Er.browser:Er.unknown}function w0(){var n;try{return Ss()&&typeof globalThis<"u"&&typeof(globalThis==null?void 0:globalThis.Application)<"u"?(n=globalThis.Application)==null?void 0:n.applicationId:void 0}catch{return}}function b0(n,t){let r=Ro.parse(n);return r=nl(nl({},r),t),n=Ro.stringify(r),n}function _0(){return Fw()||{name:"",description:"",url:"",icons:[""]}}function E0(){if(un()===Er.reactNative&&typeof globalThis<"u"&&typeof(globalThis==null?void 0:globalThis.Platform)<"u"){const{OS:r,Version:s}=globalThis.Platform;return[r,s].join("-")}const n=Jw();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function I0(){var n;const t=un();return t===Er.browser?[t,((n=Qw())==null?void 0:n.host)||"unknown"].join(":"):t}function x0(n,t,r){const s=E0(),a=I0();return[[n,t].join("-"),[m0,r].join("-"),s,a].join("/")}function P0({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:h,useOnCloseEvent:f,bundleId:g}){const b=r.split("?"),y=x0(n,t,s),E={auth:a,ua:y,projectId:h,useOnCloseEvent:f||void 0,origin:g||void 0},O=b0(b[1]||"",E);return b[0]+"?"+O}function Wi(n,t){return n.filter(r=>t.includes(r)).length===n.length}function Sf(n){return Object.fromEntries(n.entries())}function Of(n){return new Map(Object.entries(n))}function bs(n=re.FIVE_MINUTES,t){const r=re.toMiliseconds(n||re.FIVE_MINUTES);let s,a,h;return{resolve:f=>{h&&s&&(clearTimeout(h),s(f))},reject:f=>{h&&a&&(clearTimeout(h),a(f))},done:()=>new Promise((f,g)=>{h=setTimeout(()=>{g(new Error(t))},r),s=f,a=g})}}function an(n,t,r){return new Promise(async(s,a)=>{const h=setTimeout(()=>a(new Error(r)),t);try{const f=await n;s(f)}catch(f){a(f)}clearTimeout(h)})}function Rf(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function S0(n){return Rf("topic",n)}function O0(n){return Rf("id",n)}function Tf(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Hr(n,t){return re.fromMiliseconds((t||Date.now())+re.toMiliseconds(n))}function Ri(n){return Date.now()>=re.toMiliseconds(n)}function Dt(n,t){return`${n}${t?`:${t}`:""}`}function uc(n=[],t=[]){return[...new Set([...n,...t])]}async function R0({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const h=`${a}/wc?requestId=${n}&sessionTopic=${t}`,f=un();f===Er.browser?h.startsWith("https://")?window.open(h,"_blank","noreferrer noopener"):window.open(h,"_self","noreferrer noopener"):f===Er.reactNative&&typeof(globalThis==null?void 0:globalThis.Linking)<"u"&&await globalThis.Linking.openURL(h)}catch(s){console.error(s)}}async function T0(n,t){try{return await n.getItem(t)||(Os()?localStorage.getItem(t):void 0)}catch(r){console.error(r)}}const A0="irn";function Ac(n){return(n==null?void 0:n.relay)||{protocol:A0}}function xo(n){const t=Yw[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var C0=Object.defineProperty,ol=Object.getOwnPropertySymbols,N0=Object.prototype.hasOwnProperty,$0=Object.prototype.propertyIsEnumerable,al=(n,t,r)=>t in n?C0(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,D0=(n,t)=>{for(var r in t||(t={}))N0.call(t,r)&&al(n,r,t[r]);if(ol)for(var r of ol(t))$0.call(t,r)&&al(n,r,t[r]);return n};function L0(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const h=a.replace(s,""),f=n[a];r[h]=f}}),r}function cl(n){n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),a=n.substring(t+1,r).split("@"),h=typeof r<"u"?n.substring(r):"",f=Ro.parse(h);return{protocol:s,topic:j0(a[0]),version:parseInt(a[1],10),symKey:f.symKey,relay:L0(f)}}function j0(n){return n.startsWith("//")?n.substring(2):n}function M0(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const h=r+t+a;n[a]&&(s[h]=n[a])}),s}function q0(n){return`${n.protocol}:${n.topic}@${n.version}?`+Ro.stringify(D0({symKey:n.symKey},M0(n.relay)))}function Rs(n){const t=[];return n.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function U0(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Rs(r.accounts))}),t}function z0(n,t){const r=[];return Object.values(n).forEach(s=>{Rs(s.accounts).includes(t)&&r.push(...s.methods)}),r}function H0(n,t){const r=[];return Object.values(n).forEach(s=>{Rs(s.accounts).includes(t)&&r.push(...s.events)}),r}function k0(n,t){const r=Po(n,t);if(r)throw new Error(r.message);const s={};for(const[a,h]of Object.entries(n))s[a]={methods:h.methods,events:h.events,chains:h.accounts.map(f=>`${f.split(":")[0]}:${f.split(":")[1]}`)};return s}function Vc(n){return n.includes(":")}function rn(n){return Vc(n)?n.split(":")[0]:n}const K0={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},V0={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function J(n,t){const{message:r,code:s}=V0[n];return{message:t?`${r} ${t}`:r,code:s}}function It(n,t){const{message:r,code:s}=K0[n];return{message:t?`${r} ${t}`:r,code:s}}function Yr(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function Is(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function ir(n){return typeof n>"u"}function kt(n,t){return t&&ir(n)?!0:typeof n=="string"&&!!n.trim().length}function Bc(n,t){return t&&ir(n)?!0:typeof n=="number"&&!isNaN(n)}function B0(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),a=Object.keys(r);let h=!0;return Wi(a,s)?(s.forEach(f=>{const{accounts:g,methods:b,events:y}=n.namespaces[f],E=Rs(g),O=r[f];(!Wi(Ef(f,O),E)||!Wi(O.methods,b)||!Wi(O.events,y))&&(h=!1)}),h):!1}function Ao(n){return kt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function F0(n){if(kt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Ao(r)}}return!1}function G0(n){if(kt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function W0(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function J0(n){return n==null?void 0:n.topic}function Q0(n,t){let r=null;return kt(n==null?void 0:n.publicKey,!1)||(r=J("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function ul(n){let t=!0;return Yr(n)?n.length&&(t=n.every(r=>kt(r,!1))):t=!1,t}function Y0(n,t,r){let s=null;return Yr(t)&&t.length?t.forEach(a=>{s||Ao(a)||(s=It("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Ao(n)||(s=It("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function X0(n,t,r){let s=null;return Object.entries(n).forEach(([a,h])=>{if(s)return;const f=Y0(a,Ef(a,h),`${t} ${r}`);f&&(s=f)}),s}function Z0(n,t){let r=null;return Yr(n)?n.forEach(s=>{r||F0(s)||(r=It("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=It("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function eb(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=Z0(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function tb(n,t){let r=null;return ul(n==null?void 0:n.methods)?ul(n==null?void 0:n.events)||(r=It("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=It("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Af(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=tb(s,`${t}, namespace`);a&&(r=a)}),r}function rb(n,t,r){let s=null;if(n&&Is(n)){const a=Af(n,t);a&&(s=a);const h=X0(n,t,r);h&&(s=h)}else s=J("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Po(n,t){let r=null;if(n&&Is(n)){const s=Af(n,t);s&&(r=s);const a=eb(n,t);a&&(r=a)}else r=J("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Cf(n){return kt(n.protocol,!0)}function ib(n,t){let r=!1;return t&&!n?r=!0:n&&Yr(n)&&n.length&&n.forEach(s=>{r=Cf(s)}),r}function sb(n){return typeof n=="number"}function dr(n){return typeof n<"u"&&typeof n!==null}function nb(n){return!(!n||typeof n!="object"||!n.code||!Bc(n.code,!1)||!n.message||!kt(n.message,!1))}function ob(n){return!(ir(n)||!kt(n.method,!1))}function ab(n){return!(ir(n)||ir(n.result)&&ir(n.error)||!Bc(n.id,!1)||!kt(n.jsonrpc,!1))}function cb(n){return!(ir(n)||!kt(n.name,!1))}function hl(n,t){return!(!Ao(t)||!U0(n).includes(t))}function ub(n,t,r){return kt(r,!1)?z0(n,t).includes(r):!1}function hb(n,t,r){return kt(r,!1)?H0(n,t).includes(r):!1}function ll(n,t,r){let s=null;const a=lb(n),h=fb(t),f=Object.keys(a),g=Object.keys(h),b=fl(Object.keys(n)),y=fl(Object.keys(t)),E=b.filter(O=>!y.includes(O));return E.length&&(s=J("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${E.toString()}
      Received: ${Object.keys(t).toString()}`)),Wi(f,g)||(s=J("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${f.toString()}
      Approved: ${g.toString()}`)),Object.keys(t).forEach(O=>{if(!O.includes(":")||s)return;const C=Rs(t[O].accounts);C.includes(O)||(s=J("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${O}
        Required: ${O}
        Approved: ${C.toString()}`))}),f.forEach(O=>{s||(Wi(a[O].methods,h[O].methods)?Wi(a[O].events,h[O].events)||(s=J("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${O}`)):s=J("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${O}`))}),s}function lb(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{t[a]={methods:n[r].methods,events:n[r].events}})}),t}function fl(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function fb(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Rs(n[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:n[r].accounts.filter(h=>h.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function pb(n,t){return Bc(n,!1)&&n<=t.max&&n>=t.min}function pl(){const n=un();return new Promise(t=>{switch(n){case Er.browser:t(db());break;case Er.reactNative:t(gb());break;case Er.node:t(yb());break;default:t(!0)}})}function db(){return Os()&&(navigator==null?void 0:navigator.onLine)}async function gb(){if(Ss()&&typeof globalThis<"u"&&globalThis!=null&&globalThis.NetInfo){const n=await(globalThis==null?void 0:globalThis.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function yb(){return!0}function vb(n){switch(un()){case Er.browser:mb(n);break;case Er.reactNative:wb(n);break}}function mb(n){!Ss()&&Os()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function wb(n){Ss()&&typeof globalThis<"u"&&globalThis!=null&&globalThis.NetInfo&&(globalThis==null||globalThis.NetInfo.addEventListener(t=>n(t==null?void 0:t.isConnected)))}const hc={};let mo=class{static get(t){return hc[t]}static set(t,r){hc[t]=r}static delete(t){delete hc[t]}};const bb=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,_b=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Eb=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Ib(n,t){if(n==="__proto__"||n==="constructor"&&t&&typeof t=="object"&&"prototype"in t){xb(n);return}return t}function xb(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function wo(n,t={}){if(typeof n!="string")return n;const r=n.trim();if(n[0]==='"'&&n.at(-1)==='"'&&!n.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!Eb.test(n)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(bb.test(n)||_b.test(n)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,Ib)}return JSON.parse(n)}catch(s){if(t.strict)throw s;return n}}function Pb(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function Ht(n,...t){try{return Pb(n(...t))}catch(r){return Promise.reject(r)}}function Sb(n){const t=typeof n;return n===null||t!=="object"&&t!=="function"}function Ob(n){const t=Object.getPrototypeOf(n);return!t||t.isPrototypeOf(Object)}function So(n){if(Sb(n))return String(n);if(Ob(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return So(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Nf(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Cc="base64:";function Rb(n){if(typeof n=="string")return n;Nf();const t=Buffer.from(n).toString("base64");return Cc+t}function Tb(n){return typeof n!="string"||!n.startsWith(Cc)?n:(Nf(),Buffer.from(n.slice(Cc.length),"base64"))}function pr(n){return n?n.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Ab(...n){return pr(n.join(":"))}function bo(n){return n=pr(n),n?n+":":""}const Cb="memory",Nb=()=>{const n=new Map;return{name:Cb,options:{},hasItem(t){return n.has(t)},getItem(t){return n.get(t)??null},getItemRaw(t){return n.get(t)??null},setItem(t,r){n.set(t,r)},setItemRaw(t,r){n.set(t,r)},removeItem(t){n.delete(t)},getKeys(){return Array.from(n.keys())},clear(){n.clear()},dispose(){n.clear()}}};function $b(n={}){const t={mounts:{"":n.driver||Nb()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=y=>{for(const E of t.mountpoints)if(y.startsWith(E))return{base:E,relativeKey:y.slice(E.length),driver:t.mounts[E]};return{base:"",relativeKey:y,driver:t.mounts[""]}},s=(y,E)=>t.mountpoints.filter(O=>O.startsWith(y)||E&&y.startsWith(O)).map(O=>({relativeBase:y.length>O.length?y.slice(O.length):void 0,mountpoint:O,driver:t.mounts[O]})),a=(y,E)=>{if(t.watching){E=pr(E);for(const O of t.watchListeners)O(y,E)}},h=async()=>{if(!t.watching){t.watching=!0;for(const y in t.mounts)t.unwatch[y]=await dl(t.mounts[y],a,y)}},f=async()=>{if(t.watching){for(const y in t.unwatch)await t.unwatch[y]();t.unwatch={},t.watching=!1}},g=(y,E,O)=>{const C=new Map,U=A=>{let B=C.get(A.base);return B||(B={driver:A.driver,base:A.base,items:[]},C.set(A.base,B)),B};for(const A of y){const B=typeof A=="string",ie=pr(B?A:A.key),he=B?void 0:A.value,le=B||!A.options?E:{...E,...A.options},fe=r(ie);U(fe).items.push({key:ie,value:he,relativeKey:fe.relativeKey,options:le})}return Promise.all([...C.values()].map(A=>O(A))).then(A=>A.flat())},b={hasItem(y,E={}){y=pr(y);const{relativeKey:O,driver:C}=r(y);return Ht(C.hasItem,O,E)},getItem(y,E={}){y=pr(y);const{relativeKey:O,driver:C}=r(y);return Ht(C.getItem,O,E).then(U=>wo(U))},getItems(y,E){return g(y,E,O=>O.driver.getItems?Ht(O.driver.getItems,O.items.map(C=>({key:C.relativeKey,options:C.options})),E).then(C=>C.map(U=>({key:Ab(O.base,U.key),value:wo(U.value)}))):Promise.all(O.items.map(C=>Ht(O.driver.getItem,C.relativeKey,C.options).then(U=>({key:C.key,value:wo(U)})))))},getItemRaw(y,E={}){y=pr(y);const{relativeKey:O,driver:C}=r(y);return C.getItemRaw?Ht(C.getItemRaw,O,E):Ht(C.getItem,O,E).then(U=>Tb(U))},async setItem(y,E,O={}){if(E===void 0)return b.removeItem(y);y=pr(y);const{relativeKey:C,driver:U}=r(y);U.setItem&&(await Ht(U.setItem,C,So(E),O),U.watch||a("update",y))},async setItems(y,E){await g(y,E,async O=>{O.driver.setItems&&await Ht(O.driver.setItems,O.items.map(C=>({key:C.relativeKey,value:So(C.value),options:C.options})),E),O.driver.setItem&&await Promise.all(O.items.map(C=>Ht(O.driver.setItem,C.relativeKey,So(C.value),C.options)))})},async setItemRaw(y,E,O={}){if(E===void 0)return b.removeItem(y,O);y=pr(y);const{relativeKey:C,driver:U}=r(y);if(U.setItemRaw)await Ht(U.setItemRaw,C,E,O);else if(U.setItem)await Ht(U.setItem,C,Rb(E),O);else return;U.watch||a("update",y)},async removeItem(y,E={}){typeof E=="boolean"&&(E={removeMeta:E}),y=pr(y);const{relativeKey:O,driver:C}=r(y);C.removeItem&&(await Ht(C.removeItem,O,E),(E.removeMeta||E.removeMata)&&await Ht(C.removeItem,O+"$",E),C.watch||a("remove",y))},async getMeta(y,E={}){typeof E=="boolean"&&(E={nativeOnly:E}),y=pr(y);const{relativeKey:O,driver:C}=r(y),U=Object.create(null);if(C.getMeta&&Object.assign(U,await Ht(C.getMeta,O,E)),!E.nativeOnly){const A=await Ht(C.getItem,O+"$",E).then(B=>wo(B));A&&typeof A=="object"&&(typeof A.atime=="string"&&(A.atime=new Date(A.atime)),typeof A.mtime=="string"&&(A.mtime=new Date(A.mtime)),Object.assign(U,A))}return U},setMeta(y,E,O={}){return this.setItem(y+"$",E,O)},removeMeta(y,E={}){return this.removeItem(y+"$",E)},async getKeys(y,E={}){y=bo(y);const O=s(y,!0);let C=[];const U=[];for(const A of O){const ie=(await Ht(A.driver.getKeys,A.relativeBase,E)).map(he=>A.mountpoint+pr(he)).filter(he=>!C.some(le=>he.startsWith(le)));U.push(...ie),C=[A.mountpoint,...C.filter(he=>!he.startsWith(A.mountpoint))]}return y?U.filter(A=>A.startsWith(y)&&!A.endsWith("$")):U.filter(A=>!A.endsWith("$"))},async clear(y,E={}){y=bo(y),await Promise.all(s(y,!1).map(async O=>{if(O.driver.clear)return Ht(O.driver.clear,O.relativeBase,E);if(O.driver.removeItem){const C=await O.driver.getKeys(O.relativeBase||"",E);return Promise.all(C.map(U=>O.driver.removeItem(U,E)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(y=>gl(y)))},async watch(y){return await h(),t.watchListeners.push(y),async()=>{t.watchListeners=t.watchListeners.filter(E=>E!==y),t.watchListeners.length===0&&await f()}},async unwatch(){t.watchListeners=[],await f()},mount(y,E){if(y=bo(y),y&&t.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(t.mountpoints.push(y),t.mountpoints.sort((O,C)=>C.length-O.length)),t.mounts[y]=E,t.watching&&Promise.resolve(dl(E,a,y)).then(O=>{t.unwatch[y]=O}).catch(console.error),b},async unmount(y,E=!0){y=bo(y),!(!y||!t.mounts[y])&&(t.watching&&y in t.unwatch&&(t.unwatch[y](),delete t.unwatch[y]),E&&await gl(t.mounts[y]),t.mountpoints=t.mountpoints.filter(O=>O!==y),delete t.mounts[y])},getMount(y=""){y=pr(y)+":";const E=r(y);return{driver:E.driver,base:E.base}},getMounts(y="",E={}){return y=pr(y),s(y,E.parents).map(C=>({driver:C.driver,base:C.mountpoint}))}};return b}function dl(n,t,r){return n.watch?n.watch((s,a)=>t(s,r+a)):()=>{}}async function gl(n){typeof n.dispose=="function"&&await Ht(n.dispose)}function Yi(n){return new Promise((t,r)=>{n.oncomplete=n.onsuccess=()=>t(n.result),n.onabort=n.onerror=()=>r(n.error)})}function $f(n,t){const r=indexedDB.open(n);r.onupgradeneeded=()=>r.result.createObjectStore(t);const s=Yi(r);return(a,h)=>s.then(f=>h(f.transaction(t,a).objectStore(t)))}let lc;function hn(){return lc||(lc=$f("keyval-store","keyval")),lc}function yl(n,t=hn()){return t("readonly",r=>Yi(r.get(n)))}function Db(n,t,r=hn()){return r("readwrite",s=>(s.put(t,n),Yi(s.transaction)))}function Lb(n,t=hn()){return t("readwrite",r=>(r.delete(n),Yi(r.transaction)))}function jb(n=hn()){return n("readwrite",t=>(t.clear(),Yi(t.transaction)))}function Mb(n,t){return n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Yi(n.transaction)}function qb(n=hn()){return n("readonly",t=>{if(t.getAllKeys)return Yi(t.getAllKeys());const r=[];return Mb(t,s=>r.push(s.key)).then(()=>r)})}const Ub=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),zb=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function ln(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return zb(n)}catch{return n}}function Ji(n){return typeof n=="string"?n:Ub(n)||""}const Hb="idb-keyval";var kb=(n={})=>{const t=n.base&&n.base.length>0?`${n.base}:`:"",r=a=>t+a;let s;return n.dbName&&n.storeName&&(s=$f(n.dbName,n.storeName)),{name:Hb,options:n,async hasItem(a){return!(typeof await yl(r(a),s)>"u")},async getItem(a){return await yl(r(a),s)??null},setItem(a,h){return Db(r(a),h,s)},removeItem(a){return Lb(r(a),s)},getKeys(){return qb(s)},clear(){return jb(s)}}};const Kb="WALLET_CONNECT_V2_INDEXED_DB",Vb="keyvaluestorage";let Bb=class{constructor(){this.indexedDb=$b({driver:kb({dbName:Kb,storeName:Vb})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Ji(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var fc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},Oo={exports:{}};(function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof fc<"u"&&fc.localStorage?Oo.exports=fc.localStorage:typeof window<"u"&&window.localStorage?Oo.exports=window.localStorage:Oo.exports=new t})();function Fb(n){var t;return[n[0],ln((t=n[1])!=null?t:"")]}class Gb{constructor(){this.localStorage=Oo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Fb)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return ln(r)}async setItem(t,r){this.localStorage.setItem(t,Ji(r))}async removeItem(t){this.localStorage.removeItem(t)}}const Wb="wc_storage_version",vl=1,Jb=async(n,t,r)=>{const s=Wb,a=await t.getItem(s);if(a&&a>=vl){r(t);return}const h=await n.getKeys();if(!h.length){r(t);return}const f=[];for(;h.length;){const g=h.shift();if(!g)continue;const b=g.toLowerCase();if(b.includes("wc@")||b.includes("walletconnect")||b.includes("wc_")||b.includes("wallet_connect")){const y=await n.getItem(g);await t.setItem(g,y),f.push(g)}}await t.setItem(s,vl),r(t),Qb(n,f)},Qb=async(n,t)=>{t.length&&t.forEach(async r=>{await n.removeItem(r)})};let Yb=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new Gb;this.storage=t;try{const r=new Bb;Jb(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var Ts={},Js={},pc={},Qs={};let Xi=class{};const Xb=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Xi},Symbol.toStringTag,{value:"Module"})),Zb=Xw(Xb);var ml;function e_(){if(ml)return Qs;ml=1,Object.defineProperty(Qs,"__esModule",{value:!0}),Qs.IHeartBeat=void 0;const n=Zb;class t extends n.IEvents{constructor(s){super()}}return Qs.IHeartBeat=t,Qs}var wl;function Df(){return wl||(wl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Ps.__exportStar(e_(),n)}(pc)),pc}var dc={},Fi={},bl;function t_(){if(bl)return Fi;bl=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.HEARTBEAT_EVENTS=Fi.HEARTBEAT_INTERVAL=void 0;const n=re;return Fi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Fi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Fi}var _l;function Lf(){return _l||(_l=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Ps.__exportStar(t_(),n)}(dc)),dc}var El;function r_(){if(El)return Js;El=1,Object.defineProperty(Js,"__esModule",{value:!0}),Js.HeartBeat=void 0;const n=Ps,t=$r,r=re,s=Df(),a=Lf();class h extends s.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||a.HEARTBEAT_INTERVAL}static init(g){return n.__awaiter(this,void 0,void 0,function*(){const b=new h(g);return yield b.init(),b})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,b){this.events.on(g,b)}once(g,b){this.events.once(g,b)}off(g,b){this.events.off(g,b)}removeListener(g,b){this.events.removeListener(g,b)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Js.HeartBeat=h,Js}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Ps;t.__exportStar(r_(),n),t.__exportStar(Df(),n),t.__exportStar(Lf(),n)})(Ts);var Ae={},gc,Il;function i_(){if(Il)return gc;Il=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}gc=t;function t(r,s,a){var h=a&&a.stringify||n,f=1;if(typeof r=="object"&&r!==null){var g=s.length+f;if(g===1)return r;var b=new Array(g);b[0]=h(r);for(var y=1;y<g;y++)b[y]=h(s[y]);return b.join(" ")}if(typeof r!="string")return r;var E=s.length;if(E===0)return r;for(var O="",C=1-f,U=-1,A=r&&r.length||0,B=0;B<A;){if(r.charCodeAt(B)===37&&B+1<A){switch(U=U>-1?U:0,r.charCodeAt(B+1)){case 100:case 102:if(C>=E||s[C]==null)break;U<B&&(O+=r.slice(U,B)),O+=Number(s[C]),U=B+2,B++;break;case 105:if(C>=E||s[C]==null)break;U<B&&(O+=r.slice(U,B)),O+=Math.floor(Number(s[C])),U=B+2,B++;break;case 79:case 111:case 106:if(C>=E||s[C]===void 0)break;U<B&&(O+=r.slice(U,B));var ie=typeof s[C];if(ie==="string"){O+="'"+s[C]+"'",U=B+2,B++;break}if(ie==="function"){O+=s[C].name||"<anonymous>",U=B+2,B++;break}O+=h(s[C]),U=B+2,B++;break;case 115:if(C>=E)break;U<B&&(O+=r.slice(U,B)),O+=String(s[C]),U=B+2,B++;break;case 37:U<B&&(O+=r.slice(U,B)),O+="%",U=B+2,B++,C--;break}++C}++B}return U===-1?r:(U<A&&(O+=r.slice(U)),O)}return gc}var yc,xl;function s_(){if(xl)return yc;xl=1;const n=i_();yc=a;const t=de().console||{},r={mapHttpRequest:A,mapHttpResponse:A,wrapRequestSerializer:B,wrapResponseSerializer:B,wrapErrorSerializer:B,req:A,res:A,err:C};function s(L,H){return Array.isArray(L)?L.filter(function(ve){return ve!=="!stdSerializers.err"}):L===!0?Object.keys(H):!1}function a(L){L=L||{},L.browser=L.browser||{};const H=L.browser.transmit;if(H&&typeof H.send!="function")throw Error("pino: transmit option must have a send function");const W=L.browser.write||t;L.browser.write&&(L.browser.asObject=!0);const ve=L.serializers||{},se=s(L.browser.serialize,ve);let ue=L.browser.serialize;Array.isArray(L.browser.serialize)&&L.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Ce=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),L.enabled===!1&&(L.level="silent");const ze=L.level||"info",m=Object.create(W);m.log||(m.log=ie),Object.defineProperty(m,"levelVal",{get:X}),Object.defineProperty(m,"level",{get:ce,set:F});const x={transmit:H,serialize:se,asObject:L.browser.asObject,levels:Ce,timestamp:U(L)};m.levels=a.levels,m.level=ze,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=ie,m.serializers=ve,m._serialize=se,m._stdErrSerialize=ue,m.child=k,H&&(m._logEvent=O());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function F(V){if(V!=="silent"&&!this.levels.values[V])throw Error("unknown level "+V);this._level=V,h(x,m,"error","log"),h(x,m,"fatal","error"),h(x,m,"warn","error"),h(x,m,"info","log"),h(x,m,"debug","log"),h(x,m,"trace","log")}function k(V,G){if(!V)throw new Error("missing bindings for child Pino");G=G||{},se&&V.serializers&&(G.serializers=V.serializers);const Je=G.serializers;if(se&&Je){var Ke=Object.assign({},ve,Je),Kr=L.browser.serialize===!0?Object.keys(Ke):se;delete V.serializers,b([V],Kr,Ke,this._stdErrSerialize)}function Ie(xt){this._childLevel=(xt._childLevel|0)+1,this.error=y(xt,V,"error"),this.fatal=y(xt,V,"fatal"),this.warn=y(xt,V,"warn"),this.info=y(xt,V,"info"),this.debug=y(xt,V,"debug"),this.trace=y(xt,V,"trace"),Ke&&(this.serializers=Ke,this._serialize=Kr),H&&(this._logEvent=O([].concat(xt._logEvent.bindings,V)))}return Ie.prototype=this,new Ie(this)}return m}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:le,unixTime:fe,isoTime:pe});function h(L,H,W,ve){const se=Object.getPrototypeOf(H);H[W]=H.levelVal>H.levels.values[W]?ie:se[W]?se[W]:t[W]||t[ve]||ie,f(L,H,W)}function f(L,H,W){!L.transmit&&H[W]===ie||(H[W]=function(ve){return function(){const ue=L.timestamp(),Ce=new Array(arguments.length),ze=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var m=0;m<Ce.length;m++)Ce[m]=arguments[m];if(L.serialize&&!L.asObject&&b(Ce,this._serialize,this.serializers,this._stdErrSerialize),L.asObject?ve.call(ze,g(this,W,Ce,ue)):ve.apply(ze,Ce),L.transmit){const x=L.transmit.level||H.level,X=a.levels.values[x],ce=a.levels.values[W];if(ce<X)return;E(this,{ts:ue,methodLevel:W,methodValue:ce,transmitLevel:x,transmitValue:a.levels.values[L.transmit.level||H.level],send:L.transmit.send,val:H.levelVal},Ce)}}}(H[W]))}function g(L,H,W,ve){L._serialize&&b(W,L._serialize,L.serializers,L._stdErrSerialize);const se=W.slice();let ue=se[0];const Ce={};ve&&(Ce.time=ve),Ce.level=a.levels.values[H];let ze=(L._childLevel|0)+1;if(ze<1&&(ze=1),ue!==null&&typeof ue=="object"){for(;ze--&&typeof se[0]=="object";)Object.assign(Ce,se.shift());ue=se.length?n(se.shift(),se):void 0}else typeof ue=="string"&&(ue=n(se.shift(),se));return ue!==void 0&&(Ce.msg=ue),Ce}function b(L,H,W,ve){for(const se in L)if(ve&&L[se]instanceof Error)L[se]=a.stdSerializers.err(L[se]);else if(typeof L[se]=="object"&&!Array.isArray(L[se]))for(const ue in L[se])H&&H.indexOf(ue)>-1&&ue in W&&(L[se][ue]=W[ue](L[se][ue]))}function y(L,H,W){return function(){const ve=new Array(1+arguments.length);ve[0]=H;for(var se=1;se<ve.length;se++)ve[se]=arguments[se-1];return L[W].apply(this,ve)}}function E(L,H,W){const ve=H.send,se=H.ts,ue=H.methodLevel,Ce=H.methodValue,ze=H.val,m=L._logEvent.bindings;b(W,L._serialize||Object.keys(L.serializers),L.serializers,L._stdErrSerialize===void 0?!0:L._stdErrSerialize),L._logEvent.ts=se,L._logEvent.messages=W.filter(function(x){return m.indexOf(x)===-1}),L._logEvent.level.label=ue,L._logEvent.level.value=Ce,ve(ue,L._logEvent,ze),L._logEvent=O(m)}function O(L){return{ts:0,messages:[],bindings:L||[],level:{label:"",value:0}}}function C(L){const H={type:L.constructor.name,msg:L.message,stack:L.stack};for(const W in L)H[W]===void 0&&(H[W]=L[W]);return H}function U(L){return typeof L.timestamp=="function"?L.timestamp:L.timestamp===!1?he:le}function A(){return{}}function B(L){return L}function ie(){}function he(){return!1}function le(){return Date.now()}function fe(){return Math.round(Date.now()/1e3)}function pe(){return new Date(Date.now()).toISOString()}function de(){function L(H){return typeof H<"u"&&H}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return L(self)||L(window)||L(this)||{}}}return yc}var Gi={},Pl;function jf(){return Pl||(Pl=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.PINO_CUSTOM_CONTEXT_KEY=Gi.PINO_LOGGER_DEFAULTS=void 0,Gi.PINO_LOGGER_DEFAULTS={level:"info"},Gi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Gi}var rr={},Sl;function n_(){if(Sl)return rr;Sl=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.generateChildLogger=rr.formatChildLoggerContext=rr.getLoggerContext=rr.setBrowserLoggerContext=rr.getBrowserLoggerContext=rr.getDefaultLoggerOptions=void 0;const n=jf();function t(g){return Object.assign(Object.assign({},g),{level:(g==null?void 0:g.level)||n.PINO_LOGGER_DEFAULTS.level})}rr.getDefaultLoggerOptions=t;function r(g,b=n.PINO_CUSTOM_CONTEXT_KEY){return g[b]||""}rr.getBrowserLoggerContext=r;function s(g,b,y=n.PINO_CUSTOM_CONTEXT_KEY){return g[y]=b,g}rr.setBrowserLoggerContext=s;function a(g,b=n.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof g.bindings>"u"?y=r(g,b):y=g.bindings().context||"",y}rr.getLoggerContext=a;function h(g,b,y=n.PINO_CUSTOM_CONTEXT_KEY){const E=a(g,y);return E.trim()?`${E}/${b}`:b}rr.formatChildLoggerContext=h;function f(g,b,y=n.PINO_CUSTOM_CONTEXT_KEY){const E=h(g,b,y),O=g.child({context:E});return s(O,E,y)}return rr.generateChildLogger=f,rr}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=Ps,r=t.__importDefault(s_());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(jf(),n),t.__exportStar(n_(),n)})(Ae);class o_ extends Xi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let a_=class extends Xi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},c_=class{constructor(t,r){this.logger=t,this.core=r}},u_=class extends Xi{constructor(t,r){super(),this.relayer=t,this.logger=r}},h_=class extends Xi{constructor(t){super()}},l_=class{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}};class f_ extends Xi{constructor(t,r){super(),this.relayer=t,this.logger=r}}let p_=class extends Xi{constructor(t,r){super(),this.core=t,this.logger=r}},d_=class{constructor(t,r){this.projectId=t,this.logger=r}},g_=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},y_=class{constructor(t){this.client=t}};var Fc={},Mf={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Zw,r=bf;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function g(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},g.prototype.update=function(b,y){if(y===void 0&&(y=b.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=b[E++],y--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(E=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,b,E,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=b[E++],y--;return this},g.prototype.finish=function(b){if(!this._finished){var y=this._bytesHashed,E=this._bufferLength,O=y/536870912|0,C=y<<3,U=y%128<112?128:256;this._buffer[E]=128;for(var A=E+1;A<U-8;A++)this._buffer[A]=0;t.writeUint32BE(O,this._buffer,U-8),t.writeUint32BE(C,this._buffer,U-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,U),this._finished=!0}for(var A=0;A<this.digestLength/8;A++)t.writeUint32BE(this._stateHi[A],b,A*8),t.writeUint32BE(this._stateLo[A],b,A*8+4);return this},g.prototype.digest=function(){var b=new Uint8Array(this.digestLength);return this.finish(b),b},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(b){return this._stateHi.set(b.stateHi),this._stateLo.set(b.stateLo),this._bufferLength=b.bufferLength,b.buffer&&this._buffer.set(b.buffer),this._bytesHashed=b.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(b){r.wipe(b.stateHi),r.wipe(b.stateLo),b.buffer&&r.wipe(b.buffer),b.bufferLength=0,b.bytesHashed=0},g}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(g,b,y,E,O,C,U){for(var A=y[0],B=y[1],ie=y[2],he=y[3],le=y[4],fe=y[5],pe=y[6],de=y[7],L=E[0],H=E[1],W=E[2],ve=E[3],se=E[4],ue=E[5],Ce=E[6],ze=E[7],m,x,X,ce,F,k,V,G;U>=128;){for(var Je=0;Je<16;Je++){var Ke=8*Je+C;g[Je]=t.readUint32BE(O,Ke),b[Je]=t.readUint32BE(O,Ke+4)}for(var Je=0;Je<80;Je++){var Kr=A,Ie=B,xt=ie,D=he,$=le,T=fe,u=pe,I=de,ee=L,ge=H,_e=W,Ne=ve,De=se,Se=ue,Pt=Ce,mt=ze;if(m=de,x=ze,F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=(le>>>14|se<<18)^(le>>>18|se<<14)^(se>>>9|le<<23),x=(se>>>14|le<<18)^(se>>>18|le<<14)^(le>>>9|se<<23),F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,m=le&fe^~le&pe,x=se&ue^~se&Ce,F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,m=a[Je*2],x=a[Je*2+1],F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,m=g[Je%16],x=b[Je%16],F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,X=V&65535|G<<16,ce=F&65535|k<<16,m=X,x=ce,F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=(A>>>28|L<<4)^(L>>>2|A<<30)^(L>>>7|A<<25),x=(L>>>28|A<<4)^(A>>>2|L<<30)^(A>>>7|L<<25),F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,m=A&B^A&ie^B&ie,x=L&H^L&W^H&W,F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,I=V&65535|G<<16,mt=F&65535|k<<16,m=D,x=Ne,F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=X,x=ce,F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,D=V&65535|G<<16,Ne=F&65535|k<<16,B=Kr,ie=Ie,he=xt,le=D,fe=$,pe=T,de=u,A=I,H=ee,W=ge,ve=_e,se=Ne,ue=De,Ce=Se,ze=Pt,L=mt,Je%16===15)for(var Ke=0;Ke<16;Ke++)m=g[Ke],x=b[Ke],F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=g[(Ke+9)%16],x=b[(Ke+9)%16],F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,X=g[(Ke+1)%16],ce=b[(Ke+1)%16],m=(X>>>1|ce<<31)^(X>>>8|ce<<24)^X>>>7,x=(ce>>>1|X<<31)^(ce>>>8|X<<24)^(ce>>>7|X<<25),F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,X=g[(Ke+14)%16],ce=b[(Ke+14)%16],m=(X>>>19|ce<<13)^(ce>>>29|X<<3)^X>>>6,x=(ce>>>19|X<<13)^(X>>>29|ce<<3)^(ce>>>6|X<<26),F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,g[Ke]=V&65535|G<<16,b[Ke]=F&65535|k<<16}m=A,x=L,F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=y[0],x=E[0],F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,y[0]=A=V&65535|G<<16,E[0]=L=F&65535|k<<16,m=B,x=H,F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=y[1],x=E[1],F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,y[1]=B=V&65535|G<<16,E[1]=H=F&65535|k<<16,m=ie,x=W,F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=y[2],x=E[2],F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,y[2]=ie=V&65535|G<<16,E[2]=W=F&65535|k<<16,m=he,x=ve,F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=y[3],x=E[3],F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,y[3]=he=V&65535|G<<16,E[3]=ve=F&65535|k<<16,m=le,x=se,F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=y[4],x=E[4],F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,y[4]=le=V&65535|G<<16,E[4]=se=F&65535|k<<16,m=fe,x=ue,F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=y[5],x=E[5],F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,y[5]=fe=V&65535|G<<16,E[5]=ue=F&65535|k<<16,m=pe,x=Ce,F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=y[6],x=E[6],F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,y[6]=pe=V&65535|G<<16,E[6]=Ce=F&65535|k<<16,m=de,x=ze,F=x&65535,k=x>>>16,V=m&65535,G=m>>>16,m=y[7],x=E[7],F+=x&65535,k+=x>>>16,V+=m&65535,G+=m>>>16,k+=F>>>16,V+=k>>>16,G+=V>>>16,y[7]=de=V&65535|G<<16,E[7]=ze=F&65535|k<<16,C+=128,U-=128}return C}function f(g){var b=new s;b.update(g);var y=b.digest();return b.clean(),y}n.hash=f})(Mf);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=Do,r=Mf,s=bf;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(D){const $=new Float64Array(16);if(D)for(let T=0;T<D.length;T++)$[T]=D[T];return $}const h=new Uint8Array(32);h[0]=9;const f=a(),g=a([1]),b=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),O=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),C=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function U(D,$){for(let T=0;T<16;T++)D[T]=$[T]|0}function A(D){let $=1;for(let T=0;T<16;T++){let u=D[T]+$+65535;$=Math.floor(u/65536),D[T]=u-$*65536}D[0]+=$-1+37*($-1)}function B(D,$,T){const u=~(T-1);for(let I=0;I<16;I++){const ee=u&(D[I]^$[I]);D[I]^=ee,$[I]^=ee}}function ie(D,$){const T=a(),u=a();for(let I=0;I<16;I++)u[I]=$[I];A(u),A(u),A(u);for(let I=0;I<2;I++){T[0]=u[0]-65517;for(let ge=1;ge<15;ge++)T[ge]=u[ge]-65535-(T[ge-1]>>16&1),T[ge-1]&=65535;T[15]=u[15]-32767-(T[14]>>16&1);const ee=T[15]>>16&1;T[14]&=65535,B(u,T,1-ee)}for(let I=0;I<16;I++)D[2*I]=u[I]&255,D[2*I+1]=u[I]>>8}function he(D,$){let T=0;for(let u=0;u<32;u++)T|=D[u]^$[u];return(1&T-1>>>8)-1}function le(D,$){const T=new Uint8Array(32),u=new Uint8Array(32);return ie(T,D),ie(u,$),he(T,u)}function fe(D){const $=new Uint8Array(32);return ie($,D),$[0]&1}function pe(D,$){for(let T=0;T<16;T++)D[T]=$[2*T]+($[2*T+1]<<8);D[15]&=32767}function de(D,$,T){for(let u=0;u<16;u++)D[u]=$[u]+T[u]}function L(D,$,T){for(let u=0;u<16;u++)D[u]=$[u]-T[u]}function H(D,$,T){let u,I,ee=0,ge=0,_e=0,Ne=0,De=0,Se=0,Pt=0,mt=0,ot=0,je=0,Ye=0,Xe=0,at=0,He=0,Ze=0,$e=0,Ve=0,ht=0,qe=0,St=0,Lt=0,Kt=0,Vt=0,qt=0,Qt=0,or=0,Vr=0,Yt=0,Xr=0,vi=0,Ni=0,lt=T[0],rt=T[1],ft=T[2],pt=T[3],ct=T[4],it=T[5],Ot=T[6],Rt=T[7],dt=T[8],Tt=T[9],gt=T[10],wt=T[11],yt=T[12],Qe=T[13],At=T[14],Ct=T[15];u=$[0],ee+=u*lt,ge+=u*rt,_e+=u*ft,Ne+=u*pt,De+=u*ct,Se+=u*it,Pt+=u*Ot,mt+=u*Rt,ot+=u*dt,je+=u*Tt,Ye+=u*gt,Xe+=u*wt,at+=u*yt,He+=u*Qe,Ze+=u*At,$e+=u*Ct,u=$[1],ge+=u*lt,_e+=u*rt,Ne+=u*ft,De+=u*pt,Se+=u*ct,Pt+=u*it,mt+=u*Ot,ot+=u*Rt,je+=u*dt,Ye+=u*Tt,Xe+=u*gt,at+=u*wt,He+=u*yt,Ze+=u*Qe,$e+=u*At,Ve+=u*Ct,u=$[2],_e+=u*lt,Ne+=u*rt,De+=u*ft,Se+=u*pt,Pt+=u*ct,mt+=u*it,ot+=u*Ot,je+=u*Rt,Ye+=u*dt,Xe+=u*Tt,at+=u*gt,He+=u*wt,Ze+=u*yt,$e+=u*Qe,Ve+=u*At,ht+=u*Ct,u=$[3],Ne+=u*lt,De+=u*rt,Se+=u*ft,Pt+=u*pt,mt+=u*ct,ot+=u*it,je+=u*Ot,Ye+=u*Rt,Xe+=u*dt,at+=u*Tt,He+=u*gt,Ze+=u*wt,$e+=u*yt,Ve+=u*Qe,ht+=u*At,qe+=u*Ct,u=$[4],De+=u*lt,Se+=u*rt,Pt+=u*ft,mt+=u*pt,ot+=u*ct,je+=u*it,Ye+=u*Ot,Xe+=u*Rt,at+=u*dt,He+=u*Tt,Ze+=u*gt,$e+=u*wt,Ve+=u*yt,ht+=u*Qe,qe+=u*At,St+=u*Ct,u=$[5],Se+=u*lt,Pt+=u*rt,mt+=u*ft,ot+=u*pt,je+=u*ct,Ye+=u*it,Xe+=u*Ot,at+=u*Rt,He+=u*dt,Ze+=u*Tt,$e+=u*gt,Ve+=u*wt,ht+=u*yt,qe+=u*Qe,St+=u*At,Lt+=u*Ct,u=$[6],Pt+=u*lt,mt+=u*rt,ot+=u*ft,je+=u*pt,Ye+=u*ct,Xe+=u*it,at+=u*Ot,He+=u*Rt,Ze+=u*dt,$e+=u*Tt,Ve+=u*gt,ht+=u*wt,qe+=u*yt,St+=u*Qe,Lt+=u*At,Kt+=u*Ct,u=$[7],mt+=u*lt,ot+=u*rt,je+=u*ft,Ye+=u*pt,Xe+=u*ct,at+=u*it,He+=u*Ot,Ze+=u*Rt,$e+=u*dt,Ve+=u*Tt,ht+=u*gt,qe+=u*wt,St+=u*yt,Lt+=u*Qe,Kt+=u*At,Vt+=u*Ct,u=$[8],ot+=u*lt,je+=u*rt,Ye+=u*ft,Xe+=u*pt,at+=u*ct,He+=u*it,Ze+=u*Ot,$e+=u*Rt,Ve+=u*dt,ht+=u*Tt,qe+=u*gt,St+=u*wt,Lt+=u*yt,Kt+=u*Qe,Vt+=u*At,qt+=u*Ct,u=$[9],je+=u*lt,Ye+=u*rt,Xe+=u*ft,at+=u*pt,He+=u*ct,Ze+=u*it,$e+=u*Ot,Ve+=u*Rt,ht+=u*dt,qe+=u*Tt,St+=u*gt,Lt+=u*wt,Kt+=u*yt,Vt+=u*Qe,qt+=u*At,Qt+=u*Ct,u=$[10],Ye+=u*lt,Xe+=u*rt,at+=u*ft,He+=u*pt,Ze+=u*ct,$e+=u*it,Ve+=u*Ot,ht+=u*Rt,qe+=u*dt,St+=u*Tt,Lt+=u*gt,Kt+=u*wt,Vt+=u*yt,qt+=u*Qe,Qt+=u*At,or+=u*Ct,u=$[11],Xe+=u*lt,at+=u*rt,He+=u*ft,Ze+=u*pt,$e+=u*ct,Ve+=u*it,ht+=u*Ot,qe+=u*Rt,St+=u*dt,Lt+=u*Tt,Kt+=u*gt,Vt+=u*wt,qt+=u*yt,Qt+=u*Qe,or+=u*At,Vr+=u*Ct,u=$[12],at+=u*lt,He+=u*rt,Ze+=u*ft,$e+=u*pt,Ve+=u*ct,ht+=u*it,qe+=u*Ot,St+=u*Rt,Lt+=u*dt,Kt+=u*Tt,Vt+=u*gt,qt+=u*wt,Qt+=u*yt,or+=u*Qe,Vr+=u*At,Yt+=u*Ct,u=$[13],He+=u*lt,Ze+=u*rt,$e+=u*ft,Ve+=u*pt,ht+=u*ct,qe+=u*it,St+=u*Ot,Lt+=u*Rt,Kt+=u*dt,Vt+=u*Tt,qt+=u*gt,Qt+=u*wt,or+=u*yt,Vr+=u*Qe,Yt+=u*At,Xr+=u*Ct,u=$[14],Ze+=u*lt,$e+=u*rt,Ve+=u*ft,ht+=u*pt,qe+=u*ct,St+=u*it,Lt+=u*Ot,Kt+=u*Rt,Vt+=u*dt,qt+=u*Tt,Qt+=u*gt,or+=u*wt,Vr+=u*yt,Yt+=u*Qe,Xr+=u*At,vi+=u*Ct,u=$[15],$e+=u*lt,Ve+=u*rt,ht+=u*ft,qe+=u*pt,St+=u*ct,Lt+=u*it,Kt+=u*Ot,Vt+=u*Rt,qt+=u*dt,Qt+=u*Tt,or+=u*gt,Vr+=u*wt,Yt+=u*yt,Xr+=u*Qe,vi+=u*At,Ni+=u*Ct,ee+=38*Ve,ge+=38*ht,_e+=38*qe,Ne+=38*St,De+=38*Lt,Se+=38*Kt,Pt+=38*Vt,mt+=38*qt,ot+=38*Qt,je+=38*or,Ye+=38*Vr,Xe+=38*Yt,at+=38*Xr,He+=38*vi,Ze+=38*Ni,I=1,u=ee+I+65535,I=Math.floor(u/65536),ee=u-I*65536,u=ge+I+65535,I=Math.floor(u/65536),ge=u-I*65536,u=_e+I+65535,I=Math.floor(u/65536),_e=u-I*65536,u=Ne+I+65535,I=Math.floor(u/65536),Ne=u-I*65536,u=De+I+65535,I=Math.floor(u/65536),De=u-I*65536,u=Se+I+65535,I=Math.floor(u/65536),Se=u-I*65536,u=Pt+I+65535,I=Math.floor(u/65536),Pt=u-I*65536,u=mt+I+65535,I=Math.floor(u/65536),mt=u-I*65536,u=ot+I+65535,I=Math.floor(u/65536),ot=u-I*65536,u=je+I+65535,I=Math.floor(u/65536),je=u-I*65536,u=Ye+I+65535,I=Math.floor(u/65536),Ye=u-I*65536,u=Xe+I+65535,I=Math.floor(u/65536),Xe=u-I*65536,u=at+I+65535,I=Math.floor(u/65536),at=u-I*65536,u=He+I+65535,I=Math.floor(u/65536),He=u-I*65536,u=Ze+I+65535,I=Math.floor(u/65536),Ze=u-I*65536,u=$e+I+65535,I=Math.floor(u/65536),$e=u-I*65536,ee+=I-1+37*(I-1),I=1,u=ee+I+65535,I=Math.floor(u/65536),ee=u-I*65536,u=ge+I+65535,I=Math.floor(u/65536),ge=u-I*65536,u=_e+I+65535,I=Math.floor(u/65536),_e=u-I*65536,u=Ne+I+65535,I=Math.floor(u/65536),Ne=u-I*65536,u=De+I+65535,I=Math.floor(u/65536),De=u-I*65536,u=Se+I+65535,I=Math.floor(u/65536),Se=u-I*65536,u=Pt+I+65535,I=Math.floor(u/65536),Pt=u-I*65536,u=mt+I+65535,I=Math.floor(u/65536),mt=u-I*65536,u=ot+I+65535,I=Math.floor(u/65536),ot=u-I*65536,u=je+I+65535,I=Math.floor(u/65536),je=u-I*65536,u=Ye+I+65535,I=Math.floor(u/65536),Ye=u-I*65536,u=Xe+I+65535,I=Math.floor(u/65536),Xe=u-I*65536,u=at+I+65535,I=Math.floor(u/65536),at=u-I*65536,u=He+I+65535,I=Math.floor(u/65536),He=u-I*65536,u=Ze+I+65535,I=Math.floor(u/65536),Ze=u-I*65536,u=$e+I+65535,I=Math.floor(u/65536),$e=u-I*65536,ee+=I-1+37*(I-1),D[0]=ee,D[1]=ge,D[2]=_e,D[3]=Ne,D[4]=De,D[5]=Se,D[6]=Pt,D[7]=mt,D[8]=ot,D[9]=je,D[10]=Ye,D[11]=Xe,D[12]=at,D[13]=He,D[14]=Ze,D[15]=$e}function W(D,$){H(D,$,$)}function ve(D,$){const T=a();let u;for(u=0;u<16;u++)T[u]=$[u];for(u=253;u>=0;u--)W(T,T),u!==2&&u!==4&&H(T,T,$);for(u=0;u<16;u++)D[u]=T[u]}function se(D,$){const T=a();let u;for(u=0;u<16;u++)T[u]=$[u];for(u=250;u>=0;u--)W(T,T),u!==1&&H(T,T,$);for(u=0;u<16;u++)D[u]=T[u]}function ue(D,$){const T=a(),u=a(),I=a(),ee=a(),ge=a(),_e=a(),Ne=a(),De=a(),Se=a();L(T,D[1],D[0]),L(Se,$[1],$[0]),H(T,T,Se),de(u,D[0],D[1]),de(Se,$[0],$[1]),H(u,u,Se),H(I,D[3],$[3]),H(I,I,y),H(ee,D[2],$[2]),de(ee,ee,ee),L(ge,u,T),L(_e,ee,I),de(Ne,ee,I),de(De,u,T),H(D[0],ge,_e),H(D[1],De,Ne),H(D[2],Ne,_e),H(D[3],ge,De)}function Ce(D,$,T){for(let u=0;u<4;u++)B(D[u],$[u],T)}function ze(D,$){const T=a(),u=a(),I=a();ve(I,$[2]),H(T,$[0],I),H(u,$[1],I),ie(D,u),D[31]^=fe(T)<<7}function m(D,$,T){U(D[0],f),U(D[1],g),U(D[2],g),U(D[3],f);for(let u=255;u>=0;--u){const I=T[u/8|0]>>(u&7)&1;Ce(D,$,I),ue($,D),ue(D,D),Ce(D,$,I)}}function x(D,$){const T=[a(),a(),a(),a()];U(T[0],E),U(T[1],O),U(T[2],g),H(T[3],E,O),m(D,T,$)}function X(D){if(D.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const $=(0,r.hash)(D);$[0]&=248,$[31]&=127,$[31]|=64;const T=new Uint8Array(32),u=[a(),a(),a(),a()];x(u,$),ze(T,u);const I=new Uint8Array(64);return I.set(D),I.set(T,32),{publicKey:T,secretKey:I}}n.generateKeyPairFromSeed=X;function ce(D){const $=(0,t.randomBytes)(32,D),T=X($);return(0,s.wipe)($),T}n.generateKeyPair=ce;function F(D){if(D.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(D.subarray(32))}n.extractPublicKeyFromSecretKey=F;const k=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function V(D,$){let T,u,I,ee;for(u=63;u>=32;--u){for(T=0,I=u-32,ee=u-12;I<ee;++I)$[I]+=T-16*$[u]*k[I-(u-32)],T=Math.floor(($[I]+128)/256),$[I]-=T*256;$[I]+=T,$[u]=0}for(T=0,I=0;I<32;I++)$[I]+=T-($[31]>>4)*k[I],T=$[I]>>8,$[I]&=255;for(I=0;I<32;I++)$[I]-=T*k[I];for(u=0;u<32;u++)$[u+1]+=$[u]>>8,D[u]=$[u]&255}function G(D){const $=new Float64Array(64);for(let T=0;T<64;T++)$[T]=D[T];for(let T=0;T<64;T++)D[T]=0;V(D,$)}function Je(D,$){const T=new Float64Array(64),u=[a(),a(),a(),a()],I=(0,r.hash)(D.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const ee=new Uint8Array(64);ee.set(I.subarray(32),32);const ge=new r.SHA512;ge.update(ee.subarray(32)),ge.update($);const _e=ge.digest();ge.clean(),G(_e),x(u,_e),ze(ee,u),ge.reset(),ge.update(ee.subarray(0,32)),ge.update(D.subarray(32)),ge.update($);const Ne=ge.digest();G(Ne);for(let De=0;De<32;De++)T[De]=_e[De];for(let De=0;De<32;De++)for(let Se=0;Se<32;Se++)T[De+Se]+=Ne[De]*I[Se];return V(ee.subarray(32),T),ee}n.sign=Je;function Ke(D,$){const T=a(),u=a(),I=a(),ee=a(),ge=a(),_e=a(),Ne=a();return U(D[2],g),pe(D[1],$),W(I,D[1]),H(ee,I,b),L(I,I,D[2]),de(ee,D[2],ee),W(ge,ee),W(_e,ge),H(Ne,_e,ge),H(T,Ne,I),H(T,T,ee),se(T,T),H(T,T,I),H(T,T,ee),H(T,T,ee),H(D[0],T,ee),W(u,D[0]),H(u,u,ee),le(u,I)&&H(D[0],D[0],C),W(u,D[0]),H(u,u,ee),le(u,I)?-1:(fe(D[0])===$[31]>>7&&L(D[0],f,D[0]),H(D[3],D[0],D[1]),0)}function Kr(D,$,T){const u=new Uint8Array(32),I=[a(),a(),a(),a()],ee=[a(),a(),a(),a()];if(T.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(Ke(ee,D))return!1;const ge=new r.SHA512;ge.update(T.subarray(0,32)),ge.update(D),ge.update($);const _e=ge.digest();return G(_e),m(I,ee,_e),x(ee,T.subarray(32)),ue(I,ee),ze(u,I),!he(T,u)}n.verify=Kr;function Ie(D){let $=[a(),a(),a(),a()];if(Ke($,D))throw new Error("Ed25519: invalid public key");let T=a(),u=a(),I=$[1];de(T,g,I),L(u,g,I),ve(u,u),H(T,T,u);let ee=new Uint8Array(32);return ie(ee,T),ee}n.convertPublicKeyToX25519=Ie;function xt(D){const $=(0,r.hash)(D.subarray(0,32));$[0]&=248,$[31]&=127,$[31]|=64;const T=new Uint8Array($.subarray(0,32));return(0,s.wipe)($),T}n.convertSecretKeyToX25519=xt})(Fc);const v_="EdDSA",m_="JWT",qf=".",Uf="base64url",w_="utf8",b_="utf8",__=":",E_="did",I_="key",Ol="base58btc",x_="z",P_="K36",S_=32;function Co(n){return nr(gr(Ji(n),w_),Uf)}function zf(n){const t=gr(P_,Ol),r=x_+nr(Sc([t,n]),Ol);return[E_,I_,r].join(__)}function O_(n){return nr(n,Uf)}function R_(n){return gr([Co(n.header),Co(n.payload)].join(qf),b_)}function T_(n){return[Co(n.header),Co(n.payload),O_(n.signature)].join(qf)}function Rl(n=Do.randomBytes(S_)){return Fc.generateKeyPairFromSeed(n)}async function A_(n,t,r,s,a=re.fromMiliseconds(Date.now())){const h={alg:v_,typ:m_},f=zf(s.publicKey),g=a+r,b={iss:f,sub:n,aud:t,iat:a,exp:g},y=R_({header:h,payload:b}),E=Fc.sign(s.secretKey,y);return T_({header:h,payload:b,signature:E})}const C_="PARSE_ERROR",N_="INVALID_REQUEST",$_="METHOD_NOT_FOUND",D_="INVALID_PARAMS",Hf="INTERNAL_ERROR",Gc="SERVER_ERROR",L_=[-32700,-32600,-32601,-32602,-32603],on={[C_]:{code:-32700,message:"Parse error"},[N_]:{code:-32600,message:"Invalid Request"},[$_]:{code:-32601,message:"Method not found"},[D_]:{code:-32602,message:"Invalid params"},[Hf]:{code:-32603,message:"Internal error"},[Gc]:{code:-32e3,message:"Server error"}},kf=Gc;function j_(n){return L_.includes(n)}function Tl(n){return Object.keys(on).includes(n)?on[n]:on[kf]}function M_(n){const t=Object.values(on).find(r=>r.code===n);return t||on[kf]}function Kf(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var Vf={},hi={},Al;function q_(){if(Al)return hi;Al=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.isBrowserCryptoAvailable=hi.getSubtleCrypto=hi.getBrowerCrypto=void 0;function n(){return(globalThis==null?void 0:globalThis.crypto)||(globalThis==null?void 0:globalThis.msCrypto)||{}}hi.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}hi.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return hi.isBrowserCryptoAvailable=r,hi}var li={},Cl;function U_(){if(Cl)return li;Cl=1,Object.defineProperty(li,"__esModule",{value:!0}),li.isBrowser=li.isNode=li.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}li.isReactNative=n;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}li.isNode=t;function r(){return!n()&&!t()}return li.isBrowser=r,li}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Ps;t.__exportStar(q_(),n),t.__exportStar(U_(),n)})(Vf);function Wc(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function Bf(n=6){return BigInt(Wc(n))}function xs(n,t,r){return{id:r||Wc(),jsonrpc:"2.0",method:n,params:t}}function Jc(n,t){return{id:n,jsonrpc:"2.0",result:t}}function Lo(n,t,r){return{id:n,jsonrpc:"2.0",error:z_(t,r)}}function z_(n,t){return typeof n>"u"?Tl(Hf):(typeof n=="string"&&(n=Object.assign(Object.assign({},Tl(Gc)),{message:n})),typeof t<"u"&&(n.data=t),j_(n.code)&&(n=M_(n.code)),n)}class H_{}class k_ extends H_{constructor(){super()}}class K_ extends k_{constructor(t){super()}}const V_="^https?:",B_="^wss?:";function F_(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Ff(n,t){const r=F_(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function Nl(n){return Ff(n,V_)}function $l(n){return Ff(n,B_)}function G_(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function Gf(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function Qc(n){return Gf(n)&&"method"in n}function jo(n){return Gf(n)&&(di(n)||kr(n))}function di(n){return"result"in n}function kr(n){return"error"in n}class gi extends K_{constructor(t){super(t),this.events=new $r.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(xs(t.method,t.params||[],t.id||Bf().toString()),r)}async requestStrict(t,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(h){a(h)}this.events.on(`${t.id}`,h=>{kr(h)?a(h.error):s(h.result)});try{await this.connection.send(t,r)}catch(h){a(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),jo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const W_=()=>typeof WebSocket<"u"?WebSocket:typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"?globalThis.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),J_=()=>typeof WebSocket<"u"||typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Dl=n=>n.split("?")[0],Ll=10,Q_=W_();let Y_=class{constructor(t){if(this.url=t,this.events=new $r.EventEmitter,this.registering=!1,!$l(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Ji(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!$l(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const a=new URLSearchParams(t).get("origin"),h=Vf.isReactNative()?{headers:{origin:a}}:{rejectUnauthorized:!G_(t)},f=new Q_(t,[],h);J_()?f.onerror=g=>{const b=g;s(this.emitError(b.error))}:f.on("error",g=>{s(this.emitError(g))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ln(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),h=Lo(t,a);this.events.emit("payload",h)}parseError(t,r=this.url){return Kf(t,Dl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Ll&&this.events.setMaxListeners(Ll)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Dl(this.url)}`));return this.events.emit("register_error",r),r}};var No={exports:{}};No.exports;(function(n,t){var r=200,s="__lodash_hash_undefined__",a=1,h=2,f=9007199254740991,g="[object Arguments]",b="[object Array]",y="[object AsyncFunction]",E="[object Boolean]",O="[object Date]",C="[object Error]",U="[object Function]",A="[object GeneratorFunction]",B="[object Map]",ie="[object Number]",he="[object Null]",le="[object Object]",fe="[object Promise]",pe="[object Proxy]",de="[object RegExp]",L="[object Set]",H="[object String]",W="[object Symbol]",ve="[object Undefined]",se="[object WeakMap]",ue="[object ArrayBuffer]",Ce="[object DataView]",ze="[object Float32Array]",m="[object Float64Array]",x="[object Int8Array]",X="[object Int16Array]",ce="[object Int32Array]",F="[object Uint8Array]",k="[object Uint8ClampedArray]",V="[object Uint16Array]",G="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,Ke=/^\[object .+?Constructor\]$/,Kr=/^(?:0|[1-9]\d*)$/,Ie={};Ie[ze]=Ie[m]=Ie[x]=Ie[X]=Ie[ce]=Ie[F]=Ie[k]=Ie[V]=Ie[G]=!0,Ie[g]=Ie[b]=Ie[ue]=Ie[E]=Ie[Ce]=Ie[O]=Ie[C]=Ie[U]=Ie[B]=Ie[ie]=Ie[le]=Ie[de]=Ie[L]=Ie[H]=Ie[se]=!1;var xt=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,D=typeof self=="object"&&self&&self.Object===Object&&self,$=xt||D||Function("return this")(),T=t&&!t.nodeType&&t,u=T&&!0&&n&&!n.nodeType&&n,I=u&&u.exports===T,ee=I&&xt.process,ge=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),_e=ge&&ge.isTypedArray;function Ne(v,P){for(var z=-1,Y=v==null?0:v.length,Fe=0,me=[];++z<Y;){var et=v[z];P(et,z,v)&&(me[Fe++]=et)}return me}function De(v,P){for(var z=-1,Y=P.length,Fe=v.length;++z<Y;)v[Fe+z]=P[z];return v}function Se(v,P){for(var z=-1,Y=v==null?0:v.length;++z<Y;)if(P(v[z],z,v))return!0;return!1}function Pt(v,P){for(var z=-1,Y=Array(v);++z<v;)Y[z]=P(z);return Y}function mt(v){return function(P){return v(P)}}function ot(v,P){return v.has(P)}function je(v,P){return v==null?void 0:v[P]}function Ye(v){var P=-1,z=Array(v.size);return v.forEach(function(Y,Fe){z[++P]=[Fe,Y]}),z}function Xe(v,P){return function(z){return v(P(z))}}function at(v){var P=-1,z=Array(v.size);return v.forEach(function(Y){z[++P]=Y}),z}var He=Array.prototype,Ze=Function.prototype,$e=Object.prototype,Ve=$["__core-js_shared__"],ht=Ze.toString,qe=$e.hasOwnProperty,St=function(){var v=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Lt=$e.toString,Kt=RegExp("^"+ht.call(qe).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vt=I?$.Buffer:void 0,qt=$.Symbol,Qt=$.Uint8Array,or=$e.propertyIsEnumerable,Vr=He.splice,Yt=qt?qt.toStringTag:void 0,Xr=Object.getOwnPropertySymbols,vi=Vt?Vt.isBuffer:void 0,Ni=Xe(Object.keys,Object),lt=yr($,"DataView"),rt=yr($,"Map"),ft=yr($,"Promise"),pt=yr($,"Set"),ct=yr($,"WeakMap"),it=yr(Object,"create"),Ot=ei(lt),Rt=ei(rt),dt=ei(ft),Tt=ei(pt),gt=ei(ct),wt=qt?qt.prototype:void 0,yt=wt?wt.valueOf:void 0;function Qe(v){var P=-1,z=v==null?0:v.length;for(this.clear();++P<z;){var Y=v[P];this.set(Y[0],Y[1])}}function At(){this.__data__=it?it(null):{},this.size=0}function Ct(v){var P=this.has(v)&&delete this.__data__[v];return this.size-=P?1:0,P}function Uo(v){var P=this.__data__;if(it){var z=P[v];return z===s?void 0:z}return qe.call(P,v)?P[v]:void 0}function zo(v){var P=this.__data__;return it?P[v]!==void 0:qe.call(P,v)}function Ho(v,P){var z=this.__data__;return this.size+=this.has(v)?0:1,z[v]=it&&P===void 0?s:P,this}Qe.prototype.clear=At,Qe.prototype.delete=Ct,Qe.prototype.get=Uo,Qe.prototype.has=zo,Qe.prototype.set=Ho;function Ir(v){var P=-1,z=v==null?0:v.length;for(this.clear();++P<z;){var Y=v[P];this.set(Y[0],Y[1])}}function ko(){this.__data__=[],this.size=0}function Ko(v){var P=this.__data__,z=$i(P,v);if(z<0)return!1;var Y=P.length-1;return z==Y?P.pop():Vr.call(P,z,1),--this.size,!0}function Vo(v){var P=this.__data__,z=$i(P,v);return z<0?void 0:P[z][1]}function Bo(v){return $i(this.__data__,v)>-1}function Fo(v,P){var z=this.__data__,Y=$i(z,v);return Y<0?(++this.size,z.push([v,P])):z[Y][1]=P,this}Ir.prototype.clear=ko,Ir.prototype.delete=Ko,Ir.prototype.get=Vo,Ir.prototype.has=Bo,Ir.prototype.set=Fo;function Zr(v){var P=-1,z=v==null?0:v.length;for(this.clear();++P<z;){var Y=v[P];this.set(Y[0],Y[1])}}function es(){this.size=0,this.__data__={hash:new Qe,map:new(rt||Ir),string:new Qe}}function Go(v){var P=mi(this,v).delete(v);return this.size-=P?1:0,P}function ts(v){return mi(this,v).get(v)}function Wo(v){return mi(this,v).has(v)}function Jo(v,P){var z=mi(this,v),Y=z.size;return z.set(v,P),this.size+=z.size==Y?0:1,this}Zr.prototype.clear=es,Zr.prototype.delete=Go,Zr.prototype.get=ts,Zr.prototype.has=Wo,Zr.prototype.set=Jo;function rs(v){var P=-1,z=v==null?0:v.length;for(this.__data__=new Zr;++P<z;)this.add(v[P])}function pn(v){return this.__data__.set(v,s),this}function dn(v){return this.__data__.has(v)}rs.prototype.add=rs.prototype.push=pn,rs.prototype.has=dn;function Dr(v){var P=this.__data__=new Ir(v);this.size=P.size}function Qo(){this.__data__=new Ir,this.size=0}function Yo(v){var P=this.__data__,z=P.delete(v);return this.size=P.size,z}function Xo(v){return this.__data__.get(v)}function Zo(v){return this.__data__.has(v)}function gn(v,P){var z=this.__data__;if(z instanceof Ir){var Y=z.__data__;if(!rt||Y.length<r-1)return Y.push([v,P]),this.size=++z.size,this;z=this.__data__=new Zr(Y)}return z.set(v,P),this.size=z.size,this}Dr.prototype.clear=Qo,Dr.prototype.delete=Yo,Dr.prototype.get=Xo,Dr.prototype.has=Zo,Dr.prototype.set=gn;function yn(v,P){var z=ns(v),Y=!z&&Rn(v),Fe=!z&&!Y&&Ns(v),me=!z&&!Y&&!Fe&&Cn(v),et=z||Y||Fe||me,Nt=et?Pt(v.length,String):[],Re=Nt.length;for(var Ge in v)(P||qe.call(v,Ge))&&!(et&&(Ge=="length"||Fe&&(Ge=="offset"||Ge=="parent")||me&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||In(Ge,Re)))&&Nt.push(Ge);return Nt}function $i(v,P){for(var z=v.length;z--;)if(On(v[z][0],P))return z;return-1}function As(v,P,z){var Y=P(v);return ns(v)?Y:De(Y,z(v))}function Di(v){return v==null?v===void 0?ve:he:Yt&&Yt in Object(v)?_n(v):ra(v)}function Cs(v){return ji(v)&&Di(v)==g}function Li(v,P,z,Y,Fe){return v===P?!0:v==null||P==null||!ji(v)&&!ji(P)?v!==v&&P!==P:vn(v,P,z,Y,Li,Fe)}function vn(v,P,z,Y,Fe,me){var et=ns(v),Nt=ns(P),Re=et?b:Br(v),Ge=Nt?b:Br(P);Re=Re==g?le:Re,Ge=Ge==g?le:Ge;var bt=Re==le,ar=Ge==le,$t=Re==Ge;if($t&&Ns(v)){if(!Ns(P))return!1;et=!0,bt=!1}if($t&&!bt)return me||(me=new Dr),et||Cn(v)?is(v,P,z,Y,Fe,me):ta(v,P,Re,z,Y,Fe,me);if(!(z&a)){var tt=bt&&qe.call(v,"__wrapped__"),Xt=ar&&qe.call(P,"__wrapped__");if(tt||Xt){var Lr=tt?v.value():v,xr=Xt?P.value():P;return me||(me=new Dr),Fe(Lr,xr,z,Y,me)}}return $t?(me||(me=new Dr),bn(v,P,z,Y,Fe,me)):!1}function ea(v){if(!An(v)||Pn(v))return!1;var P=os(v)?Kt:Ke;return P.test(ei(v))}function mn(v){return ji(v)&&Tn(v.length)&&!!Ie[Di(v)]}function wn(v){if(!Sn(v))return Ni(v);var P=[];for(var z in Object(v))qe.call(v,z)&&z!="constructor"&&P.push(z);return P}function is(v,P,z,Y,Fe,me){var et=z&a,Nt=v.length,Re=P.length;if(Nt!=Re&&!(et&&Re>Nt))return!1;var Ge=me.get(v);if(Ge&&me.get(P))return Ge==P;var bt=-1,ar=!0,$t=z&h?new rs:void 0;for(me.set(v,P),me.set(P,v);++bt<Nt;){var tt=v[bt],Xt=P[bt];if(Y)var Lr=et?Y(Xt,tt,bt,P,v,me):Y(tt,Xt,bt,v,P,me);if(Lr!==void 0){if(Lr)continue;ar=!1;break}if($t){if(!Se(P,function(xr,Fr){if(!ot($t,Fr)&&(tt===xr||Fe(tt,xr,z,Y,me)))return $t.push(Fr)})){ar=!1;break}}else if(!(tt===Xt||Fe(tt,Xt,z,Y,me))){ar=!1;break}}return me.delete(v),me.delete(P),ar}function ta(v,P,z,Y,Fe,me,et){switch(z){case Ce:if(v.byteLength!=P.byteLength||v.byteOffset!=P.byteOffset)return!1;v=v.buffer,P=P.buffer;case ue:return!(v.byteLength!=P.byteLength||!me(new Qt(v),new Qt(P)));case E:case O:case ie:return On(+v,+P);case C:return v.name==P.name&&v.message==P.message;case de:case H:return v==P+"";case B:var Nt=Ye;case L:var Re=Y&a;if(Nt||(Nt=at),v.size!=P.size&&!Re)return!1;var Ge=et.get(v);if(Ge)return Ge==P;Y|=h,et.set(v,P);var bt=is(Nt(v),Nt(P),Y,Fe,me,et);return et.delete(v),bt;case W:if(yt)return yt.call(v)==yt.call(P)}return!1}function bn(v,P,z,Y,Fe,me){var et=z&a,Nt=ss(v),Re=Nt.length,Ge=ss(P),bt=Ge.length;if(Re!=bt&&!et)return!1;for(var ar=Re;ar--;){var $t=Nt[ar];if(!(et?$t in P:qe.call(P,$t)))return!1}var tt=me.get(v);if(tt&&me.get(P))return tt==P;var Xt=!0;me.set(v,P),me.set(P,v);for(var Lr=et;++ar<Re;){$t=Nt[ar];var xr=v[$t],Fr=P[$t];if(Y)var $s=et?Y(Fr,xr,$t,P,v,me):Y(xr,Fr,$t,v,P,me);if(!($s===void 0?xr===Fr||Fe(xr,Fr,z,Y,me):$s)){Xt=!1;break}Lr||(Lr=$t=="constructor")}if(Xt&&!Lr){var Mi=v.constructor,Ut=P.constructor;Mi!=Ut&&"constructor"in v&&"constructor"in P&&!(typeof Mi=="function"&&Mi instanceof Mi&&typeof Ut=="function"&&Ut instanceof Ut)&&(Xt=!1)}return me.delete(v),me.delete(P),Xt}function ss(v){return As(v,na,En)}function mi(v,P){var z=v.__data__;return xn(P)?z[typeof P=="string"?"string":"hash"]:z.map}function yr(v,P){var z=je(v,P);return ea(z)?z:void 0}function _n(v){var P=qe.call(v,Yt),z=v[Yt];try{v[Yt]=void 0;var Y=!0}catch{}var Fe=Lt.call(v);return Y&&(P?v[Yt]=z:delete v[Yt]),Fe}var En=Xr?function(v){return v==null?[]:(v=Object(v),Ne(Xr(v),function(P){return or.call(v,P)}))}:Be,Br=Di;(lt&&Br(new lt(new ArrayBuffer(1)))!=Ce||rt&&Br(new rt)!=B||ft&&Br(ft.resolve())!=fe||pt&&Br(new pt)!=L||ct&&Br(new ct)!=se)&&(Br=function(v){var P=Di(v),z=P==le?v.constructor:void 0,Y=z?ei(z):"";if(Y)switch(Y){case Ot:return Ce;case Rt:return B;case dt:return fe;case Tt:return L;case gt:return se}return P});function In(v,P){return P=P??f,!!P&&(typeof v=="number"||Kr.test(v))&&v>-1&&v%1==0&&v<P}function xn(v){var P=typeof v;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?v!=="__proto__":v===null}function Pn(v){return!!St&&St in v}function Sn(v){var P=v&&v.constructor,z=typeof P=="function"&&P.prototype||$e;return v===z}function ra(v){return Lt.call(v)}function ei(v){if(v!=null){try{return ht.call(v)}catch{}try{return v+""}catch{}}return""}function On(v,P){return v===P||v!==v&&P!==P}var Rn=Cs(function(){return arguments}())?Cs:function(v){return ji(v)&&qe.call(v,"callee")&&!or.call(v,"callee")},ns=Array.isArray;function ia(v){return v!=null&&Tn(v.length)&&!os(v)}var Ns=vi||ke;function sa(v,P){return Li(v,P)}function os(v){if(!An(v))return!1;var P=Di(v);return P==U||P==A||P==y||P==pe}function Tn(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=f}function An(v){var P=typeof v;return v!=null&&(P=="object"||P=="function")}function ji(v){return v!=null&&typeof v=="object"}var Cn=_e?mt(_e):mn;function na(v){return ia(v)?yn(v):wn(v)}function Be(){return[]}function ke(){return!1}n.exports=sa})(No,No.exports);var X_=No.exports;const Z_=_f(X_);var e1={};function t1(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var h=n.charAt(a),f=h.charCodeAt(0);if(r[f]!==255)throw new TypeError(h+" is ambiguous");r[f]=a}var g=n.length,b=n.charAt(0),y=Math.log(g)/Math.log(256),E=Math.log(256)/Math.log(g);function O(A){if(A instanceof Uint8Array||(ArrayBuffer.isView(A)?A=new Uint8Array(A.buffer,A.byteOffset,A.byteLength):Array.isArray(A)&&(A=Uint8Array.from(A))),!(A instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(A.length===0)return"";for(var B=0,ie=0,he=0,le=A.length;he!==le&&A[he]===0;)he++,B++;for(var fe=(le-he)*E+1>>>0,pe=new Uint8Array(fe);he!==le;){for(var de=A[he],L=0,H=fe-1;(de!==0||L<ie)&&H!==-1;H--,L++)de+=256*pe[H]>>>0,pe[H]=de%g>>>0,de=de/g>>>0;if(de!==0)throw new Error("Non-zero carry");ie=L,he++}for(var W=fe-ie;W!==fe&&pe[W]===0;)W++;for(var ve=b.repeat(B);W<fe;++W)ve+=n.charAt(pe[W]);return ve}function C(A){if(typeof A!="string")throw new TypeError("Expected String");if(A.length===0)return new Uint8Array;var B=0;if(A[B]!==" "){for(var ie=0,he=0;A[B]===b;)ie++,B++;for(var le=(A.length-B)*y+1>>>0,fe=new Uint8Array(le);A[B];){var pe=r[A.charCodeAt(B)];if(pe===255)return;for(var de=0,L=le-1;(pe!==0||de<he)&&L!==-1;L--,de++)pe+=g*fe[L]>>>0,fe[L]=pe%256>>>0,pe=pe/256>>>0;if(pe!==0)throw new Error("Non-zero carry");he=de,B++}if(A[B]!==" "){for(var H=le-he;H!==le&&fe[H]===0;)H++;for(var W=new Uint8Array(ie+(le-H)),ve=ie;H!==le;)W[ve++]=fe[H++];return W}}}function U(A){var B=C(A);if(B)return B;throw new Error(`Non-${t} character`)}return{encode:O,decodeUnsafe:C,decode:U}}var r1=t1,i1=r1;const Wf=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},s1=n=>new TextEncoder().encode(n),n1=n=>new TextDecoder().decode(n);class o1{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class a1{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Jf(this,t)}}let c1=class{constructor(t){this.decoders=t}or(t){return Jf(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Jf=(n,t)=>new c1({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class u1{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new o1(t,r,s),this.decoder=new a1(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Mo=({name:n,prefix:t,encode:r,decode:s})=>new u1(n,t,r,s),fn=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=i1(r,t);return Mo({prefix:n,name:t,encode:s,decode:h=>Wf(a(h))})},h1=(n,t,r,s)=>{const a={};for(let E=0;E<t.length;++E)a[t[E]]=E;let h=n.length;for(;n[h-1]==="=";)--h;const f=new Uint8Array(h*r/8|0);let g=0,b=0,y=0;for(let E=0;E<h;++E){const O=a[n[E]];if(O===void 0)throw new SyntaxError(`Non-${s} character`);b=b<<r|O,g+=r,g>=8&&(g-=8,f[y++]=255&b>>g)}if(g>=r||255&b<<8-g)throw new SyntaxError("Unexpected end of data");return f},l1=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let h="",f=0,g=0;for(let b=0;b<n.length;++b)for(g=g<<8|n[b],f+=8;f>r;)f-=r,h+=t[a&g>>f];if(f&&(h+=t[a&g<<r-f]),s)for(;h.length*r&7;)h+="=";return h},Ft=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Mo({prefix:t,name:n,encode(a){return l1(a,s,r)},decode(a){return h1(a,s,r,n)}}),f1=Mo({prefix:"\0",name:"identity",encode:n=>n1(n),decode:n=>s1(n)});var p1=Object.freeze({__proto__:null,identity:f1});const d1=Ft({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var g1=Object.freeze({__proto__:null,base2:d1});const y1=Ft({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var v1=Object.freeze({__proto__:null,base8:y1});const m1=fn({prefix:"9",name:"base10",alphabet:"0123456789"});var w1=Object.freeze({__proto__:null,base10:m1});const b1=Ft({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),_1=Ft({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var E1=Object.freeze({__proto__:null,base16:b1,base16upper:_1});const I1=Ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),x1=Ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),P1=Ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),S1=Ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),O1=Ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),R1=Ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),T1=Ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),A1=Ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),C1=Ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var N1=Object.freeze({__proto__:null,base32:I1,base32upper:x1,base32pad:P1,base32padupper:S1,base32hex:O1,base32hexupper:R1,base32hexpad:T1,base32hexpadupper:A1,base32z:C1});const $1=fn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),D1=fn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var L1=Object.freeze({__proto__:null,base36:$1,base36upper:D1});const j1=fn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),M1=fn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var q1=Object.freeze({__proto__:null,base58btc:j1,base58flickr:M1});const U1=Ft({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),z1=Ft({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),H1=Ft({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),k1=Ft({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var K1=Object.freeze({__proto__:null,base64:U1,base64pad:z1,base64url:H1,base64urlpad:k1});const Qf=Array.from(""),V1=Qf.reduce((n,t,r)=>(n[r]=t,n),[]),B1=Qf.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function F1(n){return n.reduce((t,r)=>(t+=V1[r],t),"")}function G1(n){const t=[];for(const r of n){const s=B1[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const W1=Mo({prefix:"",name:"base256emoji",encode:F1,decode:G1});var J1=Object.freeze({__proto__:null,base256emoji:W1}),Q1=Yf,jl=128,Y1=127,X1=~Y1,Z1=Math.pow(2,31);function Yf(n,t,r){t=t||[],r=r||0;for(var s=r;n>=Z1;)t[r++]=n&255|jl,n/=128;for(;n&X1;)t[r++]=n&255|jl,n>>>=7;return t[r]=n|0,Yf.bytes=r-s+1,t}var eE=Nc,tE=128,Ml=127;function Nc(n,s){var r=0,s=s||0,a=0,h=s,f,g=n.length;do{if(h>=g)throw Nc.bytes=0,new RangeError("Could not decode varint");f=n[h++],r+=a<28?(f&Ml)<<a:(f&Ml)*Math.pow(2,a),a+=7}while(f>=tE);return Nc.bytes=h-s,r}var rE=Math.pow(2,7),iE=Math.pow(2,14),sE=Math.pow(2,21),nE=Math.pow(2,28),oE=Math.pow(2,35),aE=Math.pow(2,42),cE=Math.pow(2,49),uE=Math.pow(2,56),hE=Math.pow(2,63),lE=function(n){return n<rE?1:n<iE?2:n<sE?3:n<nE?4:n<oE?5:n<aE?6:n<cE?7:n<uE?8:n<hE?9:10},fE={encode:Q1,decode:eE,encodingLength:lE},Xf=fE;const ql=(n,t,r=0)=>(Xf.encode(n,t,r),t),Ul=n=>Xf.encodingLength(n),$c=(n,t)=>{const r=t.byteLength,s=Ul(n),a=s+Ul(r),h=new Uint8Array(a+r);return ql(n,h,0),ql(r,h,s),h.set(t,a),new pE(n,r,t,h)};class pE{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const Zf=({name:n,code:t,encode:r})=>new dE(n,t,r);class dE{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?$c(this.code,r):r.then(s=>$c(this.code,s))}else throw Error("Unknown type, must be binary type")}}const ep=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),gE=Zf({name:"sha2-256",code:18,encode:ep("SHA-256")}),yE=Zf({name:"sha2-512",code:19,encode:ep("SHA-512")});var vE=Object.freeze({__proto__:null,sha256:gE,sha512:yE});const tp=0,mE="identity",rp=Wf,wE=n=>$c(tp,rp(n)),bE={code:tp,name:mE,encode:rp,digest:wE};var _E=Object.freeze({__proto__:null,identity:bE});new TextEncoder,new TextDecoder;const zl={...p1,...g1,...v1,...w1,...E1,...N1,...L1,...q1,...K1,...J1};({...vE,..._E});function ip(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function EE(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ip(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function sp(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Hl=sp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),vc=sp("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=EE(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),IE={utf8:Hl,"utf-8":Hl,hex:zl.base16,latin1:vc,ascii:vc,binary:vc,...zl};function xE(n,t="utf8"){const r=IE[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ip(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const np="wc",PE=2,Yc="core",Ti=`${np}@2:${Yc}:`,SE={name:Yc,logger:"error"},OE={database:":memory:"},RE="crypto",kl="client_ed25519_seed",TE=re.ONE_DAY,AE="keychain",CE="0.3",NE="messages",$E="0.3",DE=re.SIX_HOURS,LE="publisher",op="irn",jE="error",ap="wss://relay.walletconnect.com",Kl="wss://relay.walletconnect.org",ME="relayer",Jt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},qE="_subscription",fi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},UE=re.ONE_SECOND,zE="2.10.6",HE=1e4,kE="0.3",KE="WALLETCONNECT_CLIENT_ID",zr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},VE="subscription",BE="0.3",FE=re.FIVE_SECONDS*1e3,GE="pairing",WE="0.3",Ys={wc_pairingDelete:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:re.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:re.ONE_DAY,prompt:!1,tag:0},res:{ttl:re.ONE_DAY,prompt:!1,tag:0}}},sn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Qr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},JE="history",QE="0.3",YE="expirer",Nr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},XE="0.3",mc="verify-api",_s="https://verify.walletconnect.com",Dc="https://verify.walletconnect.org",ZE=[_s,Dc];class eI{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=AE,this.version=CE,this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:h}=J("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(h)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Sf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Of(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class tI{constructor(t,r,s){this.core=t,this.logger=r,this.name=RE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),h=Rl(a);return zf(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=o0();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const h=await this.getClientSeed(),f=Rl(h),g=Tc();return await A_(g,a,TE,f)},this.generateSharedKey=(a,h,f)=>{this.isInitialized();const g=this.getPrivateKey(a),b=a0(g,h);return this.setSymKey(b,f)},this.setSymKey=async(a,h)=>{this.isInitialized();const f=h||c0(a);return await this.keychain.set(f,a),f},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,h,f)=>{this.isInitialized();const g=Pf(f),b=Ji(h);if(rl(g)){const C=g.senderPublicKey,U=g.receiverPublicKey;a=await this.generateSharedKey(C,U)}const y=this.getSymKey(a),{type:E,senderPublicKey:O}=g;return h0({type:E,symKey:y,message:b,senderPublicKey:O})},this.decode=async(a,h,f)=>{this.isInitialized();const g=p0(h,f);if(rl(g)){const b=g.receiverPublicKey,y=g.senderPublicKey;a=await this.generateSharedKey(b,y)}try{const b=this.getSymKey(a),y=l0({symKey:b,encoded:h});return ln(y)}catch(b){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(b)}},this.getPayloadType=a=>{const h=To(a);return cn(h.type)},this.getPayloadSenderPublicKey=a=>{const h=To(a);return h.senderPublicKey?nr(h.senderPublicKey,sr):void 0},this.core=t,this.logger=Ae.generateChildLogger(r,this.name),this.keychain=s||new eI(this.core,this.logger)}get context(){return Ae.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(kl)}catch{t=Tc(),await this.keychain.set(kl,t)}return xE(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class rI extends c_{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=NE,this.version=$E,this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const h=Es(a);let f=this.messages.get(s);return typeof f>"u"&&(f={}),typeof f[h]<"u"||(f[h]=a,this.messages.set(s,f),await this.persist()),h},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const h=this.get(s),f=Es(a);return typeof h[f]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ae.generateChildLogger(t,this.name),this.core=r}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Sf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Of(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class iI extends u_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new $r.EventEmitter,this.name=LE,this.queue=new Map,this.publishTimeout=re.toMiliseconds(re.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,h)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:h}});try{const g=(h==null?void 0:h.ttl)||DE,b=Ac(h),y=(h==null?void 0:h.prompt)||!1,E=(h==null?void 0:h.tag)||0,O=(h==null?void 0:h.id)||Bf().toString(),C={topic:s,message:a,opts:{ttl:g,relay:b,prompt:y,tag:E,id:O}},U=setTimeout(()=>this.queue.set(O,C),this.publishTimeout);try{await await an(this.rpcPublish(s,a,g,b,y,E,O),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(O),this.relayer.events.emit(Jt.publish,C)}catch(A){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=h==null?void 0:h.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(O),A;return}finally{clearTimeout(U)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:h}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=Ae.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ae.getLoggerContext(this.logger)}rpcPublish(t,r,s,a,h,f,g){var b,y,E,O;const C={method:xo(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:h,tag:f},id:g};return ir((b=C.params)==null?void 0:b.prompt)&&((y=C.params)==null||delete y.prompt),ir((E=C.params)==null?void 0:E.tag)&&((O=C.params)==null||delete O.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:C}),this.relayer.request(C)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Ts.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Jt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Jt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class sI{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(h=>h!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var nI=Object.defineProperty,oI=Object.defineProperties,aI=Object.getOwnPropertyDescriptors,Vl=Object.getOwnPropertySymbols,cI=Object.prototype.hasOwnProperty,uI=Object.prototype.propertyIsEnumerable,Bl=(n,t,r)=>t in n?nI(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Xs=(n,t)=>{for(var r in t||(t={}))cI.call(t,r)&&Bl(n,r,t[r]);if(Vl)for(var r of Vl(t))uI.call(t,r)&&Bl(n,r,t[r]);return n},wc=(n,t)=>oI(n,aI(t));class hI extends f_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new sI,this.events=new $r.EventEmitter,this.name=VE,this.version=BE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ti,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const h=Ac(a),f={topic:s,relay:h};this.pending.set(s,f);const g=await this.rpcSubscribe(s,h);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),g}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,h)=>{const f=new re.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),a(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=FE&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ae.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=Ac(s);await this.rpcUnsubscribe(t,r,a);const h=It("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:xo(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await an(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}return Es(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:xo(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await an(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:xo(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,wc(Xs({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Xs({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Xs({},r)),this.topicMap.set(r.topic,t),this.events.emit(zr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=J("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(zr.deleted,wc(Xs({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(zr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(zr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);Yr(r)&&this.onBatchSubscribe(r.map((s,a)=>wc(Xs({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Ts.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Jt.connect,async()=>{await this.onConnect()}),this.relayer.on(Jt.disconnect,()=>{this.onDisconnect()}),this.events.on(zr.created,async t=>{const r=zr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(zr.deleted,async t=>{const r=zr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var lI=Object.defineProperty,Fl=Object.getOwnPropertySymbols,fI=Object.prototype.hasOwnProperty,pI=Object.prototype.propertyIsEnumerable,Gl=(n,t,r)=>t in n?lI(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,dI=(n,t)=>{for(var r in t||(t={}))fI.call(t,r)&&Gl(n,r,t[r]);if(Fl)for(var r of Fl(t))pI.call(t,r)&&Gl(n,r,t[r]);return n};class gI extends h_{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new $r.EventEmitter,this.name=ME,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Jt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Jt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(fi.payload,this.onPayloadHandler),this.provider.on(fi.connect,this.onConnectHandler),this.provider.on(fi.disconnect,this.onDisconnectHandler),this.provider.on(fi.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ae.generateChildLogger(t.logger,this.name):Ae.pino(Ae.getDefaultLoggerOptions({level:t.logger||jE})),this.messages=new rI(this.logger,t.core),this.subscriber=new hI(this,this.logger),this.publisher=new iI(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||ap,this.projectId=t.projectId,this.bundleId=w0(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Kl}...`),await this.restartTransport(Kl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},HE)}get context(){return Ae.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(a)return a;let h;const f=g=>{g.topic===t&&(this.subscriber.off(zr.created,f),h())};return await Promise.all([new Promise(g=>{h=g,this.subscriber.on(zr.created,f)}),new Promise(async g=>{a=await this.subscriber.subscribe(t,r),g()})]),a}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await an(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(zr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await an(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(fi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await pl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new gi(new Y_(P0({sdkVersion:zE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Qc(t)){if(!t.method.endsWith(qE))return;const r=t.params,{topic:s,message:a,publishedAt:h}=r.data,f={topic:s,message:a,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(dI({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(t),await this.onMessageEvent(f)}else jo(t)&&this.events.emit(Jt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Jt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Jc(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(fi.payload,this.onPayloadHandler),this.provider.off(fi.connect,this.onConnectHandler),this.provider.off(fi.disconnect,this.onDisconnectHandler),this.provider.off(fi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Jt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await pl();vb(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Jt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},re.toMiliseconds(UE)))}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var yI=Object.defineProperty,Wl=Object.getOwnPropertySymbols,vI=Object.prototype.hasOwnProperty,mI=Object.prototype.propertyIsEnumerable,Jl=(n,t,r)=>t in n?yI(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ql=(n,t)=>{for(var r in t||(t={}))vI.call(t,r)&&Jl(n,r,t[r]);if(Wl)for(var r of Wl(t))mI.call(t,r)&&Jl(n,r,t[r]);return n};class qo extends l_{constructor(t,r,s,a=Ti,h=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=kE,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!ir(f)?this.map.set(this.getKey(f),f):W0(f)?this.map.set(f.id,f):J0(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(b=>Z_(g[b],f[b]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const b=Ql(Ql({},this.getData(f)),g);this.map.set(f,b),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=Ae.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=h}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=J("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class wI{constructor(t,r){this.core=t,this.logger=r,this.name=GE,this.version=WE,this.events=new zc,this.initialized=!1,this.storagePrefix=Ti,this.ignoredPayloadTypes=[Qi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Tc(),a=await this.core.crypto.setSymKey(s),h=Hr(re.FIVE_MINUTES),f={protocol:op},g={topic:a,expiry:h,relay:f,active:!1},b=q0({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:f});return await this.pairings.set(a,g),await this.core.relayer.subscribe(a),this.core.expirer.set(a,h),{topic:a,uri:b}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:h,relay:f}=cl(s.uri);let g;if(this.pairings.keys.includes(a)&&(g=this.pairings.get(a),g.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const b=Hr(re.FIVE_MINUTES),y={topic:a,relay:f,expiry:b,active:!1};return await this.pairings.set(a,y),this.core.expirer.set(a,b),s.activatePairing&&await this.activate({topic:a}),this.events.emit(sn.create,y),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(h,a),await this.core.relayer.subscribe(a,{relay:f})),y},this.activate=async({topic:s})=>{this.isInitialized();const a=Hr(re.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const h=await this.sendRequest(a,"wc_pairingPing",{}),{done:f,resolve:g,reject:b}=bs();this.events.once(Dt("pairing_ping",h),({error:y})=>{y?b(y):g()}),await f()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",It("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,h)=>{const f=xs(a,h),g=await this.core.crypto.encode(s,f),b=Ys[a].req;return this.core.history.set(s,f),this.core.relayer.publish(s,g,b),f.id},this.sendResult=async(s,a,h)=>{const f=Jc(s,h),g=await this.core.crypto.encode(a,f),b=await this.core.history.get(a,s),y=Ys[b.request.method].res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.sendError=async(s,a,h)=>{const f=Lo(s,h),g=await this.core.crypto.encode(a,f),b=await this.core.history.get(a,s),y=Ys[b.request.method]?Ys[b.request.method].res:Ys.unregistered_method.res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,It("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Ri(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:h}=s;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(a,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,h);default:return this.onUnknownRpcMethodRequest(a,h)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:h}=s,f=(await this.core.history.get(a,h.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(a,h);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(s,a)=>{const{id:h}=a;try{this.isValidPing({topic:s}),await this.sendResult(h,s,!0),this.events.emit(sn.ping,{id:h,topic:s})}catch(f){await this.sendError(h,s,f),this.logger.error(f)}},this.onPairingPingResponse=(s,a)=>{const{id:h}=a;setTimeout(()=>{di(a)?this.events.emit(Dt("pairing_ping",h),{}):kr(a)&&this.events.emit(Dt("pairing_ping",h),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:h}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(sn.delete,{id:h,topic:s})}catch(f){await this.sendError(h,s,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:h,method:f}=a;try{if(this.registeredMethods.includes(f))return;const g=It("WC_METHOD_UNSUPPORTED",f);await this.sendError(h,s,g),this.logger.error(g)}catch(g){await this.sendError(h,s,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(It("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var a;if(!dr(s)){const{message:f}=J("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(f)}if(!G0(s.uri)){const{message:f}=J("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(f)}const h=cl(s.uri);if(!((a=h==null?void 0:h.relay)!=null&&a.protocol)){const{message:f}=J("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(h!=null&&h.symKey)){const{message:f}=J("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async s=>{if(!dr(s)){const{message:h}=J("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(h)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!dr(s)){const{message:h}=J("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(h)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!kt(s,!1)){const{message:a}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Ri(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=J("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=Ae.generateChildLogger(r,this.name),this.pairings=new qo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ae.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Jt.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{Qc(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):jo(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Nr.expired,async t=>{const{topic:r}=Tf(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(sn.expire,{topic:r}))})}}class bI extends a_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new $r.EventEmitter,this.name=JE,this.version=QE,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:h}),this.records.has(a.id))return;const f={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:h,expiry:Hr(re.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Qr.created,f)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=kr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Qr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(h=>{if(h.topic===s){if(typeof a<"u"&&h.id!==a)return;this.records.delete(h.id),this.events.emit(Qr.deleted,h)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:xs(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=J("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Qr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Qr.created,t=>{const r=Qr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.updated,t=>{const r=Qr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.deleted,t=>{const r=Qr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Ts.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{re.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class _I extends p_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new $r.EventEmitter,this.name=YE,this.version=XE,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const h=this.formatTarget(s),f={target:h,expiry:a};this.expirations.set(h,f),this.checkExpiry(h,f),this.events.emit(Nr.created,{target:h,expiration:f})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),h=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Nr.deleted,{target:a,expiration:h})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return S0(t);if(typeof t=="number")return O0(t);const{message:r}=J("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Nr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=J("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;re.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Nr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Ts.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Nr.created,t=>{const r=Nr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Nr.expired,t=>{const r=Nr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Nr.deleted,t=>{const r=Nr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class EI extends d_{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=mc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Ss()||!Os())return;const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Dc;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let h;try{h=await this.fetchAttestation(s.attestationId,a)}catch(f){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.info(f),h=await this.fetchAttestation(s.attestationId,Dc)}return h},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const h=this.startAbortTimer(re.ONE_SECOND*2),f=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(h),f.status===200?await f.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(h=>{if(document.getElementById(mc))return h();window.addEventListener("message",a);const f=document.createElement("iframe");f.id=mc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,s=h}),new Promise((h,f)=>setTimeout(()=>{window.removeEventListener("message",a),f("verify iframe load timeout")},re.toMiliseconds(re.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let a=s||_s;return ZE.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${_s}`),a=_s),a},this.logger=Ae.generateChildLogger(r,this.name),this.verifyUrl=_s,this.abortController=new AbortController,this.isDevEnv=Kc()&&e1.IS_VITEST}get context(){return Ae.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),re.toMiliseconds(t))}}var II=Object.defineProperty,Yl=Object.getOwnPropertySymbols,xI=Object.prototype.hasOwnProperty,PI=Object.prototype.propertyIsEnumerable,Xl=(n,t,r)=>t in n?II(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Zl=(n,t)=>{for(var r in t||(t={}))xI.call(t,r)&&Xl(n,r,t[r]);if(Yl)for(var r of Yl(t))PI.call(t,r)&&Xl(n,r,t[r]);return n};class Xc extends o_{constructor(t){super(t),this.protocol=np,this.version=PE,this.name=Yc,this.events=new $r.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||ap,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||SE.logger}));this.logger=Ae.generateChildLogger(r,this.name),this.heartbeat=new Ts.HeartBeat,this.crypto=new tI(this,this.logger,t==null?void 0:t.keychain),this.history=new bI(this,this.logger),this.expirer=new _I(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Yb(Zl(Zl({},OE),t==null?void 0:t.storageOptions)),this.relayer=new gI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new wI(this,this.logger),this.verify=new EI(this.projectId||"",this.logger)}static async init(t){const r=new Xc(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(KE,s),r}get context(){return Ae.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const SI=Xc,cp="wc",up=2,hp="client",Zc=`${cp}@${up}:${hp}:`,bc={name:hp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},ef="WALLETCONNECT_DEEPLINK_CHOICE",OI="proposal",lp="Proposal expired",RI="session",_o=re.SEVEN_DAYS,TI="engine",Zs={wc_sessionPropose:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1104},res:{ttl:re.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1106},res:{ttl:re.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1112},res:{ttl:re.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1115}}},_c={min:re.FIVE_MINUTES,max:re.SEVEN_DAYS},pi={idle:"IDLE",active:"ACTIVE"},AI="request",CI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var NI=Object.defineProperty,$I=Object.defineProperties,DI=Object.getOwnPropertyDescriptors,tf=Object.getOwnPropertySymbols,LI=Object.prototype.hasOwnProperty,jI=Object.prototype.propertyIsEnumerable,rf=(n,t,r)=>t in n?NI(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,fr=(n,t)=>{for(var r in t||(t={}))LI.call(t,r)&&rf(n,r,t[r]);if(tf)for(var r of tf(t))jI.call(t,r)&&rf(n,r,t[r]);return n},en=(n,t)=>$I(n,DI(t));class MI extends y_{constructor(t){super(t),this.name=TI,this.events=new zc,this.initialized=!1,this.ignoredPayloadTypes=[Qi],this.requestQueue={state:pi.idle,queue:[]},this.sessionRequestQueue={state:pi.idle,queue:[]},this.requestQueueDelay=re.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Zs)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},re.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=en(fr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:h,optionalNamespaces:f,sessionProperties:g,relays:b}=s;let y=a,E,O=!1;if(y&&(O=this.client.core.pairing.pairings.get(y).active),!y||!O){const{topic:fe,uri:pe}=await this.client.core.pairing.create();y=fe,E=pe}const C=await this.client.core.crypto.generateKeyPair(),U=fr({requiredNamespaces:h,optionalNamespaces:f,relays:b??[{protocol:op}],proposer:{publicKey:C,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:A,resolve:B,done:ie}=bs(re.FIVE_MINUTES,lp);if(this.events.once(Dt("session_connect"),async({error:fe,session:pe})=>{if(fe)A(fe);else if(pe){pe.self.publicKey=C;const de=en(fr({},pe),{requiredNamespaces:pe.requiredNamespaces,optionalNamespaces:pe.optionalNamespaces});await this.client.session.set(pe.topic,de),await this.setExpiry(pe.topic,pe.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:pe.peer.metadata}),B(de)}}),!y){const{message:fe}=J("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(fe)}const he=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:U}),le=Hr(re.FIVE_MINUTES);return await this.setProposal(he,fr({id:he,expiry:le},U)),{uri:E,approval:ie}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:h,sessionProperties:f}=r,g=this.client.proposal.get(s);let{pairingTopic:b,proposer:y,requiredNamespaces:E,optionalNamespaces:O}=g;b=b||"",Is(E)||(E=k0(h,"approve()"));const C=await this.client.core.crypto.generateKeyPair(),U=y.publicKey,A=await this.client.core.crypto.generateSharedKey(C,U);b&&s&&(await this.client.core.pairing.updateMetadata({topic:b,metadata:y.metadata}),await this.sendResult({id:s,topic:b,result:{relay:{protocol:a??"irn"},responderPublicKey:C}}),await this.client.proposal.delete(s,It("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:b}));const B=fr({relay:{protocol:a??"irn"},namespaces:h,requiredNamespaces:E,optionalNamespaces:O,pairingTopic:b,controller:{publicKey:C,metadata:this.client.metadata},expiry:Hr(_o)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(A),await this.sendRequest({topic:A,method:"wc_sessionSettle",params:B,throwOnFailedPublish:!0});const ie=en(fr({},B),{topic:A,pairingTopic:b,acknowledged:!1,self:B.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:C});return await this.client.session.set(A,ie),await this.setExpiry(A,Hr(_o)),{topic:A,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(A)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:h}=this.client.proposal.get(s);h&&(await this.sendError(s,h,a),await this.client.proposal.delete(s,It("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,h=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:f,resolve:g,reject:b}=bs();return this.events.once(Dt("session_update",h),({error:y})=>{y?b(y):g()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:h,resolve:f,reject:g}=bs();return this.events.once(Dt("session_extend",a),({error:b})=>{b?g(b):f()}),await this.setExpiry(s,Hr(_o)),{acknowledged:h}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:h,expiry:f}=r,g=Wc(),{done:b,resolve:y,reject:E}=bs(f,"Request expired. Please try again.");return this.events.once(Dt("session_request",g),({error:O,result:C})=>{O?E(O):y(C)}),await Promise.all([new Promise(async O=>{await this.sendRequest({clientRpcId:g,topic:h,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:f,throwOnFailedPublish:!0}).catch(C=>E(C)),this.client.events.emit("session_request_sent",{topic:h,request:a,chainId:s,id:g}),O()}),new Promise(async O=>{const C=await T0(this.client.core.storage,ef);R0({id:g,topic:h,wcDeepLink:C}),O()}),b()]).then(O=>O[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:h}=a;di(a)?await this.sendResult({id:h,topic:s,result:a.result,throwOnFailedPublish:!0}):kr(a)&&await this.sendError(h,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:h,resolve:f,reject:g}=bs();this.events.once(Dt("session_ping",a),({error:b})=>{b?g(b):f()}),await h()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:h}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:h}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:It("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>B0(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(h=>{var f,g;return((f=h.peerMetadata)==null?void 0:f.url)&&((g=h.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&h.topic&&h.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,It("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(ef).catch(h=>this.client.logger.warn(h))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,It("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==r),a&&(this.sessionRequestQueue.state=pi.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=Zs.wc_sessionRequest.req.ttl,{id:a,topic:h,params:f,verifyContext:g}=r;await this.client.pendingRequest.set(a,{id:a,topic:h,params:f,verifyContext:g}),s&&this.client.core.expirer.set(a,Hr(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:h,expiry:f,relayRpcId:g,clientRpcId:b,throwOnFailedPublish:y}=r,E=xs(a,h,b);if(Os()&&CI.includes(a)){const U=Es(JSON.stringify(E));this.client.core.verify.register({attestationId:U})}const O=await this.client.core.crypto.encode(s,E),C=Zs[a].req;return f&&(C.ttl=f),g&&(C.id=g),this.client.core.history.set(s,E),y?(C.internal=en(fr({},C.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,O,C)):this.client.core.relayer.publish(s,O,C).catch(U=>this.client.logger.error(U)),E.id},this.sendResult=async r=>{const{id:s,topic:a,result:h,throwOnFailedPublish:f}=r,g=Jc(s,h),b=await this.client.core.crypto.encode(a,g),y=await this.client.core.history.get(a,s),E=Zs[y.request.method].res;f?(E.internal=en(fr({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,b,E)):this.client.core.relayer.publish(a,b,E).catch(O=>this.client.logger.error(O)),await this.client.core.history.resolve(g)},this.sendError=async(r,s,a)=>{const h=Lo(r,a),f=await this.client.core.crypto.encode(s,h),g=await this.client.core.history.get(s,r),b=Zs[g.request.method].res;this.client.core.relayer.publish(s,f,b),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Ri(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Ri(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===pi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=pi.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=pi.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,h=a.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,h=(await this.client.core.history.get(s,a.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=J("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:h}=s;try{this.isValidConnect(fr({},s.params));const f=Hr(re.FIVE_MINUTES),g=fr({id:h,pairingTopic:r,expiry:f},a);await this.setProposal(h,g);const b=Es(JSON.stringify(s)),y=await this.getVerifyContext(b,g.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:g,verifyContext:y})}catch(f){await this.sendError(h,r,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(di(s)){const{result:h}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const f=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const b=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:b});const y=await this.client.core.crypto.generateSharedKey(g,b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const E=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:r})}else kr(s)&&(await this.client.proposal.delete(a,It("USER_DISCONNECTED")),this.events.emit(Dt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:h}=s;try{this.isValidSessionSettleRequest(h);const{relay:f,controller:g,expiry:b,namespaces:y,requiredNamespaces:E,optionalNamespaces:O,sessionProperties:C,pairingTopic:U}=s.params,A=fr({topic:r,relay:f,expiry:b,namespaces:y,acknowledged:!0,pairingTopic:U,requiredNamespaces:E,optionalNamespaces:O,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},C&&{sessionProperties:C});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Dt("session_connect"),{session:A}),this.cleanupDuplicatePairings(A)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;di(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Dt("session_approve",a),{})):kr(s)&&(await this.client.session.delete(r,It("USER_DISCONNECTED")),this.events.emit(Dt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:h}=s;try{const f=`${r}_session_update`,g=mo.get(f);if(g&&this.isRequestOutOfSync(g,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(fr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:h,topic:r,result:!0}),this.client.events.emit("session_update",{id:h,topic:r,params:a}),mo.set(f,h)}catch(f){await this.sendError(h,r,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;di(s)?this.events.emit(Dt("session_update",a),{}):kr(s)&&this.events.emit(Dt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Hr(_o)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;di(s)?this.events.emit(Dt("session_extend",a),{}):kr(s)&&this.events.emit(Dt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{di(s)?this.events.emit(Dt("session_ping",a),{}):kr(s)&&this.events.emit(Dt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Jt.publish,async()=>{h(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:h}=s;try{this.isValidRequest(fr({topic:r},h));const f=Es(JSON.stringify(xs("wc_sessionRequest",h,a))),g=this.client.session.get(r),b=await this.getVerifyContext(f,g.peer.metadata),y={id:a,topic:r,params:h,verifyContext:b};await this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;di(s)?this.events.emit(Dt("session_request",a),{result:s.result}):kr(s)&&this.events.emit(Dt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:h}=s;try{const f=`${r}_session_event_${h.event.name}`,g=mo.get(f);if(g&&this.isRequestOutOfSync(g,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(fr({topic:r},h)),this.client.events.emit("session_event",{id:a,topic:r,params:h}),mo.set(f,a)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=pi.idle,this.processSessionRequestQueue()},re.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===pi.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=pi.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,xs("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!dr(r)){const{message:b}=J("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(b)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:h,sessionProperties:f,relays:g}=r;if(ir(s)||await this.isValidPairingTopic(s),!ib(g,!0)){const{message:b}=J("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(b)}!ir(a)&&Is(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!ir(h)&&Is(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),ir(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=rb(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!dr(r))throw new Error(J("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:h,sessionProperties:f}=r;await this.isValidProposalId(s);const g=this.client.proposal.get(s),b=Po(a,"approve()");if(b)throw new Error(b.message);const y=ll(g.requiredNamespaces,a,"approve()");if(y)throw new Error(y.message);if(!kt(h,!0)){const{message:E}=J("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(E)}ir(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async r=>{if(!dr(r)){const{message:h}=J("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(h)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!nb(a)){const{message:h}=J("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidSessionSettleRequest=r=>{if(!dr(r)){const{message:y}=J("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(y)}const{relay:s,controller:a,namespaces:h,expiry:f}=r;if(!Cf(s)){const{message:y}=J("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const g=Q0(a,"onSessionSettleRequest()");if(g)throw new Error(g.message);const b=Po(h,"onSessionSettleRequest()");if(b)throw new Error(b.message);if(Ri(f)){const{message:y}=J("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async r=>{if(!dr(r)){const{message:b}=J("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(b)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const h=this.client.session.get(s),f=Po(a,"update()");if(f)throw new Error(f.message);const g=ll(h.requiredNamespaces,a,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!dr(r)){const{message:a}=J("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!dr(r)){const{message:b}=J("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(b)}const{topic:s,request:a,chainId:h,expiry:f}=r;await this.isValidSessionTopic(s);const{namespaces:g}=this.client.session.get(s);if(!hl(g,h)){const{message:b}=J("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(b)}if(!ob(a)){const{message:b}=J("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(b)}if(!ub(g,h,a.method)){const{message:b}=J("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(b)}if(f&&!pb(f,_c)){const{message:b}=J("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${_c.min} and ${_c.max}`);throw new Error(b)}},this.isValidRespond=async r=>{if(!dr(r)){const{message:h}=J("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!ab(a)){const{message:h}=J("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!dr(r)){const{message:a}=J("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!dr(r)){const{message:g}=J("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:s,event:a,chainId:h}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!hl(f,h)){const{message:g}=J("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(g)}if(!cb(a)){const{message:g}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}if(!hb(f,h,a.name)){const{message:g}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!dr(r)){const{message:a}=J("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||_s,validation:"UNKNOWN",origin:s.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});h&&(a.verified.origin=h.origin,a.verified.isScam=h.isScam,a.verified.validation=h.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!kt(a,!1)){const{message:h}=J("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Jt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{Qc(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):jo(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(Nr.expired,async t=>{const{topic:r,id:s}=Tf(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,J("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(sn.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!kt(t,!1)){const{message:r}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ri(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=J("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!kt(t,!1)){const{message:r}=J("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=J("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ri(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=J("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(kt(t,!1)){const{message:r}=J("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=J("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!sb(t)){const{message:r}=J("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=J("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ri(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=J("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class qI extends qo{constructor(t,r){super(t,r,OI,Zc),this.core=t,this.logger=r}}class UI extends qo{constructor(t,r){super(t,r,RI,Zc),this.core=t,this.logger=r}}class zI extends qo{constructor(t,r){super(t,r,AI,Zc,s=>s.id),this.core=t,this.logger=r}}let HI=class fp extends g_{constructor(t){super(t),this.protocol=cp,this.version=up,this.name=bc.name,this.events=new $r.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||bc.name,this.metadata=(t==null?void 0:t.metadata)||_0();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||bc.logger}));this.core=(t==null?void 0:t.core)||new SI(t),this.logger=Ae.generateChildLogger(r,this.name),this.session=new UI(this.core,this.logger),this.proposal=new qI(this.core,this.logger),this.pendingRequest=new zI(this.core,this.logger),this.engine=new MI(this)}static async init(t){const r=new fp(t);return await r.initialize(),r}get context(){return Ae.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Lc={exports:{}};(function(n,t){var r=typeof self<"u"?self:e0,s=function(){function h(){this.fetch=!1,this.DOMException=r.DOMException}return h.prototype=r,new h}();(function(h){(function(f){var g={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function b(m){return m&&DataView.prototype.isPrototypeOf(m)}if(g.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=ArrayBuffer.isView||function(m){return m&&y.indexOf(Object.prototype.toString.call(m))>-1};function O(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function C(m){return typeof m!="string"&&(m=String(m)),m}function U(m){var x={next:function(){var X=m.shift();return{done:X===void 0,value:X}}};return g.iterable&&(x[Symbol.iterator]=function(){return x}),x}function A(m){this.map={},m instanceof A?m.forEach(function(x,X){this.append(X,x)},this):Array.isArray(m)?m.forEach(function(x){this.append(x[0],x[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(x){this.append(x,m[x])},this)}A.prototype.append=function(m,x){m=O(m),x=C(x);var X=this.map[m];this.map[m]=X?X+", "+x:x},A.prototype.delete=function(m){delete this.map[O(m)]},A.prototype.get=function(m){return m=O(m),this.has(m)?this.map[m]:null},A.prototype.has=function(m){return this.map.hasOwnProperty(O(m))},A.prototype.set=function(m,x){this.map[O(m)]=C(x)},A.prototype.forEach=function(m,x){for(var X in this.map)this.map.hasOwnProperty(X)&&m.call(x,this.map[X],X,this)},A.prototype.keys=function(){var m=[];return this.forEach(function(x,X){m.push(X)}),U(m)},A.prototype.values=function(){var m=[];return this.forEach(function(x){m.push(x)}),U(m)},A.prototype.entries=function(){var m=[];return this.forEach(function(x,X){m.push([X,x])}),U(m)},g.iterable&&(A.prototype[Symbol.iterator]=A.prototype.entries);function B(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function ie(m){return new Promise(function(x,X){m.onload=function(){x(m.result)},m.onerror=function(){X(m.error)}})}function he(m){var x=new FileReader,X=ie(x);return x.readAsArrayBuffer(m),X}function le(m){var x=new FileReader,X=ie(x);return x.readAsText(m),X}function fe(m){for(var x=new Uint8Array(m),X=new Array(x.length),ce=0;ce<x.length;ce++)X[ce]=String.fromCharCode(x[ce]);return X.join("")}function pe(m){if(m.slice)return m.slice(0);var x=new Uint8Array(m.byteLength);return x.set(new Uint8Array(m)),x.buffer}function de(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:g.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:g.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():g.arrayBuffer&&g.blob&&b(m)?(this._bodyArrayBuffer=pe(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||E(m))?this._bodyArrayBuffer=pe(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var m=B(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?B(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(he)}),this.text=function(){var m=B(this);if(m)return m;if(this._bodyBlob)return le(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(ve)}),this.json=function(){return this.text().then(JSON.parse)},this}var L=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function H(m){var x=m.toUpperCase();return L.indexOf(x)>-1?x:m}function W(m,x){x=x||{};var X=x.body;if(m instanceof W){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,x.headers||(this.headers=new A(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!X&&m._bodyInit!=null&&(X=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=x.credentials||this.credentials||"same-origin",(x.headers||!this.headers)&&(this.headers=new A(x.headers)),this.method=H(x.method||this.method||"GET"),this.mode=x.mode||this.mode||null,this.signal=x.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}W.prototype.clone=function(){return new W(this,{body:this._bodyInit})};function ve(m){var x=new FormData;return m.trim().split("&").forEach(function(X){if(X){var ce=X.split("="),F=ce.shift().replace(/\+/g," "),k=ce.join("=").replace(/\+/g," ");x.append(decodeURIComponent(F),decodeURIComponent(k))}}),x}function se(m){var x=new A,X=m.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(ce){var F=ce.split(":"),k=F.shift().trim();if(k){var V=F.join(":").trim();x.append(k,V)}}),x}de.call(W.prototype);function ue(m,x){x||(x={}),this.type="default",this.status=x.status===void 0?200:x.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in x?x.statusText:"OK",this.headers=new A(x.headers),this.url=x.url||"",this._initBody(m)}de.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new A(this.headers),url:this.url})},ue.error=function(){var m=new ue(null,{status:0,statusText:""});return m.type="error",m};var Ce=[301,302,303,307,308];ue.redirect=function(m,x){if(Ce.indexOf(x)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:x,headers:{location:m}})},f.DOMException=h.DOMException;try{new f.DOMException}catch{f.DOMException=function(x,X){this.message=x,this.name=X;var ce=Error(x);this.stack=ce.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function ze(m,x){return new Promise(function(X,ce){var F=new W(m,x);if(F.signal&&F.signal.aborted)return ce(new f.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function V(){k.abort()}k.onload=function(){var G={status:k.status,statusText:k.statusText,headers:se(k.getAllResponseHeaders()||"")};G.url="responseURL"in k?k.responseURL:G.headers.get("X-Request-URL");var Je="response"in k?k.response:k.responseText;X(new ue(Je,G))},k.onerror=function(){ce(new TypeError("Network request failed"))},k.ontimeout=function(){ce(new TypeError("Network request failed"))},k.onabort=function(){ce(new f.DOMException("Aborted","AbortError"))},k.open(F.method,F.url,!0),F.credentials==="include"?k.withCredentials=!0:F.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&g.blob&&(k.responseType="blob"),F.headers.forEach(function(G,Je){k.setRequestHeader(Je,G)}),F.signal&&(F.signal.addEventListener("abort",V),k.onreadystatechange=function(){k.readyState===4&&F.signal.removeEventListener("abort",V)}),k.send(typeof F._bodyInit>"u"?null:F._bodyInit)})}return ze.polyfill=!0,h.fetch||(h.fetch=ze,h.Headers=A,h.Request=W,h.Response=ue),f.Headers=A,f.Request=W,f.Response=ue,f.fetch=ze,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var a=s;t=a.fetch,t.default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,n.exports=t})(Lc,Lc.exports);var kI=Lc.exports;const sf=_f(kI),KI={Accept:"application/json","Content-Type":"application/json"},VI="POST",nf={headers:KI,method:VI},of=10;class Ci{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new $r.EventEmitter,this.isAvailable=!1,this.registering=!1,!Nl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=Ji(t),h=await(await sf(this.url,Object.assign(Object.assign({},nf),{body:s}))).json();this.onPayload({data:h})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!Nl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Ji({id:1,jsonrpc:"2.0",method:"test",params:[]});await sf(t,Object.assign(Object.assign({},nf),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ln(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),h=Lo(t,a);this.events.emit("payload",h)}parseError(t,r=this.url){return Kf(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>of&&this.events.setMaxListeners(of)}}const af="error",BI="wss://relay.walletconnect.com",FI="wc",GI="universal_provider",cf=`${FI}@2:${GI}:`,WI="https://rpc.walletconnect.com/v1/",yi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var tn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},jc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",a=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",y=500,E="__lodash_placeholder__",O=1,C=2,U=4,A=1,B=2,ie=1,he=2,le=4,fe=8,pe=16,de=32,L=64,H=128,W=256,ve=512,se=30,ue="...",Ce=800,ze=16,m=1,x=2,X=3,ce=1/0,F=9007199254740991,k=17976931348623157e292,V=NaN,G=4294967295,Je=G-1,Ke=G>>>1,Kr=[["ary",H],["bind",ie],["bindKey",he],["curry",fe],["curryRight",pe],["flip",ve],["partial",de],["partialRight",L],["rearg",W]],Ie="[object Arguments]",xt="[object Array]",D="[object AsyncFunction]",$="[object Boolean]",T="[object Date]",u="[object DOMException]",I="[object Error]",ee="[object Function]",ge="[object GeneratorFunction]",_e="[object Map]",Ne="[object Number]",De="[object Null]",Se="[object Object]",Pt="[object Promise]",mt="[object Proxy]",ot="[object RegExp]",je="[object Set]",Ye="[object String]",Xe="[object Symbol]",at="[object Undefined]",He="[object WeakMap]",Ze="[object WeakSet]",$e="[object ArrayBuffer]",Ve="[object DataView]",ht="[object Float32Array]",qe="[object Float64Array]",St="[object Int8Array]",Lt="[object Int16Array]",Kt="[object Int32Array]",Vt="[object Uint8Array]",qt="[object Uint8ClampedArray]",Qt="[object Uint16Array]",or="[object Uint32Array]",Vr=/\b__p \+= '';/g,Yt=/\b(__p \+=) '' \+/g,Xr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,vi=/&(?:amp|lt|gt|quot|#39);/g,Ni=/[&<>"']/g,lt=RegExp(vi.source),rt=RegExp(Ni.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ot=/^\w*$/,Rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Tt=RegExp(dt.source),gt=/^\s+/,wt=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qe=/\{\n\/\* \[wrapped with (.+)\] \*/,At=/,? & /,Ct=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Uo=/[()=,{}\[\]\/\s]/,zo=/\\(\\)?/g,Ho=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ir=/\w*$/,ko=/^[-+]0x[0-9a-f]+$/i,Ko=/^0b[01]+$/i,Vo=/^\[object .+?Constructor\]$/,Bo=/^0o[0-7]+$/i,Fo=/^(?:0|[1-9]\d*)$/,Zr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,es=/($^)/,Go=/['\n\r\u2028\u2029\\]/g,ts="\\ud800-\\udfff",Wo="\\u0300-\\u036f",Jo="\\ufe20-\\ufe2f",rs="\\u20d0-\\u20ff",pn=Wo+Jo+rs,dn="\\u2700-\\u27bf",Dr="a-z\\xdf-\\xf6\\xf8-\\xff",Qo="\\xac\\xb1\\xd7\\xf7",Yo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Xo="\\u2000-\\u206f",Zo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",gn="A-Z\\xc0-\\xd6\\xd8-\\xde",yn="\\ufe0e\\ufe0f",$i=Qo+Yo+Xo+Zo,As="[']",Di="["+ts+"]",Cs="["+$i+"]",Li="["+pn+"]",vn="\\d+",ea="["+dn+"]",mn="["+Dr+"]",wn="[^"+ts+$i+vn+dn+Dr+gn+"]",is="\\ud83c[\\udffb-\\udfff]",ta="(?:"+Li+"|"+is+")",bn="[^"+ts+"]",ss="(?:\\ud83c[\\udde6-\\uddff]){2}",mi="[\\ud800-\\udbff][\\udc00-\\udfff]",yr="["+gn+"]",_n="\\u200d",En="(?:"+mn+"|"+wn+")",Br="(?:"+yr+"|"+wn+")",In="(?:"+As+"(?:d|ll|m|re|s|t|ve))?",xn="(?:"+As+"(?:D|LL|M|RE|S|T|VE))?",Pn=ta+"?",Sn="["+yn+"]?",ra="(?:"+_n+"(?:"+[bn,ss,mi].join("|")+")"+Sn+Pn+")*",ei="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",On="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Rn=Sn+Pn+ra,ns="(?:"+[ea,ss,mi].join("|")+")"+Rn,ia="(?:"+[bn+Li+"?",Li,ss,mi,Di].join("|")+")",Ns=RegExp(As,"g"),sa=RegExp(Li,"g"),os=RegExp(is+"(?="+is+")|"+ia+Rn,"g"),Tn=RegExp([yr+"?"+mn+"+"+In+"(?="+[Cs,yr,"$"].join("|")+")",Br+"+"+xn+"(?="+[Cs,yr+En,"$"].join("|")+")",yr+"?"+En+"+"+In,yr+"+"+xn,On,ei,vn,ns].join("|"),"g"),An=RegExp("["+_n+ts+pn+yn+"]"),ji=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Cn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],na=-1,Be={};Be[ht]=Be[qe]=Be[St]=Be[Lt]=Be[Kt]=Be[Vt]=Be[qt]=Be[Qt]=Be[or]=!0,Be[Ie]=Be[xt]=Be[$e]=Be[$]=Be[Ve]=Be[T]=Be[I]=Be[ee]=Be[_e]=Be[Ne]=Be[Se]=Be[ot]=Be[je]=Be[Ye]=Be[He]=!1;var ke={};ke[Ie]=ke[xt]=ke[$e]=ke[Ve]=ke[$]=ke[T]=ke[ht]=ke[qe]=ke[St]=ke[Lt]=ke[Kt]=ke[_e]=ke[Ne]=ke[Se]=ke[ot]=ke[je]=ke[Ye]=ke[Xe]=ke[Vt]=ke[qt]=ke[Qt]=ke[or]=!0,ke[I]=ke[ee]=ke[He]=!1;var v={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Y={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Fe=parseFloat,me=parseInt,et=typeof tn=="object"&&tn&&tn.Object===Object&&tn,Nt=typeof self=="object"&&self&&self.Object===Object&&self,Re=et||Nt||Function("return this")(),Ge=t&&!t.nodeType&&t,bt=Ge&&!0&&n&&!n.nodeType&&n,ar=bt&&bt.exports===Ge,$t=ar&&et.process,tt=function(){try{var S=bt&&bt.require&&bt.require("util").types;return S||$t&&$t.binding&&$t.binding("util")}catch{}}(),Xt=tt&&tt.isArrayBuffer,Lr=tt&&tt.isDate,xr=tt&&tt.isMap,Fr=tt&&tt.isRegExp,$s=tt&&tt.isSet,Mi=tt&&tt.isTypedArray;function Ut(S,j,N){switch(N.length){case 0:return S.call(j);case 1:return S.call(j,N[0]);case 2:return S.call(j,N[0],N[1]);case 3:return S.call(j,N[0],N[1],N[2])}return S.apply(j,N)}function gp(S,j,N,Z){for(var ye=-1,Le=S==null?0:S.length;++ye<Le;){var jt=S[ye];j(Z,jt,N(jt),S)}return Z}function Pr(S,j){for(var N=-1,Z=S==null?0:S.length;++N<Z&&j(S[N],N,S)!==!1;);return S}function yp(S,j){for(var N=S==null?0:S.length;N--&&j(S[N],N,S)!==!1;);return S}function ru(S,j){for(var N=-1,Z=S==null?0:S.length;++N<Z;)if(!j(S[N],N,S))return!1;return!0}function wi(S,j){for(var N=-1,Z=S==null?0:S.length,ye=0,Le=[];++N<Z;){var jt=S[N];j(jt,N,S)&&(Le[ye++]=jt)}return Le}function Nn(S,j){var N=S==null?0:S.length;return!!N&&as(S,j,0)>-1}function oa(S,j,N){for(var Z=-1,ye=S==null?0:S.length;++Z<ye;)if(N(j,S[Z]))return!0;return!1}function st(S,j){for(var N=-1,Z=S==null?0:S.length,ye=Array(Z);++N<Z;)ye[N]=j(S[N],N,S);return ye}function bi(S,j){for(var N=-1,Z=j.length,ye=S.length;++N<Z;)S[ye+N]=j[N];return S}function aa(S,j,N,Z){var ye=-1,Le=S==null?0:S.length;for(Z&&Le&&(N=S[++ye]);++ye<Le;)N=j(N,S[ye],ye,S);return N}function vp(S,j,N,Z){var ye=S==null?0:S.length;for(Z&&ye&&(N=S[--ye]);ye--;)N=j(N,S[ye],ye,S);return N}function ca(S,j){for(var N=-1,Z=S==null?0:S.length;++N<Z;)if(j(S[N],N,S))return!0;return!1}var mp=ua("length");function wp(S){return S.split("")}function bp(S){return S.match(Ct)||[]}function iu(S,j,N){var Z;return N(S,function(ye,Le,jt){if(j(ye,Le,jt))return Z=Le,!1}),Z}function $n(S,j,N,Z){for(var ye=S.length,Le=N+(Z?1:-1);Z?Le--:++Le<ye;)if(j(S[Le],Le,S))return Le;return-1}function as(S,j,N){return j===j?Np(S,j,N):$n(S,su,N)}function _p(S,j,N,Z){for(var ye=N-1,Le=S.length;++ye<Le;)if(Z(S[ye],j))return ye;return-1}function su(S){return S!==S}function nu(S,j){var N=S==null?0:S.length;return N?la(S,j)/N:V}function ua(S){return function(j){return j==null?r:j[S]}}function ha(S){return function(j){return S==null?r:S[j]}}function ou(S,j,N,Z,ye){return ye(S,function(Le,jt,We){N=Z?(Z=!1,Le):j(N,Le,jt,We)}),N}function Ep(S,j){var N=S.length;for(S.sort(j);N--;)S[N]=S[N].value;return S}function la(S,j){for(var N,Z=-1,ye=S.length;++Z<ye;){var Le=j(S[Z]);Le!==r&&(N=N===r?Le:N+Le)}return N}function fa(S,j){for(var N=-1,Z=Array(S);++N<S;)Z[N]=j(N);return Z}function Ip(S,j){return st(j,function(N){return[N,S[N]]})}function au(S){return S&&S.slice(0,lu(S)+1).replace(gt,"")}function vr(S){return function(j){return S(j)}}function pa(S,j){return st(j,function(N){return S[N]})}function Ds(S,j){return S.has(j)}function cu(S,j){for(var N=-1,Z=S.length;++N<Z&&as(j,S[N],0)>-1;);return N}function uu(S,j){for(var N=S.length;N--&&as(j,S[N],0)>-1;);return N}function xp(S,j){for(var N=S.length,Z=0;N--;)S[N]===j&&++Z;return Z}var Pp=ha(v),Sp=ha(P);function Op(S){return"\\"+Y[S]}function Rp(S,j){return S==null?r:S[j]}function cs(S){return An.test(S)}function Tp(S){return ji.test(S)}function Ap(S){for(var j,N=[];!(j=S.next()).done;)N.push(j.value);return N}function da(S){var j=-1,N=Array(S.size);return S.forEach(function(Z,ye){N[++j]=[ye,Z]}),N}function hu(S,j){return function(N){return S(j(N))}}function _i(S,j){for(var N=-1,Z=S.length,ye=0,Le=[];++N<Z;){var jt=S[N];(jt===j||jt===E)&&(S[N]=E,Le[ye++]=N)}return Le}function Dn(S){var j=-1,N=Array(S.size);return S.forEach(function(Z){N[++j]=Z}),N}function Cp(S){var j=-1,N=Array(S.size);return S.forEach(function(Z){N[++j]=[Z,Z]}),N}function Np(S,j,N){for(var Z=N-1,ye=S.length;++Z<ye;)if(S[Z]===j)return Z;return-1}function $p(S,j,N){for(var Z=N+1;Z--;)if(S[Z]===j)return Z;return Z}function us(S){return cs(S)?Lp(S):mp(S)}function jr(S){return cs(S)?jp(S):wp(S)}function lu(S){for(var j=S.length;j--&&wt.test(S.charAt(j)););return j}var Dp=ha(z);function Lp(S){for(var j=os.lastIndex=0;os.test(S);)++j;return j}function jp(S){return S.match(os)||[]}function Mp(S){return S.match(Tn)||[]}var qp=function S(j){j=j==null?Re:hs.defaults(Re.Object(),j,hs.pick(Re,Cn));var N=j.Array,Z=j.Date,ye=j.Error,Le=j.Function,jt=j.Math,We=j.Object,ga=j.RegExp,Up=j.String,Sr=j.TypeError,Ln=N.prototype,zp=Le.prototype,ls=We.prototype,jn=j["__core-js_shared__"],Mn=zp.toString,Ue=ls.hasOwnProperty,Hp=0,fu=function(){var e=/[^.]+$/.exec(jn&&jn.keys&&jn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),qn=ls.toString,kp=Mn.call(We),Kp=Re._,Vp=ga("^"+Mn.call(Ue).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Un=ar?j.Buffer:r,Ei=j.Symbol,zn=j.Uint8Array,pu=Un?Un.allocUnsafe:r,Hn=hu(We.getPrototypeOf,We),du=We.create,gu=ls.propertyIsEnumerable,kn=Ln.splice,yu=Ei?Ei.isConcatSpreadable:r,Ls=Ei?Ei.iterator:r,qi=Ei?Ei.toStringTag:r,Kn=function(){try{var e=Ki(We,"defineProperty");return e({},"",{}),e}catch{}}(),Bp=j.clearTimeout!==Re.clearTimeout&&j.clearTimeout,Fp=Z&&Z.now!==Re.Date.now&&Z.now,Gp=j.setTimeout!==Re.setTimeout&&j.setTimeout,Vn=jt.ceil,Bn=jt.floor,ya=We.getOwnPropertySymbols,Wp=Un?Un.isBuffer:r,vu=j.isFinite,Jp=Ln.join,Qp=hu(We.keys,We),Mt=jt.max,Gt=jt.min,Yp=Z.now,Xp=j.parseInt,mu=jt.random,Zp=Ln.reverse,va=Ki(j,"DataView"),js=Ki(j,"Map"),ma=Ki(j,"Promise"),fs=Ki(j,"Set"),Ms=Ki(j,"WeakMap"),qs=Ki(We,"create"),Fn=Ms&&new Ms,ps={},ed=Vi(va),td=Vi(js),rd=Vi(ma),id=Vi(fs),sd=Vi(Ms),Gn=Ei?Ei.prototype:r,Us=Gn?Gn.valueOf:r,wu=Gn?Gn.toString:r;function p(e){if(vt(e)&&!we(e)&&!(e instanceof Oe)){if(e instanceof Or)return e;if(Ue.call(e,"__wrapped__"))return bh(e)}return new Or(e)}var ds=function(){function e(){}return function(i){if(!ut(i))return{};if(du)return du(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function Wn(){}function Or(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}p.templateSettings={escape:ft,evaluate:pt,interpolate:ct,variable:"",imports:{_:p}},p.prototype=Wn.prototype,p.prototype.constructor=p,Or.prototype=ds(Wn.prototype),Or.prototype.constructor=Or;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=G,this.__views__=[]}function nd(){var e=new Oe(this.__wrapped__);return e.__actions__=cr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=cr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=cr(this.__views__),e}function od(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function ad(){var e=this.__wrapped__.value(),i=this.__dir__,o=we(e),c=i<0,l=o?e.length:0,d=wg(0,l,this.__views__),w=d.start,_=d.end,R=_-w,M=c?_:w-1,q=this.__iteratees__,K=q.length,Q=0,te=Gt(R,this.__takeCount__);if(!o||!c&&l==R&&te==R)return Ku(e,this.__actions__);var oe=[];e:for(;R--&&Q<te;){M+=i;for(var Ee=-1,ae=e[M];++Ee<K;){var Pe=q[Ee],Te=Pe.iteratee,br=Pe.type,tr=Te(ae);if(br==x)ae=tr;else if(!tr){if(br==m)continue e;break e}}oe[Q++]=ae}return oe}Oe.prototype=ds(Wn.prototype),Oe.prototype.constructor=Oe;function Ui(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function cd(){this.__data__=qs?qs(null):{},this.size=0}function ud(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function hd(e){var i=this.__data__;if(qs){var o=i[e];return o===b?r:o}return Ue.call(i,e)?i[e]:r}function ld(e){var i=this.__data__;return qs?i[e]!==r:Ue.call(i,e)}function fd(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=qs&&i===r?b:i,this}Ui.prototype.clear=cd,Ui.prototype.delete=ud,Ui.prototype.get=hd,Ui.prototype.has=ld,Ui.prototype.set=fd;function ti(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function pd(){this.__data__=[],this.size=0}function dd(e){var i=this.__data__,o=Jn(i,e);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():kn.call(i,o,1),--this.size,!0}function gd(e){var i=this.__data__,o=Jn(i,e);return o<0?r:i[o][1]}function yd(e){return Jn(this.__data__,e)>-1}function vd(e,i){var o=this.__data__,c=Jn(o,e);return c<0?(++this.size,o.push([e,i])):o[c][1]=i,this}ti.prototype.clear=pd,ti.prototype.delete=dd,ti.prototype.get=gd,ti.prototype.has=yd,ti.prototype.set=vd;function ri(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function md(){this.size=0,this.__data__={hash:new Ui,map:new(js||ti),string:new Ui}}function wd(e){var i=ao(this,e).delete(e);return this.size-=i?1:0,i}function bd(e){return ao(this,e).get(e)}function _d(e){return ao(this,e).has(e)}function Ed(e,i){var o=ao(this,e),c=o.size;return o.set(e,i),this.size+=o.size==c?0:1,this}ri.prototype.clear=md,ri.prototype.delete=wd,ri.prototype.get=bd,ri.prototype.has=_d,ri.prototype.set=Ed;function zi(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new ri;++i<o;)this.add(e[i])}function Id(e){return this.__data__.set(e,b),this}function xd(e){return this.__data__.has(e)}zi.prototype.add=zi.prototype.push=Id,zi.prototype.has=xd;function Mr(e){var i=this.__data__=new ti(e);this.size=i.size}function Pd(){this.__data__=new ti,this.size=0}function Sd(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function Od(e){return this.__data__.get(e)}function Rd(e){return this.__data__.has(e)}function Td(e,i){var o=this.__data__;if(o instanceof ti){var c=o.__data__;if(!js||c.length<a-1)return c.push([e,i]),this.size=++o.size,this;o=this.__data__=new ri(c)}return o.set(e,i),this.size=o.size,this}Mr.prototype.clear=Pd,Mr.prototype.delete=Sd,Mr.prototype.get=Od,Mr.prototype.has=Rd,Mr.prototype.set=Td;function bu(e,i){var o=we(e),c=!o&&Bi(e),l=!o&&!c&&Oi(e),d=!o&&!c&&!l&&ms(e),w=o||c||l||d,_=w?fa(e.length,Up):[],R=_.length;for(var M in e)(i||Ue.call(e,M))&&!(w&&(M=="length"||l&&(M=="offset"||M=="parent")||d&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||oi(M,R)))&&_.push(M);return _}function _u(e){var i=e.length;return i?e[Ta(0,i-1)]:r}function Ad(e,i){return co(cr(e),Hi(i,0,e.length))}function Cd(e){return co(cr(e))}function wa(e,i,o){(o!==r&&!qr(e[i],o)||o===r&&!(i in e))&&ii(e,i,o)}function zs(e,i,o){var c=e[i];(!(Ue.call(e,i)&&qr(c,o))||o===r&&!(i in e))&&ii(e,i,o)}function Jn(e,i){for(var o=e.length;o--;)if(qr(e[o][0],i))return o;return-1}function Nd(e,i,o,c){return Ii(e,function(l,d,w){i(c,l,o(l),w)}),c}function Eu(e,i){return e&&Wr(i,zt(i),e)}function $d(e,i){return e&&Wr(i,hr(i),e)}function ii(e,i,o){i=="__proto__"&&Kn?Kn(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function ba(e,i){for(var o=-1,c=i.length,l=N(c),d=e==null;++o<c;)l[o]=d?r:ec(e,i[o]);return l}function Hi(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Rr(e,i,o,c,l,d){var w,_=i&O,R=i&C,M=i&U;if(o&&(w=l?o(e,c,l,d):o(e)),w!==r)return w;if(!ut(e))return e;var q=we(e);if(q){if(w=_g(e),!_)return cr(e,w)}else{var K=Wt(e),Q=K==ee||K==ge;if(Oi(e))return Fu(e,_);if(K==Se||K==Ie||Q&&!l){if(w=R||Q?{}:lh(e),!_)return R?hg(e,$d(w,e)):ug(e,Eu(w,e))}else{if(!ke[K])return l?e:{};w=Eg(e,K,_)}}d||(d=new Mr);var te=d.get(e);if(te)return te;d.set(e,w),zh(e)?e.forEach(function(ae){w.add(Rr(ae,i,o,ae,e,d))}):qh(e)&&e.forEach(function(ae,Pe){w.set(Pe,Rr(ae,i,o,Pe,e,d))});var oe=M?R?za:Ua:R?hr:zt,Ee=q?r:oe(e);return Pr(Ee||e,function(ae,Pe){Ee&&(Pe=ae,ae=e[Pe]),zs(w,Pe,Rr(ae,i,o,Pe,e,d))}),w}function Dd(e){var i=zt(e);return function(o){return Iu(o,e,i)}}function Iu(e,i,o){var c=o.length;if(e==null)return!c;for(e=We(e);c--;){var l=o[c],d=i[l],w=e[l];if(w===r&&!(l in e)||!d(w))return!1}return!0}function xu(e,i,o){if(typeof e!="function")throw new Sr(f);return Gs(function(){e.apply(r,o)},i)}function Hs(e,i,o,c){var l=-1,d=Nn,w=!0,_=e.length,R=[],M=i.length;if(!_)return R;o&&(i=st(i,vr(o))),c?(d=oa,w=!1):i.length>=a&&(d=Ds,w=!1,i=new zi(i));e:for(;++l<_;){var q=e[l],K=o==null?q:o(q);if(q=c||q!==0?q:0,w&&K===K){for(var Q=M;Q--;)if(i[Q]===K)continue e;R.push(q)}else d(i,K,c)||R.push(q)}return R}var Ii=Yu(Gr),Pu=Yu(Ea,!0);function Ld(e,i){var o=!0;return Ii(e,function(c,l,d){return o=!!i(c,l,d),o}),o}function Qn(e,i,o){for(var c=-1,l=e.length;++c<l;){var d=e[c],w=i(d);if(w!=null&&(_===r?w===w&&!wr(w):o(w,_)))var _=w,R=d}return R}function jd(e,i,o,c){var l=e.length;for(o=be(o),o<0&&(o=-o>l?0:l+o),c=c===r||c>l?l:be(c),c<0&&(c+=l),c=o>c?0:kh(c);o<c;)e[o++]=i;return e}function Su(e,i){var o=[];return Ii(e,function(c,l,d){i(c,l,d)&&o.push(c)}),o}function Bt(e,i,o,c,l){var d=-1,w=e.length;for(o||(o=xg),l||(l=[]);++d<w;){var _=e[d];i>0&&o(_)?i>1?Bt(_,i-1,o,c,l):bi(l,_):c||(l[l.length]=_)}return l}var _a=Xu(),Ou=Xu(!0);function Gr(e,i){return e&&_a(e,i,zt)}function Ea(e,i){return e&&Ou(e,i,zt)}function Yn(e,i){return wi(i,function(o){return ai(e[o])})}function ki(e,i){i=Pi(i,e);for(var o=0,c=i.length;e!=null&&o<c;)e=e[Jr(i[o++])];return o&&o==c?e:r}function Ru(e,i,o){var c=i(e);return we(e)?c:bi(c,o(e))}function Zt(e){return e==null?e===r?at:De:qi&&qi in We(e)?mg(e):Cg(e)}function Ia(e,i){return e>i}function Md(e,i){return e!=null&&Ue.call(e,i)}function qd(e,i){return e!=null&&i in We(e)}function Ud(e,i,o){return e>=Gt(i,o)&&e<Mt(i,o)}function xa(e,i,o){for(var c=o?oa:Nn,l=e[0].length,d=e.length,w=d,_=N(d),R=1/0,M=[];w--;){var q=e[w];w&&i&&(q=st(q,vr(i))),R=Gt(q.length,R),_[w]=!o&&(i||l>=120&&q.length>=120)?new zi(w&&q):r}q=e[0];var K=-1,Q=_[0];e:for(;++K<l&&M.length<R;){var te=q[K],oe=i?i(te):te;if(te=o||te!==0?te:0,!(Q?Ds(Q,oe):c(M,oe,o))){for(w=d;--w;){var Ee=_[w];if(!(Ee?Ds(Ee,oe):c(e[w],oe,o)))continue e}Q&&Q.push(oe),M.push(te)}}return M}function zd(e,i,o,c){return Gr(e,function(l,d,w){i(c,o(l),d,w)}),c}function ks(e,i,o){i=Pi(i,e),e=gh(e,i);var c=e==null?e:e[Jr(Ar(i))];return c==null?r:Ut(c,e,o)}function Tu(e){return vt(e)&&Zt(e)==Ie}function Hd(e){return vt(e)&&Zt(e)==$e}function kd(e){return vt(e)&&Zt(e)==T}function Ks(e,i,o,c,l){return e===i?!0:e==null||i==null||!vt(e)&&!vt(i)?e!==e&&i!==i:Kd(e,i,o,c,Ks,l)}function Kd(e,i,o,c,l,d){var w=we(e),_=we(i),R=w?xt:Wt(e),M=_?xt:Wt(i);R=R==Ie?Se:R,M=M==Ie?Se:M;var q=R==Se,K=M==Se,Q=R==M;if(Q&&Oi(e)){if(!Oi(i))return!1;w=!0,q=!1}if(Q&&!q)return d||(d=new Mr),w||ms(e)?ch(e,i,o,c,l,d):yg(e,i,R,o,c,l,d);if(!(o&A)){var te=q&&Ue.call(e,"__wrapped__"),oe=K&&Ue.call(i,"__wrapped__");if(te||oe){var Ee=te?e.value():e,ae=oe?i.value():i;return d||(d=new Mr),l(Ee,ae,o,c,d)}}return Q?(d||(d=new Mr),vg(e,i,o,c,l,d)):!1}function Vd(e){return vt(e)&&Wt(e)==_e}function Pa(e,i,o,c){var l=o.length,d=l,w=!c;if(e==null)return!d;for(e=We(e);l--;){var _=o[l];if(w&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++l<d;){_=o[l];var R=_[0],M=e[R],q=_[1];if(w&&_[2]){if(M===r&&!(R in e))return!1}else{var K=new Mr;if(c)var Q=c(M,q,R,e,i,K);if(!(Q===r?Ks(q,M,A|B,c,K):Q))return!1}}return!0}function Au(e){if(!ut(e)||Sg(e))return!1;var i=ai(e)?Vp:Vo;return i.test(Vi(e))}function Bd(e){return vt(e)&&Zt(e)==ot}function Fd(e){return vt(e)&&Wt(e)==je}function Gd(e){return vt(e)&&go(e.length)&&!!Be[Zt(e)]}function Cu(e){return typeof e=="function"?e:e==null?lr:typeof e=="object"?we(e)?Du(e[0],e[1]):$u(e):Zh(e)}function Sa(e){if(!Fs(e))return Qp(e);var i=[];for(var o in We(e))Ue.call(e,o)&&o!="constructor"&&i.push(o);return i}function Wd(e){if(!ut(e))return Ag(e);var i=Fs(e),o=[];for(var c in e)c=="constructor"&&(i||!Ue.call(e,c))||o.push(c);return o}function Oa(e,i){return e<i}function Nu(e,i){var o=-1,c=ur(e)?N(e.length):[];return Ii(e,function(l,d,w){c[++o]=i(l,d,w)}),c}function $u(e){var i=ka(e);return i.length==1&&i[0][2]?ph(i[0][0],i[0][1]):function(o){return o===e||Pa(o,e,i)}}function Du(e,i){return Va(e)&&fh(i)?ph(Jr(e),i):function(o){var c=ec(o,e);return c===r&&c===i?tc(o,e):Ks(i,c,A|B)}}function Xn(e,i,o,c,l){e!==i&&_a(i,function(d,w){if(l||(l=new Mr),ut(d))Jd(e,i,w,o,Xn,c,l);else{var _=c?c(Fa(e,w),d,w+"",e,i,l):r;_===r&&(_=d),wa(e,w,_)}},hr)}function Jd(e,i,o,c,l,d,w){var _=Fa(e,o),R=Fa(i,o),M=w.get(R);if(M){wa(e,o,M);return}var q=d?d(_,R,o+"",e,i,w):r,K=q===r;if(K){var Q=we(R),te=!Q&&Oi(R),oe=!Q&&!te&&ms(R);q=R,Q||te||oe?we(_)?q=_:_t(_)?q=cr(_):te?(K=!1,q=Fu(R,!0)):oe?(K=!1,q=Gu(R,!0)):q=[]:Ws(R)||Bi(R)?(q=_,Bi(_)?q=Kh(_):(!ut(_)||ai(_))&&(q=lh(R))):K=!1}K&&(w.set(R,q),l(q,R,c,d,w),w.delete(R)),wa(e,o,q)}function Lu(e,i){var o=e.length;if(o)return i+=i<0?o:0,oi(i,o)?e[i]:r}function ju(e,i,o){i.length?i=st(i,function(d){return we(d)?function(w){return ki(w,d.length===1?d[0]:d)}:d}):i=[lr];var c=-1;i=st(i,vr(ne()));var l=Nu(e,function(d,w,_){var R=st(i,function(M){return M(d)});return{criteria:R,index:++c,value:d}});return Ep(l,function(d,w){return cg(d,w,o)})}function Qd(e,i){return Mu(e,i,function(o,c){return tc(e,c)})}function Mu(e,i,o){for(var c=-1,l=i.length,d={};++c<l;){var w=i[c],_=ki(e,w);o(_,w)&&Vs(d,Pi(w,e),_)}return d}function Yd(e){return function(i){return ki(i,e)}}function Ra(e,i,o,c){var l=c?_p:as,d=-1,w=i.length,_=e;for(e===i&&(i=cr(i)),o&&(_=st(e,vr(o)));++d<w;)for(var R=0,M=i[d],q=o?o(M):M;(R=l(_,q,R,c))>-1;)_!==e&&kn.call(_,R,1),kn.call(e,R,1);return e}function qu(e,i){for(var o=e?i.length:0,c=o-1;o--;){var l=i[o];if(o==c||l!==d){var d=l;oi(l)?kn.call(e,l,1):Na(e,l)}}return e}function Ta(e,i){return e+Bn(mu()*(i-e+1))}function Xd(e,i,o,c){for(var l=-1,d=Mt(Vn((i-e)/(o||1)),0),w=N(d);d--;)w[c?d:++l]=e,e+=o;return w}function Aa(e,i){var o="";if(!e||i<1||i>F)return o;do i%2&&(o+=e),i=Bn(i/2),i&&(e+=e);while(i);return o}function xe(e,i){return Ga(dh(e,i,lr),e+"")}function Zd(e){return _u(ws(e))}function eg(e,i){var o=ws(e);return co(o,Hi(i,0,o.length))}function Vs(e,i,o,c){if(!ut(e))return e;i=Pi(i,e);for(var l=-1,d=i.length,w=d-1,_=e;_!=null&&++l<d;){var R=Jr(i[l]),M=o;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(l!=w){var q=_[R];M=c?c(q,R,_):r,M===r&&(M=ut(q)?q:oi(i[l+1])?[]:{})}zs(_,R,M),_=_[R]}return e}var Uu=Fn?function(e,i){return Fn.set(e,i),e}:lr,tg=Kn?function(e,i){return Kn(e,"toString",{configurable:!0,enumerable:!1,value:ic(i),writable:!0})}:lr;function rg(e){return co(ws(e))}function Tr(e,i,o){var c=-1,l=e.length;i<0&&(i=-i>l?0:l+i),o=o>l?l:o,o<0&&(o+=l),l=i>o?0:o-i>>>0,i>>>=0;for(var d=N(l);++c<l;)d[c]=e[c+i];return d}function ig(e,i){var o;return Ii(e,function(c,l,d){return o=i(c,l,d),!o}),!!o}function Zn(e,i,o){var c=0,l=e==null?c:e.length;if(typeof i=="number"&&i===i&&l<=Ke){for(;c<l;){var d=c+l>>>1,w=e[d];w!==null&&!wr(w)&&(o?w<=i:w<i)?c=d+1:l=d}return l}return Ca(e,i,lr,o)}function Ca(e,i,o,c){var l=0,d=e==null?0:e.length;if(d===0)return 0;i=o(i);for(var w=i!==i,_=i===null,R=wr(i),M=i===r;l<d;){var q=Bn((l+d)/2),K=o(e[q]),Q=K!==r,te=K===null,oe=K===K,Ee=wr(K);if(w)var ae=c||oe;else M?ae=oe&&(c||Q):_?ae=oe&&Q&&(c||!te):R?ae=oe&&Q&&!te&&(c||!Ee):te||Ee?ae=!1:ae=c?K<=i:K<i;ae?l=q+1:d=q}return Gt(d,Je)}function zu(e,i){for(var o=-1,c=e.length,l=0,d=[];++o<c;){var w=e[o],_=i?i(w):w;if(!o||!qr(_,R)){var R=_;d[l++]=w===0?0:w}}return d}function Hu(e){return typeof e=="number"?e:wr(e)?V:+e}function mr(e){if(typeof e=="string")return e;if(we(e))return st(e,mr)+"";if(wr(e))return wu?wu.call(e):"";var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function xi(e,i,o){var c=-1,l=Nn,d=e.length,w=!0,_=[],R=_;if(o)w=!1,l=oa;else if(d>=a){var M=i?null:dg(e);if(M)return Dn(M);w=!1,l=Ds,R=new zi}else R=i?[]:_;e:for(;++c<d;){var q=e[c],K=i?i(q):q;if(q=o||q!==0?q:0,w&&K===K){for(var Q=R.length;Q--;)if(R[Q]===K)continue e;i&&R.push(K),_.push(q)}else l(R,K,o)||(R!==_&&R.push(K),_.push(q))}return _}function Na(e,i){return i=Pi(i,e),e=gh(e,i),e==null||delete e[Jr(Ar(i))]}function ku(e,i,o,c){return Vs(e,i,o(ki(e,i)),c)}function eo(e,i,o,c){for(var l=e.length,d=c?l:-1;(c?d--:++d<l)&&i(e[d],d,e););return o?Tr(e,c?0:d,c?d+1:l):Tr(e,c?d+1:0,c?l:d)}function Ku(e,i){var o=e;return o instanceof Oe&&(o=o.value()),aa(i,function(c,l){return l.func.apply(l.thisArg,bi([c],l.args))},o)}function $a(e,i,o){var c=e.length;if(c<2)return c?xi(e[0]):[];for(var l=-1,d=N(c);++l<c;)for(var w=e[l],_=-1;++_<c;)_!=l&&(d[l]=Hs(d[l]||w,e[_],i,o));return xi(Bt(d,1),i,o)}function Vu(e,i,o){for(var c=-1,l=e.length,d=i.length,w={};++c<l;){var _=c<d?i[c]:r;o(w,e[c],_)}return w}function Da(e){return _t(e)?e:[]}function La(e){return typeof e=="function"?e:lr}function Pi(e,i){return we(e)?e:Va(e,i)?[e]:wh(Me(e))}var sg=xe;function Si(e,i,o){var c=e.length;return o=o===r?c:o,!i&&o>=c?e:Tr(e,i,o)}var Bu=Bp||function(e){return Re.clearTimeout(e)};function Fu(e,i){if(i)return e.slice();var o=e.length,c=pu?pu(o):new e.constructor(o);return e.copy(c),c}function ja(e){var i=new e.constructor(e.byteLength);return new zn(i).set(new zn(e)),i}function ng(e,i){var o=i?ja(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function og(e){var i=new e.constructor(e.source,Ir.exec(e));return i.lastIndex=e.lastIndex,i}function ag(e){return Us?We(Us.call(e)):{}}function Gu(e,i){var o=i?ja(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function Wu(e,i){if(e!==i){var o=e!==r,c=e===null,l=e===e,d=wr(e),w=i!==r,_=i===null,R=i===i,M=wr(i);if(!_&&!M&&!d&&e>i||d&&w&&R&&!_&&!M||c&&w&&R||!o&&R||!l)return 1;if(!c&&!d&&!M&&e<i||M&&o&&l&&!c&&!d||_&&o&&l||!w&&l||!R)return-1}return 0}function cg(e,i,o){for(var c=-1,l=e.criteria,d=i.criteria,w=l.length,_=o.length;++c<w;){var R=Wu(l[c],d[c]);if(R){if(c>=_)return R;var M=o[c];return R*(M=="desc"?-1:1)}}return e.index-i.index}function Ju(e,i,o,c){for(var l=-1,d=e.length,w=o.length,_=-1,R=i.length,M=Mt(d-w,0),q=N(R+M),K=!c;++_<R;)q[_]=i[_];for(;++l<w;)(K||l<d)&&(q[o[l]]=e[l]);for(;M--;)q[_++]=e[l++];return q}function Qu(e,i,o,c){for(var l=-1,d=e.length,w=-1,_=o.length,R=-1,M=i.length,q=Mt(d-_,0),K=N(q+M),Q=!c;++l<q;)K[l]=e[l];for(var te=l;++R<M;)K[te+R]=i[R];for(;++w<_;)(Q||l<d)&&(K[te+o[w]]=e[l++]);return K}function cr(e,i){var o=-1,c=e.length;for(i||(i=N(c));++o<c;)i[o]=e[o];return i}function Wr(e,i,o,c){var l=!o;o||(o={});for(var d=-1,w=i.length;++d<w;){var _=i[d],R=c?c(o[_],e[_],_,o,e):r;R===r&&(R=e[_]),l?ii(o,_,R):zs(o,_,R)}return o}function ug(e,i){return Wr(e,Ka(e),i)}function hg(e,i){return Wr(e,uh(e),i)}function to(e,i){return function(o,c){var l=we(o)?gp:Nd,d=i?i():{};return l(o,e,ne(c,2),d)}}function gs(e){return xe(function(i,o){var c=-1,l=o.length,d=l>1?o[l-1]:r,w=l>2?o[2]:r;for(d=e.length>3&&typeof d=="function"?(l--,d):r,w&&er(o[0],o[1],w)&&(d=l<3?r:d,l=1),i=We(i);++c<l;){var _=o[c];_&&e(i,_,c,d)}return i})}function Yu(e,i){return function(o,c){if(o==null)return o;if(!ur(o))return e(o,c);for(var l=o.length,d=i?l:-1,w=We(o);(i?d--:++d<l)&&c(w[d],d,w)!==!1;);return o}}function Xu(e){return function(i,o,c){for(var l=-1,d=We(i),w=c(i),_=w.length;_--;){var R=w[e?_:++l];if(o(d[R],R,d)===!1)break}return i}}function lg(e,i,o){var c=i&ie,l=Bs(e);function d(){var w=this&&this!==Re&&this instanceof d?l:e;return w.apply(c?o:this,arguments)}return d}function Zu(e){return function(i){i=Me(i);var o=cs(i)?jr(i):r,c=o?o[0]:i.charAt(0),l=o?Si(o,1).join(""):i.slice(1);return c[e]()+l}}function ys(e){return function(i){return aa(Yh(Qh(i).replace(Ns,"")),e,"")}}function Bs(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=ds(e.prototype),c=e.apply(o,i);return ut(c)?c:o}}function fg(e,i,o){var c=Bs(e);function l(){for(var d=arguments.length,w=N(d),_=d,R=vs(l);_--;)w[_]=arguments[_];var M=d<3&&w[0]!==R&&w[d-1]!==R?[]:_i(w,R);if(d-=M.length,d<o)return sh(e,i,ro,l.placeholder,r,w,M,r,r,o-d);var q=this&&this!==Re&&this instanceof l?c:e;return Ut(q,this,w)}return l}function eh(e){return function(i,o,c){var l=We(i);if(!ur(i)){var d=ne(o,3);i=zt(i),o=function(_){return d(l[_],_,l)}}var w=e(i,o,c);return w>-1?l[d?i[w]:w]:r}}function th(e){return ni(function(i){var o=i.length,c=o,l=Or.prototype.thru;for(e&&i.reverse();c--;){var d=i[c];if(typeof d!="function")throw new Sr(f);if(l&&!w&&oo(d)=="wrapper")var w=new Or([],!0)}for(c=w?c:o;++c<o;){d=i[c];var _=oo(d),R=_=="wrapper"?Ha(d):r;R&&Ba(R[0])&&R[1]==(H|fe|de|W)&&!R[4].length&&R[9]==1?w=w[oo(R[0])].apply(w,R[3]):w=d.length==1&&Ba(d)?w[_]():w.thru(d)}return function(){var M=arguments,q=M[0];if(w&&M.length==1&&we(q))return w.plant(q).value();for(var K=0,Q=o?i[K].apply(this,M):q;++K<o;)Q=i[K].call(this,Q);return Q}})}function ro(e,i,o,c,l,d,w,_,R,M){var q=i&H,K=i&ie,Q=i&he,te=i&(fe|pe),oe=i&ve,Ee=Q?r:Bs(e);function ae(){for(var Pe=arguments.length,Te=N(Pe),br=Pe;br--;)Te[br]=arguments[br];if(te)var tr=vs(ae),_r=xp(Te,tr);if(c&&(Te=Ju(Te,c,l,te)),d&&(Te=Qu(Te,d,w,te)),Pe-=_r,te&&Pe<M){var Et=_i(Te,tr);return sh(e,i,ro,ae.placeholder,o,Te,Et,_,R,M-Pe)}var Ur=K?o:this,ui=Q?Ur[e]:e;return Pe=Te.length,_?Te=Ng(Te,_):oe&&Pe>1&&Te.reverse(),q&&R<Pe&&(Te.length=R),this&&this!==Re&&this instanceof ae&&(ui=Ee||Bs(ui)),ui.apply(Ur,Te)}return ae}function rh(e,i){return function(o,c){return zd(o,e,i(c),{})}}function io(e,i){return function(o,c){var l;if(o===r&&c===r)return i;if(o!==r&&(l=o),c!==r){if(l===r)return c;typeof o=="string"||typeof c=="string"?(o=mr(o),c=mr(c)):(o=Hu(o),c=Hu(c)),l=e(o,c)}return l}}function Ma(e){return ni(function(i){return i=st(i,vr(ne())),xe(function(o){var c=this;return e(i,function(l){return Ut(l,c,o)})})})}function so(e,i){i=i===r?" ":mr(i);var o=i.length;if(o<2)return o?Aa(i,e):i;var c=Aa(i,Vn(e/us(i)));return cs(i)?Si(jr(c),0,e).join(""):c.slice(0,e)}function pg(e,i,o,c){var l=i&ie,d=Bs(e);function w(){for(var _=-1,R=arguments.length,M=-1,q=c.length,K=N(q+R),Q=this&&this!==Re&&this instanceof w?d:e;++M<q;)K[M]=c[M];for(;R--;)K[M++]=arguments[++_];return Ut(Q,l?o:this,K)}return w}function ih(e){return function(i,o,c){return c&&typeof c!="number"&&er(i,o,c)&&(o=c=r),i=ci(i),o===r?(o=i,i=0):o=ci(o),c=c===r?i<o?1:-1:ci(c),Xd(i,o,c,e)}}function no(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Cr(i),o=Cr(o)),e(i,o)}}function sh(e,i,o,c,l,d,w,_,R,M){var q=i&fe,K=q?w:r,Q=q?r:w,te=q?d:r,oe=q?r:d;i|=q?de:L,i&=~(q?L:de),i&le||(i&=~(ie|he));var Ee=[e,i,l,te,K,oe,Q,_,R,M],ae=o.apply(r,Ee);return Ba(e)&&yh(ae,Ee),ae.placeholder=c,vh(ae,e,i)}function qa(e){var i=jt[e];return function(o,c){if(o=Cr(o),c=c==null?0:Gt(be(c),292),c&&vu(o)){var l=(Me(o)+"e").split("e"),d=i(l[0]+"e"+(+l[1]+c));return l=(Me(d)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return i(o)}}var dg=fs&&1/Dn(new fs([,-0]))[1]==ce?function(e){return new fs(e)}:oc;function nh(e){return function(i){var o=Wt(i);return o==_e?da(i):o==je?Cp(i):Ip(i,e(i))}}function si(e,i,o,c,l,d,w,_){var R=i&he;if(!R&&typeof e!="function")throw new Sr(f);var M=c?c.length:0;if(M||(i&=~(de|L),c=l=r),w=w===r?w:Mt(be(w),0),_=_===r?_:be(_),M-=l?l.length:0,i&L){var q=c,K=l;c=l=r}var Q=R?r:Ha(e),te=[e,i,o,c,l,q,K,d,w,_];if(Q&&Tg(te,Q),e=te[0],i=te[1],o=te[2],c=te[3],l=te[4],_=te[9]=te[9]===r?R?0:e.length:Mt(te[9]-M,0),!_&&i&(fe|pe)&&(i&=~(fe|pe)),!i||i==ie)var oe=lg(e,i,o);else i==fe||i==pe?oe=fg(e,i,_):(i==de||i==(ie|de))&&!l.length?oe=pg(e,i,o,c):oe=ro.apply(r,te);var Ee=Q?Uu:yh;return vh(Ee(oe,te),e,i)}function oh(e,i,o,c){return e===r||qr(e,ls[o])&&!Ue.call(c,o)?i:e}function ah(e,i,o,c,l,d){return ut(e)&&ut(i)&&(d.set(i,e),Xn(e,i,r,ah,d),d.delete(i)),e}function gg(e){return Ws(e)?r:e}function ch(e,i,o,c,l,d){var w=o&A,_=e.length,R=i.length;if(_!=R&&!(w&&R>_))return!1;var M=d.get(e),q=d.get(i);if(M&&q)return M==i&&q==e;var K=-1,Q=!0,te=o&B?new zi:r;for(d.set(e,i),d.set(i,e);++K<_;){var oe=e[K],Ee=i[K];if(c)var ae=w?c(Ee,oe,K,i,e,d):c(oe,Ee,K,e,i,d);if(ae!==r){if(ae)continue;Q=!1;break}if(te){if(!ca(i,function(Pe,Te){if(!Ds(te,Te)&&(oe===Pe||l(oe,Pe,o,c,d)))return te.push(Te)})){Q=!1;break}}else if(!(oe===Ee||l(oe,Ee,o,c,d))){Q=!1;break}}return d.delete(e),d.delete(i),Q}function yg(e,i,o,c,l,d,w){switch(o){case Ve:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case $e:return!(e.byteLength!=i.byteLength||!d(new zn(e),new zn(i)));case $:case T:case Ne:return qr(+e,+i);case I:return e.name==i.name&&e.message==i.message;case ot:case Ye:return e==i+"";case _e:var _=da;case je:var R=c&A;if(_||(_=Dn),e.size!=i.size&&!R)return!1;var M=w.get(e);if(M)return M==i;c|=B,w.set(e,i);var q=ch(_(e),_(i),c,l,d,w);return w.delete(e),q;case Xe:if(Us)return Us.call(e)==Us.call(i)}return!1}function vg(e,i,o,c,l,d){var w=o&A,_=Ua(e),R=_.length,M=Ua(i),q=M.length;if(R!=q&&!w)return!1;for(var K=R;K--;){var Q=_[K];if(!(w?Q in i:Ue.call(i,Q)))return!1}var te=d.get(e),oe=d.get(i);if(te&&oe)return te==i&&oe==e;var Ee=!0;d.set(e,i),d.set(i,e);for(var ae=w;++K<R;){Q=_[K];var Pe=e[Q],Te=i[Q];if(c)var br=w?c(Te,Pe,Q,i,e,d):c(Pe,Te,Q,e,i,d);if(!(br===r?Pe===Te||l(Pe,Te,o,c,d):br)){Ee=!1;break}ae||(ae=Q=="constructor")}if(Ee&&!ae){var tr=e.constructor,_r=i.constructor;tr!=_r&&"constructor"in e&&"constructor"in i&&!(typeof tr=="function"&&tr instanceof tr&&typeof _r=="function"&&_r instanceof _r)&&(Ee=!1)}return d.delete(e),d.delete(i),Ee}function ni(e){return Ga(dh(e,r,Ih),e+"")}function Ua(e){return Ru(e,zt,Ka)}function za(e){return Ru(e,hr,uh)}var Ha=Fn?function(e){return Fn.get(e)}:oc;function oo(e){for(var i=e.name+"",o=ps[i],c=Ue.call(ps,i)?o.length:0;c--;){var l=o[c],d=l.func;if(d==null||d==e)return l.name}return i}function vs(e){var i=Ue.call(p,"placeholder")?p:e;return i.placeholder}function ne(){var e=p.iteratee||sc;return e=e===sc?Cu:e,arguments.length?e(arguments[0],arguments[1]):e}function ao(e,i){var o=e.__data__;return Pg(i)?o[typeof i=="string"?"string":"hash"]:o.map}function ka(e){for(var i=zt(e),o=i.length;o--;){var c=i[o],l=e[c];i[o]=[c,l,fh(l)]}return i}function Ki(e,i){var o=Rp(e,i);return Au(o)?o:r}function mg(e){var i=Ue.call(e,qi),o=e[qi];try{e[qi]=r;var c=!0}catch{}var l=qn.call(e);return c&&(i?e[qi]=o:delete e[qi]),l}var Ka=ya?function(e){return e==null?[]:(e=We(e),wi(ya(e),function(i){return gu.call(e,i)}))}:ac,uh=ya?function(e){for(var i=[];e;)bi(i,Ka(e)),e=Hn(e);return i}:ac,Wt=Zt;(va&&Wt(new va(new ArrayBuffer(1)))!=Ve||js&&Wt(new js)!=_e||ma&&Wt(ma.resolve())!=Pt||fs&&Wt(new fs)!=je||Ms&&Wt(new Ms)!=He)&&(Wt=function(e){var i=Zt(e),o=i==Se?e.constructor:r,c=o?Vi(o):"";if(c)switch(c){case ed:return Ve;case td:return _e;case rd:return Pt;case id:return je;case sd:return He}return i});function wg(e,i,o){for(var c=-1,l=o.length;++c<l;){var d=o[c],w=d.size;switch(d.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=Gt(i,e+w);break;case"takeRight":e=Mt(e,i-w);break}}return{start:e,end:i}}function bg(e){var i=e.match(Qe);return i?i[1].split(At):[]}function hh(e,i,o){i=Pi(i,e);for(var c=-1,l=i.length,d=!1;++c<l;){var w=Jr(i[c]);if(!(d=e!=null&&o(e,w)))break;e=e[w]}return d||++c!=l?d:(l=e==null?0:e.length,!!l&&go(l)&&oi(w,l)&&(we(e)||Bi(e)))}function _g(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&Ue.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function lh(e){return typeof e.constructor=="function"&&!Fs(e)?ds(Hn(e)):{}}function Eg(e,i,o){var c=e.constructor;switch(i){case $e:return ja(e);case $:case T:return new c(+e);case Ve:return ng(e,o);case ht:case qe:case St:case Lt:case Kt:case Vt:case qt:case Qt:case or:return Gu(e,o);case _e:return new c;case Ne:case Ye:return new c(e);case ot:return og(e);case je:return new c;case Xe:return ag(e)}}function Ig(e,i){var o=i.length;if(!o)return e;var c=o-1;return i[c]=(o>1?"& ":"")+i[c],i=i.join(o>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+i+`] */
`)}function xg(e){return we(e)||Bi(e)||!!(yu&&e&&e[yu])}function oi(e,i){var o=typeof e;return i=i??F,!!i&&(o=="number"||o!="symbol"&&Fo.test(e))&&e>-1&&e%1==0&&e<i}function er(e,i,o){if(!ut(o))return!1;var c=typeof i;return(c=="number"?ur(o)&&oi(i,o.length):c=="string"&&i in o)?qr(o[i],e):!1}function Va(e,i){if(we(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||wr(e)?!0:Ot.test(e)||!it.test(e)||i!=null&&e in We(i)}function Pg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Ba(e){var i=oo(e),o=p[i];if(typeof o!="function"||!(i in Oe.prototype))return!1;if(e===o)return!0;var c=Ha(o);return!!c&&e===c[0]}function Sg(e){return!!fu&&fu in e}var Og=jn?ai:cc;function Fs(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||ls;return e===o}function fh(e){return e===e&&!ut(e)}function ph(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in We(o))}}function Rg(e){var i=fo(e,function(c){return o.size===y&&o.clear(),c}),o=i.cache;return i}function Tg(e,i){var o=e[1],c=i[1],l=o|c,d=l<(ie|he|H),w=c==H&&o==fe||c==H&&o==W&&e[7].length<=i[8]||c==(H|W)&&i[7].length<=i[8]&&o==fe;if(!(d||w))return e;c&ie&&(e[2]=i[2],l|=o&ie?0:le);var _=i[3];if(_){var R=e[3];e[3]=R?Ju(R,_,i[4]):_,e[4]=R?_i(e[3],E):i[4]}return _=i[5],_&&(R=e[5],e[5]=R?Qu(R,_,i[6]):_,e[6]=R?_i(e[5],E):i[6]),_=i[7],_&&(e[7]=_),c&H&&(e[8]=e[8]==null?i[8]:Gt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function Ag(e){var i=[];if(e!=null)for(var o in We(e))i.push(o);return i}function Cg(e){return qn.call(e)}function dh(e,i,o){return i=Mt(i===r?e.length-1:i,0),function(){for(var c=arguments,l=-1,d=Mt(c.length-i,0),w=N(d);++l<d;)w[l]=c[i+l];l=-1;for(var _=N(i+1);++l<i;)_[l]=c[l];return _[i]=o(w),Ut(e,this,_)}}function gh(e,i){return i.length<2?e:ki(e,Tr(i,0,-1))}function Ng(e,i){for(var o=e.length,c=Gt(i.length,o),l=cr(e);c--;){var d=i[c];e[c]=oi(d,o)?l[d]:r}return e}function Fa(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var yh=mh(Uu),Gs=Gp||function(e,i){return Re.setTimeout(e,i)},Ga=mh(tg);function vh(e,i,o){var c=i+"";return Ga(e,Ig(c,$g(bg(c),o)))}function mh(e){var i=0,o=0;return function(){var c=Yp(),l=ze-(c-o);if(o=c,l>0){if(++i>=Ce)return arguments[0]}else i=0;return e.apply(r,arguments)}}function co(e,i){var o=-1,c=e.length,l=c-1;for(i=i===r?c:i;++o<i;){var d=Ta(o,l),w=e[d];e[d]=e[o],e[o]=w}return e.length=i,e}var wh=Rg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Rt,function(o,c,l,d){i.push(l?d.replace(zo,"$1"):c||o)}),i});function Jr(e){if(typeof e=="string"||wr(e))return e;var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function Vi(e){if(e!=null){try{return Mn.call(e)}catch{}try{return e+""}catch{}}return""}function $g(e,i){return Pr(Kr,function(o){var c="_."+o[0];i&o[1]&&!Nn(e,c)&&e.push(c)}),e.sort()}function bh(e){if(e instanceof Oe)return e.clone();var i=new Or(e.__wrapped__,e.__chain__);return i.__actions__=cr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function Dg(e,i,o){(o?er(e,i,o):i===r)?i=1:i=Mt(be(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var l=0,d=0,w=N(Vn(c/i));l<c;)w[d++]=Tr(e,l,l+=i);return w}function Lg(e){for(var i=-1,o=e==null?0:e.length,c=0,l=[];++i<o;){var d=e[i];d&&(l[c++]=d)}return l}function jg(){var e=arguments.length;if(!e)return[];for(var i=N(e-1),o=arguments[0],c=e;c--;)i[c-1]=arguments[c];return bi(we(o)?cr(o):[o],Bt(i,1))}var Mg=xe(function(e,i){return _t(e)?Hs(e,Bt(i,1,_t,!0)):[]}),qg=xe(function(e,i){var o=Ar(i);return _t(o)&&(o=r),_t(e)?Hs(e,Bt(i,1,_t,!0),ne(o,2)):[]}),Ug=xe(function(e,i){var o=Ar(i);return _t(o)&&(o=r),_t(e)?Hs(e,Bt(i,1,_t,!0),r,o):[]});function zg(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),Tr(e,i<0?0:i,c)):[]}function Hg(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),i=c-i,Tr(e,0,i<0?0:i)):[]}function kg(e,i){return e&&e.length?eo(e,ne(i,3),!0,!0):[]}function Kg(e,i){return e&&e.length?eo(e,ne(i,3),!0):[]}function Vg(e,i,o,c){var l=e==null?0:e.length;return l?(o&&typeof o!="number"&&er(e,i,o)&&(o=0,c=l),jd(e,i,o,c)):[]}function _h(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:be(o);return l<0&&(l=Mt(c+l,0)),$n(e,ne(i,3),l)}function Eh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return o!==r&&(l=be(o),l=o<0?Mt(c+l,0):Gt(l,c-1)),$n(e,ne(i,3),l,!0)}function Ih(e){var i=e==null?0:e.length;return i?Bt(e,1):[]}function Bg(e){var i=e==null?0:e.length;return i?Bt(e,ce):[]}function Fg(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:be(i),Bt(e,i)):[]}function Gg(e){for(var i=-1,o=e==null?0:e.length,c={};++i<o;){var l=e[i];c[l[0]]=l[1]}return c}function xh(e){return e&&e.length?e[0]:r}function Wg(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:be(o);return l<0&&(l=Mt(c+l,0)),as(e,i,l)}function Jg(e){var i=e==null?0:e.length;return i?Tr(e,0,-1):[]}var Qg=xe(function(e){var i=st(e,Da);return i.length&&i[0]===e[0]?xa(i):[]}),Yg=xe(function(e){var i=Ar(e),o=st(e,Da);return i===Ar(o)?i=r:o.pop(),o.length&&o[0]===e[0]?xa(o,ne(i,2)):[]}),Xg=xe(function(e){var i=Ar(e),o=st(e,Da);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?xa(o,r,i):[]});function Zg(e,i){return e==null?"":Jp.call(e,i)}function Ar(e){var i=e==null?0:e.length;return i?e[i-1]:r}function ey(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c;return o!==r&&(l=be(o),l=l<0?Mt(c+l,0):Gt(l,c-1)),i===i?$p(e,i,l):$n(e,su,l,!0)}function ty(e,i){return e&&e.length?Lu(e,be(i)):r}var ry=xe(Ph);function Ph(e,i){return e&&e.length&&i&&i.length?Ra(e,i):e}function iy(e,i,o){return e&&e.length&&i&&i.length?Ra(e,i,ne(o,2)):e}function sy(e,i,o){return e&&e.length&&i&&i.length?Ra(e,i,r,o):e}var ny=ni(function(e,i){var o=e==null?0:e.length,c=ba(e,i);return qu(e,st(i,function(l){return oi(l,o)?+l:l}).sort(Wu)),c});function oy(e,i){var o=[];if(!(e&&e.length))return o;var c=-1,l=[],d=e.length;for(i=ne(i,3);++c<d;){var w=e[c];i(w,c,e)&&(o.push(w),l.push(c))}return qu(e,l),o}function Wa(e){return e==null?e:Zp.call(e)}function ay(e,i,o){var c=e==null?0:e.length;return c?(o&&typeof o!="number"&&er(e,i,o)?(i=0,o=c):(i=i==null?0:be(i),o=o===r?c:be(o)),Tr(e,i,o)):[]}function cy(e,i){return Zn(e,i)}function uy(e,i,o){return Ca(e,i,ne(o,2))}function hy(e,i){var o=e==null?0:e.length;if(o){var c=Zn(e,i);if(c<o&&qr(e[c],i))return c}return-1}function ly(e,i){return Zn(e,i,!0)}function fy(e,i,o){return Ca(e,i,ne(o,2),!0)}function py(e,i){var o=e==null?0:e.length;if(o){var c=Zn(e,i,!0)-1;if(qr(e[c],i))return c}return-1}function dy(e){return e&&e.length?zu(e):[]}function gy(e,i){return e&&e.length?zu(e,ne(i,2)):[]}function yy(e){var i=e==null?0:e.length;return i?Tr(e,1,i):[]}function vy(e,i,o){return e&&e.length?(i=o||i===r?1:be(i),Tr(e,0,i<0?0:i)):[]}function my(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),i=c-i,Tr(e,i<0?0:i,c)):[]}function wy(e,i){return e&&e.length?eo(e,ne(i,3),!1,!0):[]}function by(e,i){return e&&e.length?eo(e,ne(i,3)):[]}var _y=xe(function(e){return xi(Bt(e,1,_t,!0))}),Ey=xe(function(e){var i=Ar(e);return _t(i)&&(i=r),xi(Bt(e,1,_t,!0),ne(i,2))}),Iy=xe(function(e){var i=Ar(e);return i=typeof i=="function"?i:r,xi(Bt(e,1,_t,!0),r,i)});function xy(e){return e&&e.length?xi(e):[]}function Py(e,i){return e&&e.length?xi(e,ne(i,2)):[]}function Sy(e,i){return i=typeof i=="function"?i:r,e&&e.length?xi(e,r,i):[]}function Ja(e){if(!(e&&e.length))return[];var i=0;return e=wi(e,function(o){if(_t(o))return i=Mt(o.length,i),!0}),fa(i,function(o){return st(e,ua(o))})}function Sh(e,i){if(!(e&&e.length))return[];var o=Ja(e);return i==null?o:st(o,function(c){return Ut(i,r,c)})}var Oy=xe(function(e,i){return _t(e)?Hs(e,i):[]}),Ry=xe(function(e){return $a(wi(e,_t))}),Ty=xe(function(e){var i=Ar(e);return _t(i)&&(i=r),$a(wi(e,_t),ne(i,2))}),Ay=xe(function(e){var i=Ar(e);return i=typeof i=="function"?i:r,$a(wi(e,_t),r,i)}),Cy=xe(Ja);function Ny(e,i){return Vu(e||[],i||[],zs)}function $y(e,i){return Vu(e||[],i||[],Vs)}var Dy=xe(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,Sh(e,o)});function Oh(e){var i=p(e);return i.__chain__=!0,i}function Ly(e,i){return i(e),e}function uo(e,i){return i(e)}var jy=ni(function(e){var i=e.length,o=i?e[0]:0,c=this.__wrapped__,l=function(d){return ba(d,e)};return i>1||this.__actions__.length||!(c instanceof Oe)||!oi(o)?this.thru(l):(c=c.slice(o,+o+(i?1:0)),c.__actions__.push({func:uo,args:[l],thisArg:r}),new Or(c,this.__chain__).thru(function(d){return i&&!d.length&&d.push(r),d}))});function My(){return Oh(this)}function qy(){return new Or(this.value(),this.__chain__)}function Uy(){this.__values__===r&&(this.__values__=Hh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function zy(){return this}function Hy(e){for(var i,o=this;o instanceof Wn;){var c=bh(o);c.__index__=0,c.__values__=r,i?l.__wrapped__=c:i=c;var l=c;o=o.__wrapped__}return l.__wrapped__=e,i}function ky(){var e=this.__wrapped__;if(e instanceof Oe){var i=e;return this.__actions__.length&&(i=new Oe(this)),i=i.reverse(),i.__actions__.push({func:uo,args:[Wa],thisArg:r}),new Or(i,this.__chain__)}return this.thru(Wa)}function Ky(){return Ku(this.__wrapped__,this.__actions__)}var Vy=to(function(e,i,o){Ue.call(e,o)?++e[o]:ii(e,o,1)});function By(e,i,o){var c=we(e)?ru:Ld;return o&&er(e,i,o)&&(i=r),c(e,ne(i,3))}function Fy(e,i){var o=we(e)?wi:Su;return o(e,ne(i,3))}var Gy=eh(_h),Wy=eh(Eh);function Jy(e,i){return Bt(ho(e,i),1)}function Qy(e,i){return Bt(ho(e,i),ce)}function Yy(e,i,o){return o=o===r?1:be(o),Bt(ho(e,i),o)}function Rh(e,i){var o=we(e)?Pr:Ii;return o(e,ne(i,3))}function Th(e,i){var o=we(e)?yp:Pu;return o(e,ne(i,3))}var Xy=to(function(e,i,o){Ue.call(e,o)?e[o].push(i):ii(e,o,[i])});function Zy(e,i,o,c){e=ur(e)?e:ws(e),o=o&&!c?be(o):0;var l=e.length;return o<0&&(o=Mt(l+o,0)),yo(e)?o<=l&&e.indexOf(i,o)>-1:!!l&&as(e,i,o)>-1}var ev=xe(function(e,i,o){var c=-1,l=typeof i=="function",d=ur(e)?N(e.length):[];return Ii(e,function(w){d[++c]=l?Ut(i,w,o):ks(w,i,o)}),d}),tv=to(function(e,i,o){ii(e,o,i)});function ho(e,i){var o=we(e)?st:Nu;return o(e,ne(i,3))}function rv(e,i,o,c){return e==null?[]:(we(i)||(i=i==null?[]:[i]),o=c?r:o,we(o)||(o=o==null?[]:[o]),ju(e,i,o))}var iv=to(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function sv(e,i,o){var c=we(e)?aa:ou,l=arguments.length<3;return c(e,ne(i,4),o,l,Ii)}function nv(e,i,o){var c=we(e)?vp:ou,l=arguments.length<3;return c(e,ne(i,4),o,l,Pu)}function ov(e,i){var o=we(e)?wi:Su;return o(e,po(ne(i,3)))}function av(e){var i=we(e)?_u:Zd;return i(e)}function cv(e,i,o){(o?er(e,i,o):i===r)?i=1:i=be(i);var c=we(e)?Ad:eg;return c(e,i)}function uv(e){var i=we(e)?Cd:rg;return i(e)}function hv(e){if(e==null)return 0;if(ur(e))return yo(e)?us(e):e.length;var i=Wt(e);return i==_e||i==je?e.size:Sa(e).length}function lv(e,i,o){var c=we(e)?ca:ig;return o&&er(e,i,o)&&(i=r),c(e,ne(i,3))}var fv=xe(function(e,i){if(e==null)return[];var o=i.length;return o>1&&er(e,i[0],i[1])?i=[]:o>2&&er(i[0],i[1],i[2])&&(i=[i[0]]),ju(e,Bt(i,1),[])}),lo=Fp||function(){return Re.Date.now()};function pv(e,i){if(typeof i!="function")throw new Sr(f);return e=be(e),function(){if(--e<1)return i.apply(this,arguments)}}function Ah(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,si(e,H,r,r,r,r,i)}function Ch(e,i){var o;if(typeof i!="function")throw new Sr(f);return e=be(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var Qa=xe(function(e,i,o){var c=ie;if(o.length){var l=_i(o,vs(Qa));c|=de}return si(e,c,i,o,l)}),Nh=xe(function(e,i,o){var c=ie|he;if(o.length){var l=_i(o,vs(Nh));c|=de}return si(i,c,e,o,l)});function $h(e,i,o){i=o?r:i;var c=si(e,fe,r,r,r,r,r,i);return c.placeholder=$h.placeholder,c}function Dh(e,i,o){i=o?r:i;var c=si(e,pe,r,r,r,r,r,i);return c.placeholder=Dh.placeholder,c}function Lh(e,i,o){var c,l,d,w,_,R,M=0,q=!1,K=!1,Q=!0;if(typeof e!="function")throw new Sr(f);i=Cr(i)||0,ut(o)&&(q=!!o.leading,K="maxWait"in o,d=K?Mt(Cr(o.maxWait)||0,i):d,Q="trailing"in o?!!o.trailing:Q);function te(Et){var Ur=c,ui=l;return c=l=r,M=Et,w=e.apply(ui,Ur),w}function oe(Et){return M=Et,_=Gs(Pe,i),q?te(Et):w}function Ee(Et){var Ur=Et-R,ui=Et-M,el=i-Ur;return K?Gt(el,d-ui):el}function ae(Et){var Ur=Et-R,ui=Et-M;return R===r||Ur>=i||Ur<0||K&&ui>=d}function Pe(){var Et=lo();if(ae(Et))return Te(Et);_=Gs(Pe,Ee(Et))}function Te(Et){return _=r,Q&&c?te(Et):(c=l=r,w)}function br(){_!==r&&Bu(_),M=0,c=R=l=_=r}function tr(){return _===r?w:Te(lo())}function _r(){var Et=lo(),Ur=ae(Et);if(c=arguments,l=this,R=Et,Ur){if(_===r)return oe(R);if(K)return Bu(_),_=Gs(Pe,i),te(R)}return _===r&&(_=Gs(Pe,i)),w}return _r.cancel=br,_r.flush=tr,_r}var dv=xe(function(e,i){return xu(e,1,i)}),gv=xe(function(e,i,o){return xu(e,Cr(i)||0,o)});function yv(e){return si(e,ve)}function fo(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Sr(f);var o=function(){var c=arguments,l=i?i.apply(this,c):c[0],d=o.cache;if(d.has(l))return d.get(l);var w=e.apply(this,c);return o.cache=d.set(l,w)||d,w};return o.cache=new(fo.Cache||ri),o}fo.Cache=ri;function po(e){if(typeof e!="function")throw new Sr(f);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function vv(e){return Ch(2,e)}var mv=sg(function(e,i){i=i.length==1&&we(i[0])?st(i[0],vr(ne())):st(Bt(i,1),vr(ne()));var o=i.length;return xe(function(c){for(var l=-1,d=Gt(c.length,o);++l<d;)c[l]=i[l].call(this,c[l]);return Ut(e,this,c)})}),Ya=xe(function(e,i){var o=_i(i,vs(Ya));return si(e,de,r,i,o)}),jh=xe(function(e,i){var o=_i(i,vs(jh));return si(e,L,r,i,o)}),wv=ni(function(e,i){return si(e,W,r,r,r,i)});function bv(e,i){if(typeof e!="function")throw new Sr(f);return i=i===r?i:be(i),xe(e,i)}function _v(e,i){if(typeof e!="function")throw new Sr(f);return i=i==null?0:Mt(be(i),0),xe(function(o){var c=o[i],l=Si(o,0,i);return c&&bi(l,c),Ut(e,this,l)})}function Ev(e,i,o){var c=!0,l=!0;if(typeof e!="function")throw new Sr(f);return ut(o)&&(c="leading"in o?!!o.leading:c,l="trailing"in o?!!o.trailing:l),Lh(e,i,{leading:c,maxWait:i,trailing:l})}function Iv(e){return Ah(e,1)}function xv(e,i){return Ya(La(i),e)}function Pv(){if(!arguments.length)return[];var e=arguments[0];return we(e)?e:[e]}function Sv(e){return Rr(e,U)}function Ov(e,i){return i=typeof i=="function"?i:r,Rr(e,U,i)}function Rv(e){return Rr(e,O|U)}function Tv(e,i){return i=typeof i=="function"?i:r,Rr(e,O|U,i)}function Av(e,i){return i==null||Iu(e,i,zt(i))}function qr(e,i){return e===i||e!==e&&i!==i}var Cv=no(Ia),Nv=no(function(e,i){return e>=i}),Bi=Tu(function(){return arguments}())?Tu:function(e){return vt(e)&&Ue.call(e,"callee")&&!gu.call(e,"callee")},we=N.isArray,$v=Xt?vr(Xt):Hd;function ur(e){return e!=null&&go(e.length)&&!ai(e)}function _t(e){return vt(e)&&ur(e)}function Dv(e){return e===!0||e===!1||vt(e)&&Zt(e)==$}var Oi=Wp||cc,Lv=Lr?vr(Lr):kd;function jv(e){return vt(e)&&e.nodeType===1&&!Ws(e)}function Mv(e){if(e==null)return!0;if(ur(e)&&(we(e)||typeof e=="string"||typeof e.splice=="function"||Oi(e)||ms(e)||Bi(e)))return!e.length;var i=Wt(e);if(i==_e||i==je)return!e.size;if(Fs(e))return!Sa(e).length;for(var o in e)if(Ue.call(e,o))return!1;return!0}function qv(e,i){return Ks(e,i)}function Uv(e,i,o){o=typeof o=="function"?o:r;var c=o?o(e,i):r;return c===r?Ks(e,i,r,o):!!c}function Xa(e){if(!vt(e))return!1;var i=Zt(e);return i==I||i==u||typeof e.message=="string"&&typeof e.name=="string"&&!Ws(e)}function zv(e){return typeof e=="number"&&vu(e)}function ai(e){if(!ut(e))return!1;var i=Zt(e);return i==ee||i==ge||i==D||i==mt}function Mh(e){return typeof e=="number"&&e==be(e)}function go(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=F}function ut(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function vt(e){return e!=null&&typeof e=="object"}var qh=xr?vr(xr):Vd;function Hv(e,i){return e===i||Pa(e,i,ka(i))}function kv(e,i,o){return o=typeof o=="function"?o:r,Pa(e,i,ka(i),o)}function Kv(e){return Uh(e)&&e!=+e}function Vv(e){if(Og(e))throw new ye(h);return Au(e)}function Bv(e){return e===null}function Fv(e){return e==null}function Uh(e){return typeof e=="number"||vt(e)&&Zt(e)==Ne}function Ws(e){if(!vt(e)||Zt(e)!=Se)return!1;var i=Hn(e);if(i===null)return!0;var o=Ue.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Mn.call(o)==kp}var Za=Fr?vr(Fr):Bd;function Gv(e){return Mh(e)&&e>=-F&&e<=F}var zh=$s?vr($s):Fd;function yo(e){return typeof e=="string"||!we(e)&&vt(e)&&Zt(e)==Ye}function wr(e){return typeof e=="symbol"||vt(e)&&Zt(e)==Xe}var ms=Mi?vr(Mi):Gd;function Wv(e){return e===r}function Jv(e){return vt(e)&&Wt(e)==He}function Qv(e){return vt(e)&&Zt(e)==Ze}var Yv=no(Oa),Xv=no(function(e,i){return e<=i});function Hh(e){if(!e)return[];if(ur(e))return yo(e)?jr(e):cr(e);if(Ls&&e[Ls])return Ap(e[Ls]());var i=Wt(e),o=i==_e?da:i==je?Dn:ws;return o(e)}function ci(e){if(!e)return e===0?e:0;if(e=Cr(e),e===ce||e===-ce){var i=e<0?-1:1;return i*k}return e===e?e:0}function be(e){var i=ci(e),o=i%1;return i===i?o?i-o:i:0}function kh(e){return e?Hi(be(e),0,G):0}function Cr(e){if(typeof e=="number")return e;if(wr(e))return V;if(ut(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ut(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=au(e);var o=Ko.test(e);return o||Bo.test(e)?me(e.slice(2),o?2:8):ko.test(e)?V:+e}function Kh(e){return Wr(e,hr(e))}function Zv(e){return e?Hi(be(e),-F,F):e===0?e:0}function Me(e){return e==null?"":mr(e)}var em=gs(function(e,i){if(Fs(i)||ur(i)){Wr(i,zt(i),e);return}for(var o in i)Ue.call(i,o)&&zs(e,o,i[o])}),Vh=gs(function(e,i){Wr(i,hr(i),e)}),vo=gs(function(e,i,o,c){Wr(i,hr(i),e,c)}),tm=gs(function(e,i,o,c){Wr(i,zt(i),e,c)}),rm=ni(ba);function im(e,i){var o=ds(e);return i==null?o:Eu(o,i)}var sm=xe(function(e,i){e=We(e);var o=-1,c=i.length,l=c>2?i[2]:r;for(l&&er(i[0],i[1],l)&&(c=1);++o<c;)for(var d=i[o],w=hr(d),_=-1,R=w.length;++_<R;){var M=w[_],q=e[M];(q===r||qr(q,ls[M])&&!Ue.call(e,M))&&(e[M]=d[M])}return e}),nm=xe(function(e){return e.push(r,ah),Ut(Bh,r,e)});function om(e,i){return iu(e,ne(i,3),Gr)}function am(e,i){return iu(e,ne(i,3),Ea)}function cm(e,i){return e==null?e:_a(e,ne(i,3),hr)}function um(e,i){return e==null?e:Ou(e,ne(i,3),hr)}function hm(e,i){return e&&Gr(e,ne(i,3))}function lm(e,i){return e&&Ea(e,ne(i,3))}function fm(e){return e==null?[]:Yn(e,zt(e))}function pm(e){return e==null?[]:Yn(e,hr(e))}function ec(e,i,o){var c=e==null?r:ki(e,i);return c===r?o:c}function dm(e,i){return e!=null&&hh(e,i,Md)}function tc(e,i){return e!=null&&hh(e,i,qd)}var gm=rh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=qn.call(i)),e[i]=o},ic(lr)),ym=rh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=qn.call(i)),Ue.call(e,i)?e[i].push(o):e[i]=[o]},ne),vm=xe(ks);function zt(e){return ur(e)?bu(e):Sa(e)}function hr(e){return ur(e)?bu(e,!0):Wd(e)}function mm(e,i){var o={};return i=ne(i,3),Gr(e,function(c,l,d){ii(o,i(c,l,d),c)}),o}function wm(e,i){var o={};return i=ne(i,3),Gr(e,function(c,l,d){ii(o,l,i(c,l,d))}),o}var bm=gs(function(e,i,o){Xn(e,i,o)}),Bh=gs(function(e,i,o,c){Xn(e,i,o,c)}),_m=ni(function(e,i){var o={};if(e==null)return o;var c=!1;i=st(i,function(d){return d=Pi(d,e),c||(c=d.length>1),d}),Wr(e,za(e),o),c&&(o=Rr(o,O|C|U,gg));for(var l=i.length;l--;)Na(o,i[l]);return o});function Em(e,i){return Fh(e,po(ne(i)))}var Im=ni(function(e,i){return e==null?{}:Qd(e,i)});function Fh(e,i){if(e==null)return{};var o=st(za(e),function(c){return[c]});return i=ne(i),Mu(e,o,function(c,l){return i(c,l[0])})}function xm(e,i,o){i=Pi(i,e);var c=-1,l=i.length;for(l||(l=1,e=r);++c<l;){var d=e==null?r:e[Jr(i[c])];d===r&&(c=l,d=o),e=ai(d)?d.call(e):d}return e}function Pm(e,i,o){return e==null?e:Vs(e,i,o)}function Sm(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:Vs(e,i,o,c)}var Gh=nh(zt),Wh=nh(hr);function Om(e,i,o){var c=we(e),l=c||Oi(e)||ms(e);if(i=ne(i,4),o==null){var d=e&&e.constructor;l?o=c?new d:[]:ut(e)?o=ai(d)?ds(Hn(e)):{}:o={}}return(l?Pr:Gr)(e,function(w,_,R){return i(o,w,_,R)}),o}function Rm(e,i){return e==null?!0:Na(e,i)}function Tm(e,i,o){return e==null?e:ku(e,i,La(o))}function Am(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:ku(e,i,La(o),c)}function ws(e){return e==null?[]:pa(e,zt(e))}function Cm(e){return e==null?[]:pa(e,hr(e))}function Nm(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Cr(o),o=o===o?o:0),i!==r&&(i=Cr(i),i=i===i?i:0),Hi(Cr(e),i,o)}function $m(e,i,o){return i=ci(i),o===r?(o=i,i=0):o=ci(o),e=Cr(e),Ud(e,i,o)}function Dm(e,i,o){if(o&&typeof o!="boolean"&&er(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ci(e),i===r?(i=e,e=0):i=ci(i)),e>i){var c=e;e=i,i=c}if(o||e%1||i%1){var l=mu();return Gt(e+l*(i-e+Fe("1e-"+((l+"").length-1))),i)}return Ta(e,i)}var Lm=ys(function(e,i,o){return i=i.toLowerCase(),e+(o?Jh(i):i)});function Jh(e){return rc(Me(e).toLowerCase())}function Qh(e){return e=Me(e),e&&e.replace(Zr,Pp).replace(sa,"")}function jm(e,i,o){e=Me(e),i=mr(i);var c=e.length;o=o===r?c:Hi(be(o),0,c);var l=o;return o-=i.length,o>=0&&e.slice(o,l)==i}function Mm(e){return e=Me(e),e&&rt.test(e)?e.replace(Ni,Sp):e}function qm(e){return e=Me(e),e&&Tt.test(e)?e.replace(dt,"\\$&"):e}var Um=ys(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),zm=ys(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),Hm=Zu("toLowerCase");function km(e,i,o){e=Me(e),i=be(i);var c=i?us(e):0;if(!i||c>=i)return e;var l=(i-c)/2;return so(Bn(l),o)+e+so(Vn(l),o)}function Km(e,i,o){e=Me(e),i=be(i);var c=i?us(e):0;return i&&c<i?e+so(i-c,o):e}function Vm(e,i,o){e=Me(e),i=be(i);var c=i?us(e):0;return i&&c<i?so(i-c,o)+e:e}function Bm(e,i,o){return o||i==null?i=0:i&&(i=+i),Xp(Me(e).replace(gt,""),i||0)}function Fm(e,i,o){return(o?er(e,i,o):i===r)?i=1:i=be(i),Aa(Me(e),i)}function Gm(){var e=arguments,i=Me(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Wm=ys(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function Jm(e,i,o){return o&&typeof o!="number"&&er(e,i,o)&&(i=o=r),o=o===r?G:o>>>0,o?(e=Me(e),e&&(typeof i=="string"||i!=null&&!Za(i))&&(i=mr(i),!i&&cs(e))?Si(jr(e),0,o):e.split(i,o)):[]}var Qm=ys(function(e,i,o){return e+(o?" ":"")+rc(i)});function Ym(e,i,o){return e=Me(e),o=o==null?0:Hi(be(o),0,e.length),i=mr(i),e.slice(o,o+i.length)==i}function Xm(e,i,o){var c=p.templateSettings;o&&er(e,i,o)&&(i=r),e=Me(e),i=vo({},i,c,oh);var l=vo({},i.imports,c.imports,oh),d=zt(l),w=pa(l,d),_,R,M=0,q=i.interpolate||es,K="__p += '",Q=ga((i.escape||es).source+"|"+q.source+"|"+(q===ct?Ho:es).source+"|"+(i.evaluate||es).source+"|$","g"),te="//# sourceURL="+(Ue.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++na+"]")+`
`;e.replace(Q,function(ae,Pe,Te,br,tr,_r){return Te||(Te=br),K+=e.slice(M,_r).replace(Go,Op),Pe&&(_=!0,K+=`' +
__e(`+Pe+`) +
'`),tr&&(R=!0,K+=`';
`+tr+`;
__p += '`),Te&&(K+=`' +
((__t = (`+Te+`)) == null ? '' : __t) +
'`),M=_r+ae.length,ae}),K+=`';
`;var oe=Ue.call(i,"variable")&&i.variable;if(!oe)K=`with (obj) {
`+K+`
}
`;else if(Uo.test(oe))throw new ye(g);K=(R?K.replace(Vr,""):K).replace(Yt,"$1").replace(Xr,"$1;"),K="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+K+`return __p
}`;var Ee=Xh(function(){return Le(d,te+"return "+K).apply(r,w)});if(Ee.source=K,Xa(Ee))throw Ee;return Ee}function Zm(e){return Me(e).toLowerCase()}function ew(e){return Me(e).toUpperCase()}function tw(e,i,o){if(e=Me(e),e&&(o||i===r))return au(e);if(!e||!(i=mr(i)))return e;var c=jr(e),l=jr(i),d=cu(c,l),w=uu(c,l)+1;return Si(c,d,w).join("")}function rw(e,i,o){if(e=Me(e),e&&(o||i===r))return e.slice(0,lu(e)+1);if(!e||!(i=mr(i)))return e;var c=jr(e),l=uu(c,jr(i))+1;return Si(c,0,l).join("")}function iw(e,i,o){if(e=Me(e),e&&(o||i===r))return e.replace(gt,"");if(!e||!(i=mr(i)))return e;var c=jr(e),l=cu(c,jr(i));return Si(c,l).join("")}function sw(e,i){var o=se,c=ue;if(ut(i)){var l="separator"in i?i.separator:l;o="length"in i?be(i.length):o,c="omission"in i?mr(i.omission):c}e=Me(e);var d=e.length;if(cs(e)){var w=jr(e);d=w.length}if(o>=d)return e;var _=o-us(c);if(_<1)return c;var R=w?Si(w,0,_).join(""):e.slice(0,_);if(l===r)return R+c;if(w&&(_+=R.length-_),Za(l)){if(e.slice(_).search(l)){var M,q=R;for(l.global||(l=ga(l.source,Me(Ir.exec(l))+"g")),l.lastIndex=0;M=l.exec(q);)var K=M.index;R=R.slice(0,K===r?_:K)}}else if(e.indexOf(mr(l),_)!=_){var Q=R.lastIndexOf(l);Q>-1&&(R=R.slice(0,Q))}return R+c}function nw(e){return e=Me(e),e&&lt.test(e)?e.replace(vi,Dp):e}var ow=ys(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),rc=Zu("toUpperCase");function Yh(e,i,o){return e=Me(e),i=o?r:i,i===r?Tp(e)?Mp(e):bp(e):e.match(i)||[]}var Xh=xe(function(e,i){try{return Ut(e,r,i)}catch(o){return Xa(o)?o:new ye(o)}}),aw=ni(function(e,i){return Pr(i,function(o){o=Jr(o),ii(e,o,Qa(e[o],e))}),e});function cw(e){var i=e==null?0:e.length,o=ne();return e=i?st(e,function(c){if(typeof c[1]!="function")throw new Sr(f);return[o(c[0]),c[1]]}):[],xe(function(c){for(var l=-1;++l<i;){var d=e[l];if(Ut(d[0],this,c))return Ut(d[1],this,c)}})}function uw(e){return Dd(Rr(e,O))}function ic(e){return function(){return e}}function hw(e,i){return e==null||e!==e?i:e}var lw=th(),fw=th(!0);function lr(e){return e}function sc(e){return Cu(typeof e=="function"?e:Rr(e,O))}function pw(e){return $u(Rr(e,O))}function dw(e,i){return Du(e,Rr(i,O))}var gw=xe(function(e,i){return function(o){return ks(o,e,i)}}),yw=xe(function(e,i){return function(o){return ks(e,o,i)}});function nc(e,i,o){var c=zt(i),l=Yn(i,c);o==null&&!(ut(i)&&(l.length||!c.length))&&(o=i,i=e,e=this,l=Yn(i,zt(i)));var d=!(ut(o)&&"chain"in o)||!!o.chain,w=ai(e);return Pr(l,function(_){var R=i[_];e[_]=R,w&&(e.prototype[_]=function(){var M=this.__chain__;if(d||M){var q=e(this.__wrapped__),K=q.__actions__=cr(this.__actions__);return K.push({func:R,args:arguments,thisArg:e}),q.__chain__=M,q}return R.apply(e,bi([this.value()],arguments))})}),e}function vw(){return Re._===this&&(Re._=Kp),this}function oc(){}function mw(e){return e=be(e),xe(function(i){return Lu(i,e)})}var ww=Ma(st),bw=Ma(ru),_w=Ma(ca);function Zh(e){return Va(e)?ua(Jr(e)):Yd(e)}function Ew(e){return function(i){return e==null?r:ki(e,i)}}var Iw=ih(),xw=ih(!0);function ac(){return[]}function cc(){return!1}function Pw(){return{}}function Sw(){return""}function Ow(){return!0}function Rw(e,i){if(e=be(e),e<1||e>F)return[];var o=G,c=Gt(e,G);i=ne(i),e-=G;for(var l=fa(c,i);++o<e;)i(o);return l}function Tw(e){return we(e)?st(e,Jr):wr(e)?[e]:cr(wh(Me(e)))}function Aw(e){var i=++Hp;return Me(e)+i}var Cw=io(function(e,i){return e+i},0),Nw=qa("ceil"),$w=io(function(e,i){return e/i},1),Dw=qa("floor");function Lw(e){return e&&e.length?Qn(e,lr,Ia):r}function jw(e,i){return e&&e.length?Qn(e,ne(i,2),Ia):r}function Mw(e){return nu(e,lr)}function qw(e,i){return nu(e,ne(i,2))}function Uw(e){return e&&e.length?Qn(e,lr,Oa):r}function zw(e,i){return e&&e.length?Qn(e,ne(i,2),Oa):r}var Hw=io(function(e,i){return e*i},1),kw=qa("round"),Kw=io(function(e,i){return e-i},0);function Vw(e){return e&&e.length?la(e,lr):0}function Bw(e,i){return e&&e.length?la(e,ne(i,2)):0}return p.after=pv,p.ary=Ah,p.assign=em,p.assignIn=Vh,p.assignInWith=vo,p.assignWith=tm,p.at=rm,p.before=Ch,p.bind=Qa,p.bindAll=aw,p.bindKey=Nh,p.castArray=Pv,p.chain=Oh,p.chunk=Dg,p.compact=Lg,p.concat=jg,p.cond=cw,p.conforms=uw,p.constant=ic,p.countBy=Vy,p.create=im,p.curry=$h,p.curryRight=Dh,p.debounce=Lh,p.defaults=sm,p.defaultsDeep=nm,p.defer=dv,p.delay=gv,p.difference=Mg,p.differenceBy=qg,p.differenceWith=Ug,p.drop=zg,p.dropRight=Hg,p.dropRightWhile=kg,p.dropWhile=Kg,p.fill=Vg,p.filter=Fy,p.flatMap=Jy,p.flatMapDeep=Qy,p.flatMapDepth=Yy,p.flatten=Ih,p.flattenDeep=Bg,p.flattenDepth=Fg,p.flip=yv,p.flow=lw,p.flowRight=fw,p.fromPairs=Gg,p.functions=fm,p.functionsIn=pm,p.groupBy=Xy,p.initial=Jg,p.intersection=Qg,p.intersectionBy=Yg,p.intersectionWith=Xg,p.invert=gm,p.invertBy=ym,p.invokeMap=ev,p.iteratee=sc,p.keyBy=tv,p.keys=zt,p.keysIn=hr,p.map=ho,p.mapKeys=mm,p.mapValues=wm,p.matches=pw,p.matchesProperty=dw,p.memoize=fo,p.merge=bm,p.mergeWith=Bh,p.method=gw,p.methodOf=yw,p.mixin=nc,p.negate=po,p.nthArg=mw,p.omit=_m,p.omitBy=Em,p.once=vv,p.orderBy=rv,p.over=ww,p.overArgs=mv,p.overEvery=bw,p.overSome=_w,p.partial=Ya,p.partialRight=jh,p.partition=iv,p.pick=Im,p.pickBy=Fh,p.property=Zh,p.propertyOf=Ew,p.pull=ry,p.pullAll=Ph,p.pullAllBy=iy,p.pullAllWith=sy,p.pullAt=ny,p.range=Iw,p.rangeRight=xw,p.rearg=wv,p.reject=ov,p.remove=oy,p.rest=bv,p.reverse=Wa,p.sampleSize=cv,p.set=Pm,p.setWith=Sm,p.shuffle=uv,p.slice=ay,p.sortBy=fv,p.sortedUniq=dy,p.sortedUniqBy=gy,p.split=Jm,p.spread=_v,p.tail=yy,p.take=vy,p.takeRight=my,p.takeRightWhile=wy,p.takeWhile=by,p.tap=Ly,p.throttle=Ev,p.thru=uo,p.toArray=Hh,p.toPairs=Gh,p.toPairsIn=Wh,p.toPath=Tw,p.toPlainObject=Kh,p.transform=Om,p.unary=Iv,p.union=_y,p.unionBy=Ey,p.unionWith=Iy,p.uniq=xy,p.uniqBy=Py,p.uniqWith=Sy,p.unset=Rm,p.unzip=Ja,p.unzipWith=Sh,p.update=Tm,p.updateWith=Am,p.values=ws,p.valuesIn=Cm,p.without=Oy,p.words=Yh,p.wrap=xv,p.xor=Ry,p.xorBy=Ty,p.xorWith=Ay,p.zip=Cy,p.zipObject=Ny,p.zipObjectDeep=$y,p.zipWith=Dy,p.entries=Gh,p.entriesIn=Wh,p.extend=Vh,p.extendWith=vo,nc(p,p),p.add=Cw,p.attempt=Xh,p.camelCase=Lm,p.capitalize=Jh,p.ceil=Nw,p.clamp=Nm,p.clone=Sv,p.cloneDeep=Rv,p.cloneDeepWith=Tv,p.cloneWith=Ov,p.conformsTo=Av,p.deburr=Qh,p.defaultTo=hw,p.divide=$w,p.endsWith=jm,p.eq=qr,p.escape=Mm,p.escapeRegExp=qm,p.every=By,p.find=Gy,p.findIndex=_h,p.findKey=om,p.findLast=Wy,p.findLastIndex=Eh,p.findLastKey=am,p.floor=Dw,p.forEach=Rh,p.forEachRight=Th,p.forIn=cm,p.forInRight=um,p.forOwn=hm,p.forOwnRight=lm,p.get=ec,p.gt=Cv,p.gte=Nv,p.has=dm,p.hasIn=tc,p.head=xh,p.identity=lr,p.includes=Zy,p.indexOf=Wg,p.inRange=$m,p.invoke=vm,p.isArguments=Bi,p.isArray=we,p.isArrayBuffer=$v,p.isArrayLike=ur,p.isArrayLikeObject=_t,p.isBoolean=Dv,p.isBuffer=Oi,p.isDate=Lv,p.isElement=jv,p.isEmpty=Mv,p.isEqual=qv,p.isEqualWith=Uv,p.isError=Xa,p.isFinite=zv,p.isFunction=ai,p.isInteger=Mh,p.isLength=go,p.isMap=qh,p.isMatch=Hv,p.isMatchWith=kv,p.isNaN=Kv,p.isNative=Vv,p.isNil=Fv,p.isNull=Bv,p.isNumber=Uh,p.isObject=ut,p.isObjectLike=vt,p.isPlainObject=Ws,p.isRegExp=Za,p.isSafeInteger=Gv,p.isSet=zh,p.isString=yo,p.isSymbol=wr,p.isTypedArray=ms,p.isUndefined=Wv,p.isWeakMap=Jv,p.isWeakSet=Qv,p.join=Zg,p.kebabCase=Um,p.last=Ar,p.lastIndexOf=ey,p.lowerCase=zm,p.lowerFirst=Hm,p.lt=Yv,p.lte=Xv,p.max=Lw,p.maxBy=jw,p.mean=Mw,p.meanBy=qw,p.min=Uw,p.minBy=zw,p.stubArray=ac,p.stubFalse=cc,p.stubObject=Pw,p.stubString=Sw,p.stubTrue=Ow,p.multiply=Hw,p.nth=ty,p.noConflict=vw,p.noop=oc,p.now=lo,p.pad=km,p.padEnd=Km,p.padStart=Vm,p.parseInt=Bm,p.random=Dm,p.reduce=sv,p.reduceRight=nv,p.repeat=Fm,p.replace=Gm,p.result=xm,p.round=kw,p.runInContext=S,p.sample=av,p.size=hv,p.snakeCase=Wm,p.some=lv,p.sortedIndex=cy,p.sortedIndexBy=uy,p.sortedIndexOf=hy,p.sortedLastIndex=ly,p.sortedLastIndexBy=fy,p.sortedLastIndexOf=py,p.startCase=Qm,p.startsWith=Ym,p.subtract=Kw,p.sum=Vw,p.sumBy=Bw,p.template=Xm,p.times=Rw,p.toFinite=ci,p.toInteger=be,p.toLength=kh,p.toLower=Zm,p.toNumber=Cr,p.toSafeInteger=Zv,p.toString=Me,p.toUpper=ew,p.trim=tw,p.trimEnd=rw,p.trimStart=iw,p.truncate=sw,p.unescape=nw,p.uniqueId=Aw,p.upperCase=ow,p.upperFirst=rc,p.each=Rh,p.eachRight=Th,p.first=xh,nc(p,function(){var e={};return Gr(p,function(i,o){Ue.call(p.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),p.VERSION=s,Pr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){p[e].placeholder=p}),Pr(["drop","take"],function(e,i){Oe.prototype[e]=function(o){o=o===r?1:Mt(be(o),0);var c=this.__filtered__&&!i?new Oe(this):this.clone();return c.__filtered__?c.__takeCount__=Gt(o,c.__takeCount__):c.__views__.push({size:Gt(o,G),type:e+(c.__dir__<0?"Right":"")}),c},Oe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Pr(["filter","map","takeWhile"],function(e,i){var o=i+1,c=o==m||o==X;Oe.prototype[e]=function(l){var d=this.clone();return d.__iteratees__.push({iteratee:ne(l,3),type:o}),d.__filtered__=d.__filtered__||c,d}}),Pr(["head","last"],function(e,i){var o="take"+(i?"Right":"");Oe.prototype[e]=function(){return this[o](1).value()[0]}}),Pr(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[o](1)}}),Oe.prototype.compact=function(){return this.filter(lr)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=xe(function(e,i){return typeof e=="function"?new Oe(this):this.map(function(o){return ks(o,e,i)})}),Oe.prototype.reject=function(e){return this.filter(po(ne(e)))},Oe.prototype.slice=function(e,i){e=be(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Oe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=be(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(G)},Gr(Oe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),l=p[c?"take"+(i=="last"?"Right":""):i],d=c||/^find/.test(i);l&&(p.prototype[i]=function(){var w=this.__wrapped__,_=c?[1]:arguments,R=w instanceof Oe,M=_[0],q=R||we(w),K=function(Pe){var Te=l.apply(p,bi([Pe],_));return c&&Q?Te[0]:Te};q&&o&&typeof M=="function"&&M.length!=1&&(R=q=!1);var Q=this.__chain__,te=!!this.__actions__.length,oe=d&&!Q,Ee=R&&!te;if(!d&&q){w=Ee?w:new Oe(this);var ae=e.apply(w,_);return ae.__actions__.push({func:uo,args:[K],thisArg:r}),new Or(ae,Q)}return oe&&Ee?e.apply(this,_):(ae=this.thru(K),oe?c?ae.value()[0]:ae.value():ae)})}),Pr(["pop","push","shift","sort","splice","unshift"],function(e){var i=Ln[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);p.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var d=this.value();return i.apply(we(d)?d:[],l)}return this[o](function(w){return i.apply(we(w)?w:[],l)})}}),Gr(Oe.prototype,function(e,i){var o=p[i];if(o){var c=o.name+"";Ue.call(ps,c)||(ps[c]=[]),ps[c].push({name:i,func:o})}}),ps[ro(r,he).name]=[{name:"wrapper",func:r}],Oe.prototype.clone=nd,Oe.prototype.reverse=od,Oe.prototype.value=ad,p.prototype.at=jy,p.prototype.chain=My,p.prototype.commit=qy,p.prototype.next=Uy,p.prototype.plant=Hy,p.prototype.reverse=ky,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=Ky,p.prototype.first=p.prototype.head,Ls&&(p.prototype[Ls]=zy),p},hs=qp();bt?((bt.exports=hs)._=hs,Ge._=hs):Re._=hs}).call(tn)})(jc,jc.exports);var JI=Object.defineProperty,QI=Object.defineProperties,YI=Object.getOwnPropertyDescriptors,uf=Object.getOwnPropertySymbols,XI=Object.prototype.hasOwnProperty,ZI=Object.prototype.propertyIsEnumerable,hf=(n,t,r)=>t in n?JI(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Eo=(n,t)=>{for(var r in t||(t={}))XI.call(t,r)&&hf(n,r,t[r]);if(uf)for(var r of uf(t))ZI.call(t,r)&&hf(n,r,t[r]);return n},ex=(n,t)=>QI(n,YI(t));function Ai(n,t,r){var s;const a=i0(n);return((s=t.rpcMap)==null?void 0:s[a.reference])||`${WI}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function Zi(n){return n.includes(":")?n.split(":")[1]:n}function pp(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function tx(n,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const h=t.namespaces[a].accounts;s.push(...h)}),s}function rx(n={},t={}){const r=lf(n),s=lf(t);return jc.exports.merge(r,s)}function lf(n){var t,r,s,a;const h={};if(!Is(n))return h;for(const[f,g]of Object.entries(n)){const b=Vc(f)?[f]:g.chains,y=g.methods||[],E=g.events||[],O=g.rpcMap||{},C=rn(f);h[C]=ex(Eo(Eo({},h[C]),g),{chains:uc(b,(t=h[C])==null?void 0:t.chains),methods:uc(y,(r=h[C])==null?void 0:r.methods),events:uc(E,(s=h[C])==null?void 0:s.events),rpcMap:Eo(Eo({},O),(a=h[C])==null?void 0:a.rpcMap)})}return h}function ix(n){return n.includes(":")?n.split(":")[2]:n}function sx(n){const t={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],h=s.events||[],f=s.accounts||[],g=Vc(r)?[r]:s.chains?s.chains:pp(s.accounts);t[r]={chains:g,methods:a,events:h,accounts:f}}return t}function Ec(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const dp={},nt=n=>dp[n],Ic=(n,t)=>{dp[n]=t};class nx{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ai(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ci(s,nt("disableProviderPing")))}}class ox{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Ai(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ci(s,nt("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=parseInt(Zi(r));t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const h=parseInt(a,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class ax{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ai(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ci(s,nt("disableProviderPing")))}}class cx{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ai(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ci(s,nt("disableProviderPing")))}}class ux{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),a=Zi(r);t[a]=this.createHttpProvider(a,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ci(s,nt("disableProviderPing")))}}class hx{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ai(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ci(s,nt("disableProviderPing")))}}class lx{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ai(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ci(s,nt("disableProviderPing")))}}class fx{constructor(t){this.name="near",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Ai(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ai(t,this.namespace);return typeof s>"u"?void 0:new gi(new Ci(s,nt("disableProviderPing")))}}var px=Object.defineProperty,dx=Object.defineProperties,gx=Object.getOwnPropertyDescriptors,ff=Object.getOwnPropertySymbols,yx=Object.prototype.hasOwnProperty,vx=Object.prototype.propertyIsEnumerable,pf=(n,t,r)=>t in n?px(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Io=(n,t)=>{for(var r in t||(t={}))yx.call(t,r)&&pf(n,r,t[r]);if(ff)for(var r of ff(t))vx.call(t,r)&&pf(n,r,t[r]);return n},xc=(n,t)=>dx(n,gx(t));class eu{constructor(t){this.events=new zc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||af})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new eu(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Io({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:It("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(h=>{this.session=h,this.namespaces||(this.namespaces=sx(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==lp)throw h;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Yr(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await HI.init({logger:this.providerOpts.logger||af,relayUrl:this.providerOpts.relayUrl||BI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>rn(r)))];Ic("client",this.client),Ic("events",this.events),Ic("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=tx(r,this.session),a=pp(s),h=rx(this.namespaces,this.optionalNamespaces),f=xc(Io({},h[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new ox({namespace:f});break;case"solana":this.rpcProviders[r]=new ax({namespace:f});break;case"cosmos":this.rpcProviders[r]=new cx({namespace:f});break;case"polkadot":this.rpcProviders[r]=new nx({namespace:f});break;case"cip34":this.rpcProviders[r]=new ux({namespace:f});break;case"elrond":this.rpcProviders[r]=new hx({namespace:f});break;case"multiversx":this.rpcProviders[r]=new lx({namespace:f});break;case"near":this.rpcProviders[r]=new fx({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&Yr(a)&&this.events.emit("accountsChanged",a.map(ix))}else if(s.name==="chainChanged"){const a=r.chainId,h=r.event.data,f=rn(a),g=Ec(a)!==Ec(h)?`${f}:${Ec(h)}`:a;this.onChainChanged(g)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,h=(s=this.client)==null?void 0:s.session.get(t);this.session=xc(Io({},h),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",xc(Io({},It("USER_DISCONNECTED")),{data:t.topic}))}),this.on(yi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(f=>rn(f)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=rn(Object.keys(this.namespaces)[0]),h=this.rpcProviders[a].getDefaultChain();return[a,h]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[a,h]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(h),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${cf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${cf}/${t}`)}}const mx=eu,wx="wc",bx="ethereum_provider",_x=`${wx}@2:${bx}:`,Ex="https://rpc.walletconnect.com/v1/",Mc=["eth_sendTransaction","personal_sign"],Ix=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],qc=["chainChanged","accountsChanged"],xx=["chainChanged","accountsChanged","message","disconnect","connect"];var Px=Object.defineProperty,Sx=Object.defineProperties,Ox=Object.getOwnPropertyDescriptors,df=Object.getOwnPropertySymbols,Rx=Object.prototype.hasOwnProperty,Tx=Object.prototype.propertyIsEnumerable,gf=(n,t,r)=>t in n?Px(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,nn=(n,t)=>{for(var r in t||(t={}))Rx.call(t,r)&&gf(n,r,t[r]);if(df)for(var r of df(t))Tx.call(t,r)&&gf(n,r,t[r]);return n},yf=(n,t)=>Sx(n,Ox(t));function $o(n){return Number(n[0].split(":")[1])}function Pc(n){return`0x${n.toString(16)}`}function Ax(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:a,events:h,optionalEvents:f,rpcMap:g}=n;if(!Yr(t))throw new Error("Invalid chains");const b={chains:t,methods:s||Mc,events:h||qc,rpcMap:nn({},t.length?{[$o(t)]:g[$o(t)]}:{})},y=h==null?void 0:h.filter(U=>!qc.includes(U)),E=s==null?void 0:s.filter(U=>!Mc.includes(U));if(!r&&!f&&!a&&!(y!=null&&y.length)&&!(E!=null&&E.length))return{required:t.length?b:void 0};const O=(y==null?void 0:y.length)&&(E==null?void 0:E.length)||!r,C={chains:[...new Set(O?b.chains.concat(r||[]):r)],methods:[...new Set(b.methods.concat(a!=null&&a.length?a:Ix))],events:[...new Set(b.events.concat(f!=null&&f.length?f:xx))],rpcMap:g};return{required:t.length?b:void 0,optional:r.length?C:void 0}}class tu{constructor(){this.events=new $r.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=_x,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new tu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=Ax(this.rpc);try{const a=await new Promise(async(f,g)=>{var b;this.rpc.showQrModal&&((b=this.modal)==null||b.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(yf(nn({namespaces:nn({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(y=>{f(y)}).catch(y=>{g(new Error(y.message))})});if(!a)return;const h=s0(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:Pc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Pc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",yf(nn({},It("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Pc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,a]=t.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const a=(r=t==null?void 0:t.chains)!=null?r:[],h=(s=t==null?void 0:t.optionalChains)!=null?s:[],f=a.concat(h);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=a.length?(t==null?void 0:t.methods)||Mc:[],b=a.length?(t==null?void 0:t.events)||qc:[],y=(t==null?void 0:t.optionalMethods)||[],E=(t==null?void 0:t.optionalEvents)||[],O=(t==null?void 0:t.rpcMap)||this.buildRpcMap(f,t.projectId),C=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(U=>this.formatChainId(U)),optionalChains:h.map(U=>this.formatChainId(U)),methods:g,events:b,optionalMethods:y,optionalEvents:E,rpcMap:O,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:C,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?$o(this.rpc.chains):$o(this.rpc.optionalChains),this.signer=await mx.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await t0(()=>import("./index-YCczKSOZ.js").then(a=>a.i),__vite__mapDeps([0,1]));r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(nn({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:a}=t;r&&Yr(r)&&(this.rpc.chains=r.map(h=>this.formatChainId(h)),r.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)})),s&&Yr(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(h=>this.formatChainId(h)),s.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${Ex}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const Gx=tu;export{Gx as EthereumProvider,xx as OPTIONAL_EVENTS,Ix as OPTIONAL_METHODS,qc as REQUIRED_EVENTS,Mc as REQUIRED_METHODS,tu as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-YCczKSOZ.js","assets/vendor-L6D-Rps7.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}